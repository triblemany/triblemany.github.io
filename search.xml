<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>电容的电磁场仿真设置</title>
      <link href="/archives/10ba08e5/mom-simulation.html"/>
      <url>/archives/10ba08e5/mom-simulation.html</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>电容是射频集成电路中的常用器件，其结构固定，设计较为简单。但由于精细结构较多，往往占用极大的仿真资源和时间。在隔直或者交流去耦应用中，电容的精确值并不是那么重要，只要足够大即可。即使在匹配电路中，些许偏差也不会对中心频率产生明显影响。因此，电容仿真不应无止尽追求精度，而是要在尽可能短的时间内获得误差不大的仿真结果。本文对比了电容仿真中不同的仿真引擎和通孔合并方法的优劣，并给出了推荐设置。<br><a id="more"></a></p><h2 id="仿真引擎的选择"><a href="#仿真引擎的选择" class="headerlink" title="仿真引擎的选择"></a>仿真引擎的选择</h2><p>常用的ADS Momentum引擎有两种模式：RF和Microwave。RF模式在射频频段内提供了精确的电磁场仿真结果，且仿真速度较快。在更高频段内，由于辐射效应，只用Microwave才能提供准角结果。ADS文档中推荐在以下电路中使用RF模式：</p><ul><li>电小的</li><li>图形复杂的</li><li>不辐射的</li></ul><p>在射频频段的电容应用应当符合RF的描述，之后通过仿真对比予以验证。另一个值得注意的的Edge Mesh的设置。Edge mesh将自动的在图形边缘添加密布的mesh，用于仿真趋肤效应，常用于高层金属的仿真。之后也通过仿真比较了Edge Mesh在电容仿真中的影响。</p><p>对比实验选则了MOM电容，由5层金属，36根19.74 um长插指构成，两侧通孔采用减少面积合并。仿真在32核服务器上顺序进行，无其他负载。结果如下：</p><p><img src="./mom-simulation/simulation-engine.png" alt="simulation-engine"></p><p>在14 GHz计算得到的仿真误差如下表：</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">电容误差</th><th style="text-align:center">Q值误差</th><th style="text-align:center">仿真时间</th></tr></thead><tbody><tr><td style="text-align:center">Microwave，Edge Mesh（基准）</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">90 min</td></tr><tr><td style="text-align:center">RF</td><td style="text-align:center">1.66 %</td><td style="text-align:center">104.43 %</td><td style="text-align:center">1.5 min</td></tr><tr><td style="text-align:center">Microwave</td><td style="text-align:center">1.70 %</td><td style="text-align:center">105.72 %</td><td style="text-align:center">7.5 min</td></tr><tr><td style="text-align:center"><strong>RF，Edge Mesh</strong></td><td style="text-align:center"><strong>0.04 %</strong></td><td style="text-align:center"><strong>0.56 %</strong></td><td style="text-align:center"><strong>12 min</strong></td></tr></tbody></table></div><p>由此可见，Microwave和RF方法在14 GHz处的仿真结果相差不大，但Edge Mesh对Q值影响较大。由于趋肤效应，电流倾向于在导体边缘流动，减小了有效横截面积，因而损耗变大。当不添加Edge Mesh则无法仿真趋肤效应，直接导致偏高的Q值。因此，采用RF模式并选择Edge Mesh是平衡精度和仿真时间的最优结果。</p><h2 id="通孔的合并和模型选择"><a href="#通孔的合并和模型选择" class="headerlink" title="通孔的合并和模型选择"></a>通孔的合并和模型选择</h2><p>仿真电容时通孔阵列如果不加处理将会产生大量的网格，从而占用仿真资源并拖慢仿真速度。通常，需要将这些通孔进行合并，形成一个大的通孔。合并的方法通常有：</p><ul><li>画一个大的通孔覆盖原来所有的通孔</li><li>画一个有效面积相同的通孔</li><li>画一个大的通孔覆盖原来所有的通孔，并减小通孔导电率</li></ul><p>其中第一种方法最为简单，但不可避免增大通孔面积，低估通孔损耗。第二种方法使得通孔面积不变，但使得通孔更加集中，改变了场的分布。第三种方法需要修改衬底文件，较为麻烦，但精度较好。</p><p>另一个值得注意的时通孔模型的选择，默认选择时3D模型。此时，所有的表面电流流向都被考虑。而2D模型只考虑垂直方向的表面电流。在通孔阵列中，由于水平方向各个通孔互相独立，因此不应该有水平方向电流。而通孔合并后，物理隔离消失，因此应当选择2D模型抑制水平方向的电流，提高仿真精度。</p><p>关于修改通孔电导率，通孔电导率的计算公式为：</p><script type="math/tex; mode=display">\rho=\frac{h}{Rw^2}</script><p>其中$h$是通孔高度，$w$是通孔边长，$R$是单个通孔的电阻，这些参数都可以从代工厂提供的连线模型中找到。考虑到通孔合并，其等效电导率为：</p><script type="math/tex; mode=display">\rho_{eff}=\rho\frac{w^2}{(w+s_r)(w+s_c)}</script><p>其中是$s_r$通孔阵列的行间隔，$s_c$是列间隔。考虑$w=0.1, s_r=0.1, s_c=0.14$和$w=0.1, s_r=0.13, s_c=0.13$两种情况，其$\rho_{eff}$分别为$0.208\rho$和$0.189\rho$，因此合并时可取$\rho_{eff}=0.2\rho$。</p><p>对比实验选则了fringe电容，由5层金属，20根5 um长插指构成，采用带有Edge Mesh的RF模式仿真。仿真在32核服务器上顺序进行，无其他负载。结果如下：</p><p><img src="./mom-simulation/mom-simulation-comparison.png" alt="mom-simulation-comparison"></p><p>在14 GHz计算得到的仿真误差如下表：</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">电容误差</th><th style="text-align:center">Q值误差</th><th style="text-align:center">仿真时间</th></tr></thead><tbody><tr><td style="text-align:center">原始版图，3D（基准）</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">3 hr 5 min</td></tr><tr><td style="text-align:center"><strong>覆盖合并，2D，降低电导率</strong></td><td style="text-align:center"><strong>0.13 %</strong></td><td style="text-align:center"><strong>3.57 %</strong></td><td style="text-align:center"><strong>17 min</strong></td></tr><tr><td style="text-align:center">覆盖合并，2D</td><td style="text-align:center">0.13 %</td><td style="text-align:center">9.31 %</td><td style="text-align:center">14 min</td></tr><tr><td style="text-align:center">同面积合并，2D</td><td style="text-align:center">5.27 %</td><td style="text-align:center">53.44 %</td><td style="text-align:center">7 min</td></tr><tr><td style="text-align:center">覆盖合并，3D</td><td style="text-align:center">0.15 %</td><td style="text-align:center">10.05 %</td><td style="text-align:center">19 min</td></tr></tbody></table></div><p>仿真结果表明，同面积合并仿真速度最快，其他方法仿真速度相差无几。在合并之后，2D模型确实比3D模型更准确展现了Q值，但差距不大。前述的三种方法中， 出乎意料的是同面积合并无论是电容误差还是Q值误差都明显较大，可能是由于将通孔集中到中间与电流的趋肤效应背道而驰，人为加大了损耗。而覆盖合并方法简单有效，仅在Q值上产生一些明显误差。降低电导率后，Q值误差可以忽略不计，因此，采用2D通孔模型的覆盖合并方法最为有效。当对Q值精度要求高时，可将通孔电导率将为约1/5。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文比较了几种电容的仿真方法。为了快速、准确地仿真电容，最好采用带有Edge Mesh的RF模式，通过覆盖方法合并通孔，降低通孔电导率至约1/5，并选择2D模型抑制水平电流。</p>]]></content>
      
      
      
        <tags>
            
            <tag> RFIC </tag>
            
            <tag> Capacitor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ADS创建MOM电容Pcell</title>
      <link href="/archives/97db45b0/ads-mom-pcell.html"/>
      <url>/archives/97db45b0/ads-mom-pcell.html</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>在集成电路设计中，Pcell (Parameterized Cell)指只需要输入参数就可以通过程序代码自动创建的版图。例如，代工厂提供的工艺库中就含有常用的晶体管、电容以至电感的Pcell文件，在版图设计时只需要指定一些参数（在晶体管设计中例如栅长、栅宽、栅指数等）即可自动生成对应的版图。这极大简化了设计流程，缩短了设计周期。</p><p>然而，代工厂提供的预设工艺库有时可能不能满足设计要求。比如说，用户可能想设计一系列更高Q值，但精度较低的fringe电容，而工艺库却没有提供。此时，自定义Pcell可以省去重复设计的麻烦。常用的设计软件如Cadence、ADS都支持通过相应的编程语言（SKILL和AEL）自定义创建Pcell。</p><p>此外，也可以自行撰写脚本文件（例如Python），生成EGS格式的版图并导入ADS。使用这种方法时，也可以通过ADS的命令行工具进行批量仿真，十分方便。自行撰写脚本文件比较通用，可操控性强，但需要大量的编程工作（编写基础的图形类库）。</p><p>由于ADS集成了Momentum电磁场仿真软件，并支持通过自带的AMC (Advanced Model Composer)对Pcell进行自动仿真和建模，在设计中应用较为广泛。本文以电容设计为例，介绍了基于ADS的AEL语言的Pcell设计和批量仿真建模。<br><a id="more"></a></p><h2 id="预备"><a href="#预备" class="headerlink" title="预备"></a>预备</h2><p>这一部分介绍了一些预备知识。</p><h3 id="电容"><a href="#电容" class="headerlink" title="电容"></a>电容</h3><p>电容是射频集成电路设计必不可少的组件。它可以构成LC谐振网络，提供交流耦合、直流阻断。常见的电容类型有晶体管电容、二极管电容、MIM（Metal-Insulator-Metal）电容以及MOM（Metal-Oxide-Metal）电容。由于栅氧较薄，晶体管电容面积紧凑，但存在电压调制效应。就MIM和MOM而言，虽然Oxide也是一种Insulator，但MOM电容通常指代同层两个金属插指之间和其间氧化物形成的电容，而MIM以平板电容为主，有时特指模拟/射频工艺中提供的额外提供两层金属间的电容。</p><p>电容的一个简单模型是RC并联网络，其等效R为：</p><script type="math/tex; mode=display">C=\frac{\mathrm{imag}(Y_{11})}{2\pi f}</script><p>其等效C为：</p><script type="math/tex; mode=display">R=\frac{1}{\mathrm{real}(Y_{11})}</script><p>品质因数定义为：</p><script type="math/tex; mode=display">Q=2\pi fRC=\frac{\mathrm{imag}(Y_{11})}{\mathrm{real}(Y_{11})}=-\frac{\mathrm{imag}(Z_{11})}{\mathrm{real}(Z_{11})}</script><p>但这个简单模型只能在工作频率附近的窄带使用，针对电容更宽带的建模则需要将电感考虑进去。此时，模型为：</p><p><img src=".\ads-mom-pcell\capacitor-model-rlc.gif" alt="real world capacitor model"></p><p>此时，直流电阻为：</p><script type="math/tex; mode=display">R_{DC}=R_{ESR}+R_{Leakage}</script><p>高频电阻为：</p><script type="math/tex; mode=display">R_{RF}=R_{ESR}</script><p>低频电抗为</p><script type="math/tex; mode=display">\mathrm{imag}(Z_{IN})=\omega L-\frac{\omega CR^2}{1+\omega^2C^2R^2}\approx\omega L</script><p>谐振频率（虚部为0）为：</p><script type="math/tex; mode=display">f_{resonate}=\frac{1}{2\pi}\sqrt{\frac{CR^2-L}{LC^2R^2}}</script><p>因此，可以将这些参数从仿真中提取出来。</p><p>关于MOM电容的版图，其既可以是简单的同层结构</p><p><img src=".\ads-mom-pcell\mom.png" alt="mom capacitor"></p><p>也可以是交错的立体结构。此时，其电容密度较大：</p><p><img src=".\ads-mom-pcell\fringe-cap.png" alt="fringe capacitor"></p><p>3D透视图如下：</p><p><img src="ads-mom-pcell/mom_cap.png" alt="3D mom capacitor"></p><h3 id="AEL语言"><a href="#AEL语言" class="headerlink" title="AEL语言"></a>AEL语言</h3><p>AEL（Application Extension Language）是Keysight公司开发的基于C语言的通用编程语言，可用于配置、扩展ADS设计环境。其与C语言的区别主要有：</p><ul><li>没有预处理，不支持#if, #ifdef, #ifndef, #endif, #define, #undef以及#include，但增加了load()函数用于代替#include</li><li>没有类型，变量声明使用decl，函数声明使用defun，函数可以在函数内定义</li><li>支持复数和列表，但没有结构</li><li>拥有变量回收机制</li></ul><p>其列表的语法为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decl a = <span class="built_in">list</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">decl b = <span class="built_in">list</span>(<span class="string">"hello"</span>, a[<span class="number">0</span>]);<span class="comment">//可以混合类型</span></span><br></pre></td></tr></table></figure><p>其数组语法为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">decl x = &#123;<span class="number">1</span>+<span class="number">2</span>i, <span class="number">3</span>+<span class="number">4</span>i, <span class="number">5</span>+<span class="number">6</span>i&#125;;</span><br><span class="line">decl y = [<span class="number">1</span>+<span class="number">2</span>i, <span class="number">3</span>+<span class="number">4</span>i, <span class="number">5</span>+<span class="number">6</span>i];<span class="comment">//&#123;&#125;和[]可以互换</span></span><br><span class="line">decl z = &#123;<span class="number">1</span>::<span class="number">10</span>);<span class="comment">//生成1-10的数组</span></span><br><span class="line">decl u = &#123;<span class="number">1</span>::<span class="number">0.5</span>::<span class="number">10</span>);<span class="comment">//生成1-10的数组，间隔0.5</span></span><br></pre></td></tr></table></figure><p>对于矩阵：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">decl m = &#123;&#123;<span class="number">1</span>&#125;,&#123;<span class="number">2</span>&#125;,&#123;<span class="number">3</span>&#125;&#125;;</span><br><span class="line">decl n = [<span class="number">1</span>; <span class="number">2</span>; <span class="number">3</span>];<span class="comment">//两者相同，生成二维数组</span></span><br><span class="line">decl o = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, &#123;<span class="number">3</span>,<span class="number">4</span>&#125;&#125;;</span><br><span class="line">decl p = [<span class="number">1</span>, <span class="number">2</span>; <span class="number">3</span>, <span class="number">4</span>];<span class="comment">//两者相同，生成二维数组(矩阵)</span></span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"%s\n"</span>, identify_value(m));<span class="comment">//打印矩阵</span></span><br></pre></td></tr></table></figure><h3 id="AMC"><a href="#AMC" class="headerlink" title="AMC"></a>AMC</h3><p>AMC (Advanced Model Composer)可以用于无源器件的模型生成，它可以根据预设参数和频率范围对Pcell进行自适应EM仿真，并根据结果建立模型。对于没有仿到的点，也可以根据其算法进行插值，得到较为精确的结果。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>实现绘制电容的Pcell代码主要为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">"vias.ael"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a parallel lines</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// context: the design context</span></span><br><span class="line"><span class="comment">// layer: the layer number</span></span><br><span class="line"><span class="comment">// fingers: number of the lines</span></span><br><span class="line"><span class="comment">// length: length of the lines</span></span><br><span class="line"><span class="comment">// width: width of the lines</span></span><br><span class="line"><span class="comment">// space: space of the lines</span></span><br><span class="line"><span class="comment">// x: lower-left x coordinate of the shape</span></span><br><span class="line"><span class="comment">// y: lower-left y coordinate of the shape</span></span><br><span class="line"><span class="comment">// extension: extension of lines on vertical direction</span></span><br><span class="line"><span class="comment">// dummy_finger: number of unconnected lines at each side</span></span><br><span class="line"><span class="comment">// polar: direction of the extension (0 at bottom, 1 at top)</span></span><br><span class="line"></span><br><span class="line"><span class="function">defun <span class="title">create_plines</span><span class="params">(context, layer, fingers, length, width, space, extension, x, y, dummy_finger, polar)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">x = <span class="keyword">float</span>(x);</span><br><span class="line">y = <span class="keyword">float</span>(y);</span><br><span class="line">decl i;</span><br><span class="line">decl xpos = <span class="number">0</span>;</span><br><span class="line">polar = <span class="keyword">int</span>(polar);</span><br><span class="line">fingers = <span class="keyword">int</span>(fingers);</span><br><span class="line">dummy_finger = <span class="keyword">int</span>(dummy_finger);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;dummy_finger; i++)</span><br><span class="line">&#123;</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+extension, x+xpos+width, y+extension+length);</span><br><span class="line">xpos += (width + space);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;fingers; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(polar == <span class="number">0</span>)</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+<span class="number">0</span>, x+xpos+width, y+extension+length);</span><br><span class="line"><span class="keyword">if</span>(polar == <span class="number">1</span>)</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+extension, x+xpos+width, y+<span class="number">2</span>*extension+length);</span><br><span class="line">xpos += (width + space);</span><br><span class="line">polar = <span class="number">1</span> - polar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;dummy_finger; i++)</span><br><span class="line">&#123;</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+extension, x+xpos+width, y+extension+length);</span><br><span class="line">xpos += (width + space);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a mom capacitor</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// start_layer: the lowest layer number</span></span><br><span class="line"><span class="comment">// end_layer: the highest layer number</span></span><br><span class="line"><span class="comment">// fingers: number of the fingers</span></span><br><span class="line"><span class="comment">// length: length of the fingers</span></span><br><span class="line"><span class="comment">// width: width of the fingers</span></span><br><span class="line"><span class="comment">// space: space of the fingers</span></span><br><span class="line"><span class="comment">// x_extension: extension of via array</span></span><br><span class="line"><span class="comment">// y_extension: space of figner to via array</span></span><br><span class="line"><span class="comment">// via_height: height of the via, width is calculated</span></span><br><span class="line"><span class="comment">// dummy_finger: number of unconnected fingers at each side</span></span><br><span class="line"><span class="comment">// fringe: whether to create a fringe capacitor</span></span><br><span class="line"><span class="comment">// combine: whether to combine vias for simulation simplification</span></span><br><span class="line"></span><br><span class="line"><span class="function">defun <span class="title">mom_cap</span><span class="params">(start_layer, end_layer, fingers, length, width, space, x_extension, y_extension, via_height, dummy_finger, fringe, combine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">decl designContext = de_get_current_design_context();</span><br><span class="line">decl polar = <span class="number">0</span>;</span><br><span class="line">decl i = <span class="number">0</span>;</span><br><span class="line">fringe = <span class="keyword">int</span>(fringe);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get layer IDs</span></span><br><span class="line">decl M7 = db_get_layerid(designContext, <span class="string">"M7"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M6 = db_get_layerid(designContext, <span class="string">"M6"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M5 = db_get_layerid(designContext, <span class="string">"M5"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M4 = db_get_layerid(designContext, <span class="string">"M4"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M3 = db_get_layerid(designContext, <span class="string">"M3"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M2 = db_get_layerid(designContext, <span class="string">"M2"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M1 = db_get_layerid(designContext, <span class="string">"M1"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl Metals = <span class="built_in">list</span>(M1, M1, M2, M3, M4, M5, M6, M7);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// calculate the width of the via array</span></span><br><span class="line">decl t_width = <span class="number">2</span> * x_extension + space * (<span class="number">2</span>*dummy_finger + fingers - <span class="number">1</span>) + width * (<span class="number">2</span>*dummy_finger + fingers);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create pins</span></span><br><span class="line">db_create_pin(designContext, t_width/<span class="number">2</span>, <span class="number">0</span>, <span class="number">-90</span>, Metals[end_layer], <span class="number">1</span>);</span><br><span class="line">db_create_pin(designContext, t_width/<span class="number">2</span>, <span class="number">2</span>*via_height+<span class="number">2</span>*y_extension+length, <span class="number">90</span>, Metals[end_layer], <span class="number">2</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// create vias at two terminals</span></span><br><span class="line">via_fillto7(start_layer, end_layer, t_width, via_height, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0</span>, <span class="number">0</span>, combine);</span><br><span class="line">via_fillto7(start_layer, end_layer, t_width, via_height, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0</span>, via_height+<span class="number">2</span>*y_extension+length, combine);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// create lines for M1 to M7</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;<span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span>(start_layer &lt;= i &amp;&amp; end_layer &gt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                create_plines(designContext, Metals[i], fingers, length, width, space, y_extension, x_extension, via_height, dummy_finger, polar);</span><br><span class="line">                polar = fringe - polar;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A function wrapper</span></span><br><span class="line"><span class="function">defun <span class="title">mom_cap_wrapper</span><span class="params">(start_layer, end_layer, fingers, length, width, space, x_extension, y_extension, via_height, dummy_finger, fringe, combine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">decl designContext = de_get_current_design_context();</span><br><span class="line"></span><br><span class="line">decl mks2uu = db_get_mks_to_uu_factor(designContext);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// convert the units</span></span><br><span class="line">length = length * mks2uu;</span><br><span class="line">width = width * mks2uu;</span><br><span class="line">space = space * mks2uu;</span><br><span class="line">x_extension = x_extension * mks2uu;</span><br><span class="line">y_extension = y_extension * mks2uu;</span><br><span class="line">via_height = via_height * mks2uu;</span><br><span class="line"></span><br><span class="line">mom_cap(start_layer, end_layer, fingers, length, width, space, x_extension, y_extension, via_height, dummy_finger, fringe, combine);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="测试流程"><a href="#测试流程" class="headerlink" title="测试流程"></a>测试流程</h3><p>为了运行代码，需要在ADS中进行一系列设置：</p><ol><li><p>在ADS库目录下新建mom.ael文件，加入上述代码；</p></li><li><p>在ADS库目录下新建eesof_lib.cfg文件，加入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BOOT_AEL=./mom.ael</span><br></pre></td></tr></table></figure><p>此时，当ADS载入库时，代码会自动加载。为了强制重载，可以点击 File &gt; Recent Workspaces中这个库的名字；</p></li><li><p>新建一个空白layout，命名为momcap，点击File &gt; Design parameters，在其中设置各个参数的名称、类型、默认值、单位和描述。设置完成后点击确认。</p><p><img src="ads-mom-pcell/design-parameters.png" alt="set design parameters"></p><p>点击File &gt; Customize PCell，选择artwork类型为”AEL Macro“，将函数名写为主函数名。设置完成后点击确认。</p><p><img src="ads-mom-pcell/customize-pcell.png" alt="customize pcell"></p><p>保存layout；</p></li><li><p>另建一个名为momcap_sweep的layout，拖入刚才创建的momcap。此时应该出现默认值下的电容图形。在两端加上pin并设置好EM仿真。在EM &gt; Component &gt; Parameters中设置要扫描的变量名和范围（只能设置两个连续型变量），并将变量名填入Pcell的参数中。在EM &gt; Component &gt; Advanced Model Composer &gt; Create Model中开始仿真；</p></li><li><p>仿真结束后，点击EM &gt; Component &gt; Create EM Model and Symbol，在新建的原理图中加入symbol，设置好参数即可进行电路仿真。</p></li></ol><h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><p>首先对插指长度进行扫描，绘制了等效电容和等效Q值的曲线：</p><p><img src="ads-mom-pcell/sweep_length_Q.png" alt="sweep_length_Q"></p><p>事实上，AMC并没有对8-25 um区间范围内的每个点进行仿真，而是在之前仿真结果的基础上进行插值，因为仿真速度非常快，适用于快速迭代和自动优化。仿真结果较为精确。</p><p>当观察28 GHz处的等效电容时随插指长变化时，有：</p><p><img src="ads-mom-pcell/sweep_length.png" alt="sweep_length"></p><p>当观察28 GHz处的等效电容时随插指数变化时，有：</p><p><img src="ads-mom-pcell/sweep_fingers.png" alt="sweep_fingers"></p><p>可以发现，在28 GHz处电容值基本随插指长、插指数而线性变化，因而实际设计时可以通过长度、插指数进行估算，进一步节省时间。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>Keysight, <em>Advanced Design System Documentation</em></li><li>Behzard Razavi, <em>RF Microelectronics</em></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RFIC </tag>
            
            <tag> Capacitor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Diffucult Sentences in GRE Preparation</title>
      <link href="/archives/97db45b9/difficult-sentences.html"/>
      <url>/archives/97db45b9/difficult-sentences.html</url>
      
        <content type="html"><![CDATA[<p>All these sentences are picked from relevant GRE preparation books.</p><p>Excessive secrecy tends to <strong>invite</strong> excessive curiosity and thus serves to <strong>provoke</strong> the very impulses against which it guards.</p><p>Prudery actually draws attention to the vice that it is supposed to <strong>suppress</strong>; the very act that forbids the speech or prohibits sight <strong>dramatizes</strong> what is hidden.</p><p>Although Caroline Gordon was rigorously objective in her journalistic writing, her lively and <strong>exuberant</strong> private correspondence <strong>exhibited</strong> a delightful capacity for biting commentary on the social scene.<br><a id="more"></a></p><p>It would be a waste of time for any reviewer to bother <strong>condemning</strong> a book whose utter worthlessness is <strong>obvious</strong> to even the least discerning reader.</p><p>It would be misleading to use a published play to generalize about fifteenth-century drama; the very fact of publication should serve as a <strong>warning</strong> of the play’s <strong>unrepresentative</strong> character.</p><p>It is his dubious distinction to have proved what nobody would think of denying, that Romeo at the age of sixty-four writes with all the characteristic of <strong>maturity</strong>.</p><p>It is strange how words shape our thoughts and trap us at the bottom of deeply <strong>incised</strong> canyon of thinking, their imprisoning sides carved out by the <strong>river</strong> of past usage.</p><p>It is ironic that a critic of such overwhelming vanity now suffers from a measure of oblivion to which he was forever <strong>consigning</strong> others, in the end, all his <strong>self-adulation</strong> has only worked against him.</p><p>People should not be praised for their virtue if they lacked the energy to be <strong>wicked</strong>; in such cases, goodness is merely the effect of <strong>indolence</strong>.</p><p>Observable as a tendency of our culture is a <strong>withdrawal</strong> of <strong>belief</strong> in psychoanalysis: we no longer feel that it can solve our emotional problems.</p><p>Broadway audiences have been inured to <strong>mediocrity</strong> and so <strong>desperate</strong> to be pleased as to make their ready ovations meaningless as an indicator of the quality of the production before them.</p><p>Without seeming unworldly, William James appeared wholly removed from the <strong>commonplace</strong> of the society, the conventionality of academe.</p><p>Any language is a conspiracy against experience in the sense that it is a collective attempt to <strong>manage</strong> experience by reducing it into discrete parcels.</p><p>There is perhaps some truth in that waggish old definition of scholar - a siren that calls attention to a fog without doing anything to <strong>dispel</strong> it.</p><p>We realized that John was still young and impressionable, but were nevertheless surprised at his <strong>naivete</strong>. </p><p>The First World War began in a context of jargon and verbal delicacy and continued in a cloud of <strong>euphemism</strong> as <strong>impenetrable</strong> as language and literature, skillfully used, could make it.</p><p>Noting the murder victim’s flaccid musculature and pear-like figure, she deduced that the unfortunate fellow had earned his living in some <strong>sedentary</strong> occupation.</p><p>Politeness is not a <strong>superficial</strong> attribute of human behavior, but a rather a central virtue, one whose very existence is increasingly being <strong>threatened</strong> by the faddish requirement to “speak one’s mind”.</p><p>Ever prey to vagrant impulses that impelled him to <strong>squander</strong> his talents on a host of unworthy projects, his very <strong>dissipation</strong> nonetheless enhanced his reputation, for the sheer energy of his extravagance dazzled observers.</p><p>While some see in practical jokes a wish for mastery in miniature over a world that seems very <strong>unruly</strong>, others believe that the joke’s purpose is to disrupt, by reducing all transactions to <strong>chaos</strong>.</p><p>For all his <strong>boorishness</strong>, Honore de Balzac betrayed a remarkable <strong>sensitivity</strong> to the plight of 19th century women, populating his novel with characters sympathetic to women’s right.</p><p>Inspired interim responses to hitherto unknown problems, New Deal economic stratagems became <strong>ossified</strong> as a result of bureaucratization, their flexibility and adaptability destroyed by their transformation into rigid policies.</p><p>The architects of New York’s early skyscrapers, hinting here at a twelfth-century cathedral, there at a fifteenth-century palace, sought to legitimize the city’s social striving by <strong>evoke</strong> a history the city did not truly <strong>possess</strong>.</p><p>Ethologists are convinced that many animals survive through learning - but learning that is <strong>dictated by</strong> their generic programming, learning as throughly <strong>stereotyped</strong> as the most instinctive of behavioral responses.</p><p>The senator’s reputation, though <strong>shaken</strong> by false allegations of misconduct, emerged from the ordeal <strong>unscathed</strong>.</p><p>A human being is quite <strong>frail</strong> creature, for the gloss of rationality that covers his or her fears and <strong>insecurity</strong> is thin and easily breached.</p><p>The <strong>deference</strong> with which the French aristocracy greeted the middle-class Rousseau was all the more <strong>remarkable</strong> because he showed so little respect for them.</p><p>The influence of the Titnaeus among early philosophical thinkers was <strong>pervasive</strong>, if only because it was the sole dialogue <strong>available</strong> in Europe for almost 1000 years.</p><p>The Gibsons were little given to <strong>conformism</strong> in any form; not one of them was afraid of <strong>singularity</strong>, of being seeming unlike their neighbors.</p><p>Salazar’s presence in the group was so <strong>reassuring</strong> to the others that they lost most of their earlier <strong>trepidation</strong>; failure, for them, became all but unthinkable.</p><p><em>all but = almost, anything but = not at all</em></p><p>Read‘s apology to Heflin was not exactly abject and did little to <strong>resolve</strong> their decades-long quarrel, which had been as <strong>acrimonious</strong> as the academic etiquette of scholarly journals permitted.</p><p>An obvious style, easily identified by some superficial quirk, is properly <strong>decried</strong> as a mere mannerism, whereas a complex and subtle style <strong>resists</strong> reduction to a formula.</p><p>Jones was unable to recognize, the contradictions in his attitudes that were obvious to everyone else; even the hint of an untruth was <strong>repugnant</strong> to him, but he <strong>courted</strong> serious trouble by always cheating on his taxes.</p><p>The idea of an autonomous discipline called “philosophy,” distinct from and sitting in judgment on such pursuits as theology and science turns out, on close examination, to be of quite recent origin.</p><p>She writes across generational lines, making the past so <strong>vivid</strong> that our belief that the present is the true locus of experience is undermined.</p><p>The trick for Michael was to <strong>conjure for</strong> his son a illusory orderliness; only alone at night, when the boy was asleep, could Michael <strong>acknowledge</strong> the chaos he kept hidden from his son.</p><p>The current demand for quality in the schools seems to ask not for the development of informed and active citizens, but for disciplined and productive workers with abilities that contribute to civic life only <strong>indirectly</strong>, if at all.</p><p>Bob: It seems like this city is getting more dangerous every day.</p><p>Steve: Actually, it doesn’t seem that much worse from when I first moved here. If anything, the crime rate has actually dropped since the city’s population has almost doubled in the last ten years.</p><p>Carruther‘s latest literature criticism <strong>belies</strong> her reputation for trenchant commentary; despite its intriguing titles and the fulsome praise on its dust jacket, it is nothing more than a collection of <strong>platitudes</strong>.</p><p><em>belie: contradict</em></p><p>Those who fear the influence of television deliberately <strong>underplay</strong> its persuasive power, hoping that they might keep knowledge of its potential to effect social change from being widely disseminated.</p><p>Far from being <strong>unctuous</strong>, Pat was always loath to appear <strong>acquiescent</strong>.</p><p>A desire to throw over reality a light that never was might give away abruptly to the desire on the part of what we might consider a novelist-scientist to record exactly and concretely the structure and texture of a flower</p><p>It has thus generally been by way of the emphasis on oral literary creativity that these Chicano writers, whose English-language works are sometimes uninspired, developed the powerful and arresting language that characterized their Spanish-language works.</p><p>Having no sense of moral obligation, Shipler was as little subject to the <strong>reproach</strong> of conscience after he acted as he was motivated by its <strong>promptings</strong> before he acted.</p><p>Only in the case of the February Revolution do we lack a useful description of participants that might characterize it in the light of what social history has taught us about the process of revolutionary mobilization.</p><p>She was criticized by her fellow lawyers not because she was not <strong>hardworking</strong>, but because she so <strong>minutely</strong> prepared her cases that she failed to bring the expected number to trial.</p><p>Religious philosopher that he was, Henry More derived his conception of an infinite universe from the Infinite God in whom he believed, a benevolent God of <strong>plenitude</strong> whose nature was to create <strong>abundance</strong>.</p><p>The author, mocked by many for his simple, almost childlike prose, can at least not be begrudged the distinction of writing with <strong>lucidness</strong>.</p><p><em>begrudge: give unwillingly</em></p><p>Perhaps there is nothing more to the album than its case that experimentalism into uncharted sonic landscapes did not <strong>die</strong> with Stockhausen. Or perhaps its forays—many of which could rightly be dubbed sophomoric—into the avant-grade also lead to the <strong>unsettling conclusion</strong> that to create an unprecedented sound one has to <strong>forgo producing</strong> a discernible melody.</p><p>There’s hardly a generalization that can be made about people’s social behavior and the values informing it that cannot be <strong>challenged</strong> from one or another point of view, or even <strong>dismissed</strong> as simplistic or vapid.</p>]]></content>
      
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to Model RLGC Transmission Line</title>
      <link href="/archives/afb86e77/transmission-line.html"/>
      <url>/archives/afb86e77/transmission-line.html</url>
      
        <content type="html"><![CDATA[<h2 id="Transmission-Line-Equations"><a href="#Transmission-Line-Equations" class="headerlink" title="Transmission Line Equations"></a>Transmission Line Equations</h2><p>This part deals with the conversion between RLGC parameters and the $\gamma$ Z parameters.</p><p>RLCG to $\gamma$ Z</p><script type="math/tex; mode=display">\gamma=\sqrt{(R+j\omega L)(G+j\omega C)}=\alpha+j\beta</script><script type="math/tex; mode=display">Z=\sqrt{\frac{R+j\omega L}{G+j\omega C}}</script><p>$\gamma$ Z to RLCG</p><script type="math/tex; mode=display">R={\rm Re}\{\gamma Z\}</script><script type="math/tex; mode=display">L={\rm Im}\{\gamma Z\}/\omega</script><script type="math/tex; mode=display">G={\rm Re}\{\gamma/Z\}</script><script type="math/tex; mode=display">C={\rm Im}\{\gamma/Z\}/\omega</script><a id="more"></a><h2 id="Obtain-Z-and-gamma-from-simulation"><a href="#Obtain-Z-and-gamma-from-simulation" class="headerlink" title="Obtain Z and $\gamma$ from simulation"></a>Obtain Z and $\gamma$ from simulation</h2><p><img src="transmission-line/simulation_schematic.png" alt="simulation_schematic"></p><p>Real part of characteristic impedance is given by</p><p><img src="transmission-line/real_of_Z.png" alt="real_of_Z"></p><h2 id="Use-Matlab-to-obtain-RLGC-Z-and-gamma"><a href="#Use-Matlab-to-obtain-RLGC-Z-and-gamma" class="headerlink" title="Use Matlab to obtain RLGC, Z and $\gamma$"></a>Use Matlab to obtain RLGC, Z and $\gamma$</h2><h3 id="Calculation"><a href="#Calculation" class="headerlink" title="Calculation"></a>Calculation</h3><p>MATLAB code</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PolartoComplex = @(len, the) len*<span class="built_in">cos</span>(the*<span class="built_in">pi</span>/<span class="number">180</span>) + <span class="number">1</span><span class="built_in">i</span>*len*<span class="built_in">sin</span>(the*<span class="built_in">pi</span>/<span class="number">180</span>);</span><br><span class="line"></span><br><span class="line">S11 = PolartoComplex(<span class="number">0.019</span>, <span class="number">9.658</span>);</span><br><span class="line">S12 = PolartoComplex(<span class="number">0.975</span>, <span class="number">-28.942</span>);</span><br><span class="line">S21 = PolartoComplex(<span class="number">0.975</span>, <span class="number">-28.942</span>);</span><br><span class="line">S22 = PolartoComplex(<span class="number">0.019</span>, <span class="number">9.658</span>);</span><br><span class="line"><span class="built_in">length</span> = <span class="number">400e-6</span>;<span class="comment">% length of transmission line</span></span><br><span class="line">freq = <span class="number">28e9</span>;<span class="comment">% frequency of simulation</span></span><br><span class="line">Z0 = <span class="number">50</span>;</span><br><span class="line">rlgc_params = s2rlgc([S11, S12; S21, S22], <span class="built_in">length</span>, freq, Z0)</span><br></pre></td></tr></table></figure><p>Corresponding output is</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    R: 5.1717e+03</span><br><span class="line">    L: 3.6799e-07</span><br><span class="line">    G: 0.4737</span><br><span class="line">    C: 1.4002e-10</span><br><span class="line">alpha: 62.5539</span><br><span class="line"> beta: 1.2634e+03</span><br><span class="line">   Zc: 51.3183 - 1.5526i</span><br></pre></td></tr></table></figure><h3 id="Verification"><a href="#Verification" class="headerlink" title="Verification"></a>Verification</h3><p>Using 8 RLGC segments</p><p><img src="transmission-line/lumped_mimic_distributed.png" alt="lumped_mimic_distributed"></p><p>Detailed schematic of each one</p><p><img src="transmission-line/detailed_schematic.png" alt="detailed_schematic"></p><p>Results</p><p><img src="transmission-line/simulation_result.png" alt="simulation_result"></p><h2 id="Questions"><a href="#Questions" class="headerlink" title="Questions"></a>Questions</h2><ol><li><p>How to convert $\alpha, \beta$ parameters to $A, \epsilon$ parameters?</p><script type="math/tex; mode=display">\beta=\omega\sqrt{\mu\epsilon}=\omega\sqrt{\mu_0\epsilon_0\epsilon_{eff}}</script><script type="math/tex; mode=display">1\ NP/m=20\log_{10}{e^{1}}=8.686\ dB/m</script><script type="math/tex; mode=display">A=20\alpha\log_{10}{e}</script><script type="math/tex; mode=display">\epsilon_{eff}=\left(\frac{c\beta}{\omega}\right)^2</script></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RFIC </tag>
            
            <tag> Transmission Line </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
