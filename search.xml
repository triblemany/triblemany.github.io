<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Mismatch</title>
      <link href="/archives/f85b4c14/mismatch.html"/>
      <url>/archives/f85b4c14/mismatch.html</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="Oh, these decrypted content cannot be verified, but you can still have a look."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="Hey, password is required here." /><label>Hey, password is required here.</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="9255a0bc7af337af572eb91ad0370639e850f8203bd16301905f4b6f099a2549">93e452f6af5bcace332ef057ddd9784738a9ceaf955657dbc9e1a00761f8b809bfa124b025eefe85d264231b2cde9cd455fb62a3219982239565cf6222893666b7fe8b552ff39bdca653deb5810c33e8f2f8a3f744de559acf092d5aadd86bdaefd98504a49a160e595c4cc92e34076bdd7d4b65a1699e989c872025dcc2d746adf2cce61eb090317a78154c8683f14f6bf92d245aa4e73f7d0427730a80c3f1059ce05368b2e959ab12e17aec5165f532907e8fb4c729fe506b0815a38153f5463f9c896aa19d7c804920d448b451b94770b2cf387f028f4d5d159abfa95991020da5705ba9b39c679ab8db19a9a13e2bee2b1b4ca815d416e0b7dae193965c16b1d40c534314bf47eb6546975c185f3fff1ada809a3b3523e48dc4dd8928b6d0bdfc3835ba6b5937323d9284f8040b76ebfc92fabffd408ab2b191f48ebc71215caa7cda4b2d5f99770072a7f634d9f19db5adee947b80eae90e736f5cfe89739268ce7c6ec137d5d254026d589dfac02cf92c975aa8025458ffe2134c9cff2a3bbefa8f61d9bc383b1c8ceca89d5953164cb5e950c8c2affd24f0a1a800296619b2acf35ac777bac8d7b7e0b079b3e9756115c34fd8615520ef9481b6c3abe84c8a47abf272907a30ebfe79513db62f837d05622a2b3a3ea852a70c63fda93cdfab8084e7c69dcfc1d87e7717f7840fa9c4f3d497cb561b508acbd4efba15a43afa487e5a28210bf2787260dbc74405512b82028a3cca662fd4df6dd6f2b099f75fd49685fa13e4e9b438315e09c66f8c4254b6edb324aff7e6ebd7c1968692a411d3336083604ac449853e1efb7e274152a5380a21a146e02e3acfbfa3ea9ad370da974d83d88f21b9081e5356696c96df6059e846085d5fe2f3625ceb86458823ed0015981b15d876c057777fc3ea5d9db0b66899b40500498da6af3884f8e4e7cb607ef15c8994e8eb48a50d5536c26b683e1d56aaf525f8b777ce4a32575bcbbe2436f544dc00b1d74888c4b1329e751b504c5faff8999c04c6cbb06c38ec33bf7d947cdf91b099b9162369f4c53cb5f9178aa6a5f70c0de36b9c3729a86384cb46b6dc039b500476e805351fd86e7083e76ba4aeac6f6d0e8488528346948ecca582a99f2d4906b6a33afeba97df1d2d0d9c48dc39d08c7fbf3eb27e09ca9c0664f958e4994d525578c789e5b2d6e410041c9ab47c30ecf95739362ae7a2dd33f9d71e3d9f6beba08b24c3df16d3e16121822a717adaeed4750c1cc2a6a0c4683e865a3a41fe8b1dae132a6b5285da53160916c247317c8089370984e6ed4463fe1d8400b3f16b0027ab5133d7156a6eed0d200d1572fd11de6da21076a05cbf717541dc01b8be4fc914d2bd891cd3fbf24f3e42bba7224b3126dcd0eb1ac5de3f9f409f0991fbd7315ede45c1993a2f533ed8949615070fc943556da525f72714d4ebd89028c633b5f59aebcf9855c7f8ddddb6f1165f5c0ef64324c7c0450b298fdb4eb2ff5fce0d192aab4fffb37f4acb22b773e60fd5a1e020c700ed28e5c00a92b6484a00c3034c3edbeff3dfd8aaa6abf35f78a6df5e7108cca0d38f591fd7eca506d902275382fdcaa462d5b9f4cfa3e9c58b1d69690034a51946427f05a2408ddffd0dd8eb63b3f2f999637471e79bd1972cee582798b7339f085929819ce59f0764f4e3e2afc8364dcee7cd9620100cd5309f5ad903d370dc0b5679bf892dfdba8f2d25372bc3e99ed29b4bb48f4911dab7c3ddedbf6bc6dbf95ee397dbf51131f0496184dcc4f62a4723eff0b727e5e99f2301c2989613d71f95c9d9d32db8cd5e0d440bd23846da416a6b802410bbd2e39415aa6191c815b2d00de12f2a3b050eecc7005f2fbad543a79a7a64c2d6827b667715e3a6ecfaff6f8650b716a01330d8b9bac36de71f537f35c5f340d4dc958127520f6ff044919d4995ab2688133d43bafa7c9c1eee56e6ca6b84b5ed9be1d148258388daf10725e424f8b3d988ee14b5164b5679dbac35844e8e88cc94a1f7f3ab30626c43de38784445211169b93e45825cf52c97511f351975df97203e2d110bd9e706796ead87af61749d4ffb349f745927da3330f8dacc93d36ee4c420f54f97701b94333385f2fa6af7eee6a6332b4f28541e84e89bdd2983bffdfe7f32f28a4fdc11d3861610be448911cb45fd9bbe1ca992f2347ca5e0a1caae42f3428d15de19ca2739439b9b0d5733225cb79d35d5c4e9f619c390915cd6aefae74cb8de325bd78982f05c6ae7a5c56f7f05d53946e4bb49d3f7ff80ae873efa9b705f14d3c922723cf3bd20d1a44c15d99ac92b754cd04c3e101b4eaf0600c31d2ad308588c5acce026ef0607c66840c51c205306f4af355549300fc13e740d4562bfce8b757ffa723302de38756ac8a879f6fac19ca666330de7e585c9d8ded19306448fc1e1751d1e3ea9fe398731fca36ac6832b24c3fcf92eb99b9d8978c1f8eac687e535965530bfa593341d7b1076b0d530c558941176f355e153fb49df11e642aa96edb0950bad9d416ab901b6e44f29d429cd2937e1a525889969bc2eb956c75b3d5d060aa221c51fe52c85d8e01171a6e35a356f72cfaec30f1d86573faf12c354d86498b3de9f56d6a637c1d323435b06e7f33daafd06d3ba5ec5124de849573b79b9200969dd922492222c316f212409ff88ba9f2feb91e0b7e906c20a78b214f891e4b552ad418eb7b4d2188d7fbcf03e560e9418a9e18e4bc632857dcbbf562230b592ec46153b0c2c81d0f9ef96339437065545eca6b51f27f98642f2bffe33fd7f5617311e48a1085281fe2ea723258986fd950fd5c9525f846e1c701aaa4b08edc159e9449f786ce51e95f143eeebb682d7d01815d6f94188a5757e0e7d9d49a81909238540d6aa59e477e8424a62bff69a89ee2e35b8b0111687d7ee456ab2d35fd1d679fcfa0fe14ad87ab17b0f1377f9217fa4eae6c35b05e200ff63eaf581f2c6c71583ffa0d74f34170d9ba103d131c35c66de822c78275b3cd9923a5d033998ae162ae67973d745f47dc0348eb2b33ed9e3c2e6b890f05d4dae12b5c5d857cc846e8e9953500a9c09ad2876d4db394de77f9dc74bf3016919b23ba09fadcc4c733c0b83efcb717e520f4ced7634570ba0964af4606ddb2682505314250e3e0af0ecf448f6ac465d910e356f753c6657dc1a11f787a46eb0ebe88be9bfc8af886270c87b7d06558d311865975dcaa59b56bb6ffe0522fcd274b5c7ef3c646d392fd6724c2c4a90febd40719a7632269fee02c343052bbab8c84b07d775a35099ac70aa5f311e21c48735f43827ae06126072f936b88f0138065924a5d3d2067d65f5e7fd793d350ad047aec58b8e4253e0295d458ca02d60eb0f3997355c31e0bf91812aadaad084d792ed33db1d9fcf1bfcebb3e23c34d8099ed8bf6a1aea79a92eec1f238deed1270e2da1e7f26a754402e9f7f89a4af246aea300891474c6a417b121ba0449ed8b3042a6cf0589832613c6d782add44769063e5db355667e318aab374e7edca502b17dd314750bfd79f3cf05bca99f2286a21ed6923ca0e9e47d396cb58cee52347ac350803367ff0ec9871d87959b89c0308d7c087a99e78cd50cdc02279cb02a0936d7256af2ece0013c719b2467d04095fcc8167170cc7b39315ac45d41bfc5b02f9055ab65231c4a7ff23bf3d0ad42604b2a41ed6cbbae248bfceb042a477385462a43fac47549c80dcf7d561c80d6a8ca98e4f868b33ee1d19d3e913b7051c8f17794ad052379db71428082be02036229fea848ba97997e3dfaae47ad15ff09695eb774e2116ffcb5adfc0642fd44f414ab2d7f5f6c87eb9334d513f21f55bacde8839115f0425e5ab058ad8c3c89103b74cd7c84429151015380aa7e492feef2b9e74be1b562ee7550051e996a2fcf249c4a2624959ec68c0ab81c7013c6e892852d72b34193473a69436ae2689d1abeab9a2b757eafdb7fe8b9c75413e71a8f9e3aff743160f8033672519289d60f96369f8ea0cc2e403532feca353869f1eeef4bcc2cf4cf5ad293fb9d5ddf52e1fd5299dae7ba8e5a6ccdba6e65241276f3347abdd9192d7ba1c6a08e56f6af768aee16ca1e0c7f533d2200da3c1f9798feeb6cf1d7d880f1a119d1b2346c4a7d8e0c638f37230e56888956958ff49cc3949805a0254ca52dca2c7e278cdd346c0b89f0fa8fbe3f4ee5092e9df0938c128feeee4143e90d18881a4791a7719e40af2c4b66a1174461f9f97a206aa60b8f51af267a6fab9d3ea7e12e80eb10814b9da7f7a10cf80fbc03e2695b59ff4abc39592409ea00fcb6bdb457579bc1ece5c64db8885bad616cd7780a08a2efdc8553b134731a217614746bb7ec63ecbd0ed1783921c3d00a74569d3761941dd74a71f364151f37c14d4a5e68d92fc31d916419d5052599ea0816e515ae6781a34e8b1882d12e986c0224562ed6851109ee44323a7bb832fd08b525913327135f148764f7ca26b345b928127da32688f51fae19a5d6ddfee4f633ec9195b4f3f7b09df1242dd56470fb16ee69e46479a287283ca1c838b8baf24e4a4c8f348006e3709b3d105b70d967045ec4fce37a8aae5b1b80ca35ad1a88b1e4e2f6e870bcf9c01b6c9301b5b81a2e20f10fe9d5f01a906b4d5fcfea764187a5f8f6c4be240056788cc32cc580c264b05f9aac21438ff635157b9e8f381f9badf814330b8b6f96e33b3336c92f4ce3baf31681d9e47d6a56bcf322ce53198c0518b5628a55bcf77c5c7d6513d0257f19de45973e03e9b90b5629f5e2e7fdb4720e6267bd85ecd365ba47f2db690db44767c2d4025224547863792a505ae4db345df46f2da7337479dfc857983ff6bbc9254666048b56ad62d37883a7d1b73bb20202e83b43f8939efa40d5a622cf47e8b1d2060fb4e8b9cdf2e9be3605003b155b63f87569102d4549b0583da1962e64f0b5820ca29575d84b3be3a7ce16707e1bd960d2690602439e08af3f86266d4a8f2e0cd02647bd3f409e81a64859f9f5af5f2c9583c2a3d748d8de152f67dc55ee718ec01a628b7e7e55664523fe25c99963f31d95ab90fb3a3fe8cba42c5f336061f91c3138dd2206a49938af0f4cd728e50e49075ddddbed9f1710baacaa84db63ce9f2f7f527c641d5dd4779d92f6ca8d7a7a6936b075c0ce8be994ec56f03364f889c37a75c8d8e57cd36e53a0ef41c7e5c2a645c6856b4dd4d3ed4409cc14563fbc8d9428d2463efba6439c395ebe16d9a0567777d6b5143223d0f689c1680ae5b3d0407614fd5b7f187214fd8ab6c2e0fe3f5e22d7a3f65182ed3593bf20eddfe15d3aaa167f021788bf4c7ceb6490b1f95b8c198041fac214983dd64e910d03a3595fa010ef993f1746f179a3f4e3b49caf9e7c4bb007ddaa3308e2a7af0d034d38b5c274b9b7320e37fe3ea7cdceaebae7710a4a019bbd13b6ada2cbe1be42c9d6e4a45923ec0865888449818052604360045a9fd8a671daa37cc44f812f100954bdee8d5cc2d5a9692b62d9f244f75ed9abfeec4354c35dc992b5d0b41b18c7d8d741350d1cbbde03d5abef8d94278f9ff240ea77ca22b59a2ed3bd2e45c4f0572776ba1651021a373a13da07efc9bd520577fa54efa7453f2889a7581d39799b9c72e9fc619434b54f33f9b1c2cd1d6427694c878b59df3869d6ec6c69dcbdab43c755a418e82060299779d989d0b22a48c94c2c75b8fc402019e1c00c3b703c4f43be843bc66f3c1052f9a0c6397895d1cd8d713d5ef98bb048f496199d360b8861e98b6a0c2c06c219ecacff95488dbb7c8d60882d8750598b6523ca5dd6d26c73f06a9646525cda115c7b77b3827a5dc23e5e02bbfe0da3146b3132f5ea47338658ef6bb178dcde5c22ed028b6fa78684b5715c0b2122ef30620fffe02308afe3ef34644f81bfaa416d235869474c55884d1e393b45e4358339d622a3f54cafc426158a26e7adc8cb1c86f95012cbc54e1b77a3fb934b3c33673e801e6f709f67cb44513879120e5fa56deb750b61c937d8f437d865c6d0c802e71013b53a9df31b2430f4aca1a1cf2e2c1f8c27c7de74aa281651715f196b6568d2e420de497b9d4be65bccd799d6a8fdf9828ae9cbee4c94125a91d05e2b2a81031b02bbbded66f7257ae8a0cec0ed55d50b32ecaa39c8ddd369f6e78703b2a2d11cd65781e4834bda069ddb269f04eb1b224a822a0935c08fd3dfc20d4b0c44590ee316e0aa4b9fda843af3cafebe55a6e317b26f82b703a53887f79f1a24d45e9e3f00d20787aa40b8e7fa9d214f3bcfd5fc08fa5532e0fd6b22c134e83c3347ed384d359723590ce1b79a2b7400cd18cd41d54061e30833d4c6116a6dac6b7864819f48e1d45a566b6ae0f685dc43e206a15c80c7e121b6f6759a288d455384aa2d89b7012e782ad580428b33146779c9a37405e12cc51113c6ce591f71a104d52860eb37657b470e5ac85590a1f8993de9a2e8e8a51602119d8ef2b8609a9142690dc6b8b454544099117bfb69f41dc28ec373c2cab0c0594cc4029ec26e99db32072963ade63c1540f424d9af1f27db29ffc7a359fc2d75acb1616225c09c413af82110109d175f7f9e7bf637bb5ce119609da119dabb44f39fe35d78543e7747c05159a9f69b08b3d7026b878ecf2daa1be888f48315d0a79d71e8d1d3f4c2ce2a8a80e8dd5c1b19ae84664a0c05dbdff5893c2e1fc39dded6fb71ab70d397a1a30f306b8880882301402098a4f4330322b802c406c1657138766877f91d9fcf4ead991d9b762ff4b157d7a4df52d46c42a9df61be3f261bcd6612861ac4cbbf9c10fa473753ac7aba80e30bc800176b9e8c21e57380adfeec28501cf2a0f6b1712d0fc1e49c1f7de3a7efb16bf7b603bc42c0b281d7075311d67e389fe45f846dc07f239bc159c23c019167a4e141c76d899ab8c3eea0bf983643d237a902f5a207abd7b835a730b3124792355d4c6745f808bb41ee725e3e58bd3561673cd50ea733cfc241362f6fc80f55f24978930eb22736e4959cf77b4eb17bb04ac1e0d47e2faa1a4e1fc2bfa5ebca61a25d3b34c98871539e459456f65bd641d812a2be4169c410bf628be3204b80c775bbe2e310b7f6c2585bba6ad673c90319956bf887f309860882f36743bbb117fe302fd7b5c50e77b33afc397ec529111bb17903d7e7f052df8ab85d66e1ba3cadcd219a112f4dbafc78aa4678fb1661aeccc6702aea79da7cda045d4aae90e4850e7eb20731477c41bfff6bc99e8813c86f48ad809f62c661efa92458d273f6d854bebfe66e392c915e38afc28c69a76814bc7790eae8c9b850f228d9a9cd32558afede37bf0eaef80a5aebdfa8eff0960886da8c819f0e9798e4b15bc88868688022aa9cb0ceaa64257577bd0c6a6905f315d5639097c544f953d4b717813db9f727d979430306a42b2c4b0d6fed7049cfd45bd09b7faf75e02c081b6668540695b80047e47d3971d2c869ac4c6cff8470ac89f8552957e4cdf4d4989a86fe5241753818d22e5c7115f9c161f30a18dff6c3e3b584a5175f2469bedaca4ece583308ed77d8c53bbefca9c375721dcf0010c7234bcc34eed99b19f4ac1a7708e0a6fbac70a4d826a605fcf531d630685ac189cee6bd066fd8ed4a9f5f8ebc4f3966f3f78439cb0652c990f06b0509d28b65c15117d5d55c2c917c9bc3ff7fa8f5c13e00871661aea273eb570305570fc639243f73bafe2bb15d7b5f153454908e3bfec88fa2fe796ebae0ff2324eb90dbe547f4102110f54a62ae4307dc2f61bff5857872666addfe9691581a621c791cae21bb8fd54231dbb70f18ca198540a8fac24be9661d834616e2651dc836baa21b958907dbddd4e442c48e046996af4f86363bf0cb777e3ee529256af593b8e93198fb60fd056e2cc289a14d358781714f922dff7b751e09e06cd33767a20e2ab90e25b1cf08d16290fe8f2acb72153bc787055fb31380f680f27aeb34656ce66898bce13c1ed4bd5e7ade0e8dd6088e83024bcc8ff7a9e3f7b17918613810861544e7762bb6571bb0a1283f1fc05ae2109ce10e7538af6c59a244f9a5a82d6870d0a2a51239d9d4cb773c84db3970e819a8476453e933f53758db7ffe77a743b8c0c4f4790e5c5078fde4aa4fffd51c46c3f23828f741dd40afc89845c3871edcb6559c4ee2956cb16f1b0a865f6205aaecee0a7dc1c69e38a036ec10c607856a58dec8b9d9d72dd91a91699c5782b0b89d4c8561297e1eb776c6bacf8433fa6f2af1e1b9d1765d19f7033d8d11991b498aabaada356e7a1f029fea779ab35e4bcc78c006b5323ef87ceb07e9a22ee6978dcdba74d6bc696e1b9affe5c93fcae650dc904abc87625a25e38b392f50b4e03cf28e9c727f7976ba786d24cf2843fee81a83fe49bb6e2391751ea7bbe80bb1efc5913167932bf931687f798f306b62c411b096c8ded273c04ec6ce2e9321f8e641eb75844cfdd7ed63c8aae5b9f504842d3e6c9bb82bc503779c6b6a3f903456bf31f7c8ddabfda9cf4e3e14fcabe252c8b4e2b5d763dcf90e81cd6bb902017f943507bfc7779e0c81101039382dbaaba3a775431f9c1cb648c6532ecfcd29894f0b76d5560537b51e469a6198acb919bcd3df754159f6facd517d8ca10f69549dc6eef47b4c164b81e5b8bc0bfe4a29361c26c9bd73688cd2078278110683d12e16202d05ad6d25fdbc4562cf9920801f828fdeaea6a3d39f09650f2437c325f5fc5282ba75c12c582776e1aa1c75623b7b8b84405cb4a6c209a1686d5a1b6490a888e6058f90cdf1816b62a1e3e9f722596127d2826a0ed74d91f232a83de3e3553326081b13c15ea30c8ae4cb8fb0e556e2a65aac3b8b137223c75e95aceaa47684af84f2eee793fb4a1311586d369e2bbc33a95dd3fd4e319aff5f61719278580c085b44c971e858d05f933db14fdea017649621f7f9e75391621a16a24742829c891fcd3a850913feebad9631c21e4a0780917f57e6ec1e3abc51eed0eca2e373adbf1d7c0995a1b56ab31ab730b36fd5a70dc34e8c673e6827cda184ca8a1437c8d8016e559d6a9dd7a7fde140f3a986b6031f00954a696d53b0e1180150233bfe4e2cce059957e3812e93471a03f621cffd017475e36e919a5ca3308fd9b713196f49cdabae926d819b3409e71ddb942a3e3eef09b3cc4f25f8ff1702c72f0547182c8b5c2414360bf9398d1b9a0ba10e10b371e9310187182cb68302ff5c9f51939ea5c3550d020a04c9e19fa355a14358e04acd1688c882c3d1abd12d1eba5c2cc280d988917dd449295df84e7f08527041dfc7a2840e96e791204fc6420339e66fa8682d0d40ed4e5d653b7970d3390b1539beb76a8a09ccb7918d04309cee40204553416f7be9120738832dbb00d3cb1cc3cf553114d089ef4799c64bdf8ac319923697398934f0a15d76a9659d8c9222d3f689b6f998e8b7e85c2c9543fd56a444c386458bdcaf371800a57fc9805eb26517b4cedca3ed9156bc2a621203839960cf686125f254fea84df57179cadd5eaa32dfc3d30a18ff9ee4459048a615062468cc33fdb1f9032731f27107729a9491d5301f9ef820b84154b801f3dc35e339265d123f4cb2ce16ca01afa90ca940b455650428ff5eb11513fd3af51c9e86a91e3e75174f5a55f7dd9acddfe774266016f1ddd68eb83d2c48385514ef1c219b871bf7c7fb41cea96c98bfae534fa539cd91ebd7dd619ada45a89d6d5cd320824be4cf9049c1b960bc61522402f93b79e7b225931f64ec38b03562004a018598fdc29a1cbb0a998f7fddc5123a3aaf2f37124f959fa751aadb91fe6ac79c3adb03249f24c38b5696bead349b391cba7dc2a4d5b87a989439c45f4ec6cd5a56e9f59b9d780f63a2fec52fbc6e54a576fbe348c8d83152f89d0886e798b4149424684070456e467201425e0549bb1f88307339858b7089f2339f8fc7a0ed241edd70418b551409d5e8b53a7846875a519e43d4102e350ad5fc4473bd042b6cec2a2477bc9dd78a415b030c38874b7f3e9142f0bf813bcddbe285b302861c41c376f8d7ebd3f5395cccbe0bb68a8c0d9b122163af537c6923d9110efaefdfbd7740d430d6cf897b690419af26bc56677a732aef39f975970da4f0fe3e56f52926dbb7d50d4a4eff19e3695aea97882bc852ecef3b827544df24e60814d782a343d010026fec80634f470d584aab87f6d3c3bfa2b4396ba05e792b745f2b64a3a0706b3092e0874a3aa669a23ecfd513591d60bf138b0f7e1f70d4a352efa912a34879e5ea5701d9c7fc1ab9bbce67df15a221260b6ee096221a9d21ab592e9b41aba3ea9aa01a53b8e4cb42f4441b932304823f0286db418b1e28329ae9c2dbdaf9d496d73cc70c974b330dca08d685c8299f2d48842cf810e9f95403eddae7443aed230346cd4f2ccc1e885e2f1d66353d6f9df2988f9612637484cbaf166d6cd2a0111bd6ee970dcef4a82948f4cdce64b0c6601729236587e216e574d32d1f128ead7d4f95b8ec069f3355019d98b886341db239e6552c2022260910e331a46e62a2c1a53b3cea9eadba3ea688a6290f84f7047e199615d71633a6d3cd5cae037fc2406cd81590eb8c3bf339e8df1e8521a38444a5496ff27fdc792bd5965386cd1e9fea48ca3884fd8e3ac166796332ef74d378aace860f22cab4888205c8c1b9539ca838316d9f84340bf6ea9221f02c76d44adafbcbce9f3b1a380d4c023ca64574695af2c8fc5c295849a38bedca9480aef223227c693e48df880a06257b6e18ac4b1e019b3edb526b3869c294c912b67b40b76e59054ec484f66c5621b22e4b80b7cc550fe0d9f3004f73cef7665b6dde6d9b1695976866d604cf041b175e74324c0028401b27bb9b32f630c3015ec66eefdab74f7f502d9595c16988d99ee251f72c6f4e03a68c6c38605ab6a17d914a3b1e78b7532b2ab43fe9fcbb0830e8cb5138e8e3dec5e2c7d19c660fed9a7b44727ab6b9468eb6189ad9a90f0d087477e81ec38da23e8b0c86a63264898028a36b9aa0728c38d8fbd76939ab30dfd646fb520e824e1ff0cfce823c63d5561ec3c6a0cb856818882b959ae4fd299b741fffdec196f8d0b0f89b236ae6003c11617706814f0fd4870fb16a176a732368988fc0500ed71e99719256119ab5d1512ec0c7f856600a195a77ac5ceaf0b883bde8f7a63c1c963583ff8656a7c5036a04ffbddc9d6b2c3254db9d32fe60b8ee913308543878e49624482469dc6e8e6b23c294fef7e79be2f23b19350a2e44441e577507713c60189587295a008c0f0250f0523663bf6ab99fc9</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> ENCv1 </tag>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Summary</title>
      <link href="/archives/1955fff/index.html"/>
      <url>/archives/1955fff/index.html</url>
      
        <content type="html"><![CDATA[<p>Here directs to some frequently used pages</p><ul><li><a href="./archives/7ca3cc72/ic-calculator.html">IC calculator</a></li><li><a href="./archives/ffa08d7c/useful-mathematical-formulas.html">Useful Mathematical Formulas</a></li><li><a href="./archives/5777cf8/frequency-response.html">Second-Order System</a></li><li><a href="./archives/3951eef4/programing-with-matlab.html">Matlab Usage</a></li><li><a href="./archives/bf359c5c/mathematica-tutorial.html">Mathematica Usage</a></li><li><a href="./archives/706864ae/math-typesetting-in-latex.html">Latex Usage</a></li></ul><a id="more"></a><p>The above links might be wrong here. Pleasee go to the main page and then click the link.</p><p><strong>External Reference</strong></p><p>Here lists some of the external references that might be useful</p><ul><li><a href="https://fbengineering.ch/posts/spiral_ind_and_mag_coupling/2021-08-15-spiral_ind_and_mag_coupling.html" target="_blank" rel="noopener">Spiral Inductors and Magnetic Coupling</a></li><li><a href="https://www.sigma-delta.de/" target="_blank" rel="noopener">Uni Ulm Sigma-Delta Synthesis Environment</a></li><li><a href="https://www.wolframalpha.com/" target="_blank" rel="noopener">Wolfram Alpha</a></li><li><a href="https://libgen.is/" target="_blank" rel="noopener">Library Genesis</a></li><li><a href="https://sci-hub.ren/" target="_blank" rel="noopener">Scihub</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Automatic Simulation with Ocean Script</title>
      <link href="/archives/d99e7696/automatic-simulation-with-ocean-script.html"/>
      <url>/archives/d99e7696/automatic-simulation-with-ocean-script.html</url>
      
        <content type="html"><![CDATA[<p>This articles covers:</p><ul><li>The SKILL language basics</li><li>Use of Ocean script for complicated parameter sweep</li><li>Use of Python for parallel simulation</li></ul><a id="more"></a><h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><h3 id="Running-Ocean-Script"><a href="#Running-Ocean-Script" class="headerlink" title="Running Ocean Script"></a>Running Ocean Script</h3><p>To use Ocean interactively</p><ol><li>In a UNIX Shell, type in <code>ocean</code></li><li>In the CIW, type in Ocean commands directly</li></ol><p>To run a written Ocean script</p><ol><li>In the interactive mode, type in <code>load( &quot;oceanScript.ocn&quot; )</code></li><li>In a UNIX Shell, type in <code>ocean &lt; oceanScript.ocn &gt;&gt; oceanLog.log</code></li></ol><h3 id="Ocean-Use-Model"><a href="#Ocean-Use-Model" class="headerlink" title="Ocean Use Model"></a>Ocean Use Model</h3><p>It would be the best to copy the auto-generated &quot;netlist&quot; folder to avoid file missing. For successful Ocean simulation, the following netlist files are indispensable:</p><ol><li><p>netlist</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// attenuator</span><br><span class="line">PORT0 (INPUT 0) port r=50 num=1 type=sine</span><br><span class="line">PORT1 (OUTPUT 0) port r=50 num=2 type=sine</span><br><span class="line">R0 (INPUT OUTPUT) resistor r=rt</span><br><span class="line">R1 (INPUT 0) resistor r=rb</span><br><span class="line">R2 (OUTPUT 0) resistor r=rb</span><br></pre></td></tr></table></figure></li><li><p>netlistHeader</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">simulator lang=spectre</span><br><span class="line">global 0</span><br></pre></td></tr></table></figure></li><li><p>netlistFooter (empty file)</p></li></ol><p>Besides, it is highly likely that map files are required for result browsing. Otherwise, a error &quot;In Save statement: None of the nets/terminals got successfully mapped.&quot; may occur.</p><p>The Ocean script is used to control the simulation. To do this</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; set the simulation engine</span></span><br><span class="line">simulator( 'spectre )</span><br><span class="line"></span><br><span class="line"><span class="comment">; set the netlist path</span></span><br><span class="line">design(<span class="string">"./netlist"</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">; set the model files according to the technology</span></span><br><span class="line"><span class="comment">;modelFile( </span></span><br><span class="line"><span class="comment">;    '("./model.scs" "tt")</span></span><br><span class="line"><span class="comment">;    '("./model.scs" "tt_tf")</span></span><br><span class="line"><span class="comment">;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; set the analysis</span></span><br><span class="line">analysis(</span><br><span class="line">    'sp</span><br><span class="line">?ports list(<span class="string">"/PORT0"</span> <span class="string">"/PORT1"</span>)</span><br><span class="line">    ?start <span class="string">"0G"</span>  ?stop <span class="string">"100G"</span>  ?step <span class="string">"0.1G"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">; set the design variable</span></span><br><span class="line">desVar( <span class="string">"rb"</span> <span class="number">869.5</span> )</span><br><span class="line">desVar(<span class="string">"rt"</span> <span class="number">5.76</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">; set the options</span></span><br><span class="line">envOption(</span><br><span class="line">'analysisOrder  list(<span class="string">"sp"</span>) </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">; set the parameters to be saved</span></span><br><span class="line">save( 'v <span class="string">"/OUT_N"</span> <span class="string">"/OUT_P"</span> )<span class="comment">; voltage</span></span><br><span class="line">save( 'i <span class="string">"/PORT0/MINUS"</span> <span class="string">"/PORT0/PLUS"</span> <span class="string">"/PORT1/MINUS"</span> <span class="string">"/PORT1/PLUS"</span> )<span class="comment">; current</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; set the simulation temperature</span></span><br><span class="line">temp( <span class="number">27</span> ) </span><br><span class="line"></span><br><span class="line"><span class="comment">; set the result directory</span></span><br><span class="line">resultsDir( <span class="string">"./resultDir"</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">; run the simulation</span></span><br><span class="line">run()</span><br><span class="line"></span><br><span class="line"><span class="comment">; plot the graph</span></span><br><span class="line">S21 = db(<span class="name">spm</span>('sp <span class="number">2</span> <span class="number">1</span>))</span><br><span class="line">plot( <span class="name">S21</span> ?expr '( <span class="string">"S21"</span> ) )</span><br><span class="line"></span><br><span class="line"><span class="comment">; save the data</span></span><br><span class="line">ocnPrint( <span class="name">S21</span> ?output <span class="string">"S21.csv"</span> )</span><br></pre></td></tr></table></figure><h3 id="Browse-Results"><a href="#Browse-Results" class="headerlink" title="Browse Results"></a>Browse Results</h3><p>After the simulation, the results can be browsed independently.</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">openResults( <span class="string">"./result"</span> )</span><br><span class="line">selectResults( 'sp )</span><br><span class="line">S21 = db(<span class="name">spm</span>('sp <span class="number">2</span> <span class="number">1</span>))</span><br><span class="line">ocnPrint( <span class="name">S21</span> ?output <span class="string">"S21.csv"</span> )</span><br></pre></td></tr></table></figure><h3 id="Types-of-Simulation"><a href="#Types-of-Simulation" class="headerlink" title="Types of Simulation"></a>Types of Simulation</h3><h4 id="DC"><a href="#DC" class="headerlink" title="DC"></a>DC</h4><p>In the Ocean script</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; specify the analysis</span></span><br><span class="line">analysis('dc ?saveOppoint <span class="literal">t</span>  )</span><br><span class="line"></span><br><span class="line"><span class="comment">; browse the result</span></span><br><span class="line">IDC(<span class="string">"/V0/PLUS"</span>)</span><br><span class="line">VDC(<span class="string">"/OUT_P"</span>)</span><br></pre></td></tr></table></figure><h4 id="TRAN"><a href="#TRAN" class="headerlink" title="TRAN"></a>TRAN</h4><p>In the netlist, specify the ports</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// piecewise-linear voltage source</span><br><span class="line">// for the wave parameter, write down time-value pair sequentially</span><br><span class="line">V0 (INPUT 0) vsource type=pwl wave=[ 0 0 10p 1 ]</span><br><span class="line"></span><br><span class="line">// sin voltage source</span><br><span class="line">V0 (net032 net02) vsource mag=1 type=sine</span><br></pre></td></tr></table></figure><p>In the Ocean script</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; specify the analysis</span></span><br><span class="line">analysis('tran ?stop <span class="string">"1n"</span>  ?errpreset <span class="string">"moderate"</span>  ?maxstep <span class="string">"1p"</span>  )</span><br><span class="line"></span><br><span class="line"><span class="comment">; browse the result</span></span><br><span class="line">vtime('tran <span class="string">"/OUT_P"</span>)</span><br><span class="line">itime('tran <span class="string">"/PORT1/PLUS"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">; clip part of the X axis</span></span><br><span class="line">clip( <span class="name">vtime</span>('tran <span class="string">"/OUT_P"</span>) <span class="number">0.5</span>n <span class="number">1</span>n )</span><br><span class="line"></span><br><span class="line"><span class="comment">; perform Fourier transformation to get the spectrum</span></span><br><span class="line"><span class="comment">; signal, start time, end time, number of points</span></span><br><span class="line"><span class="comment">; freqMax = 1 / timeInterval / 2 (Nyquist sampling theorem)</span></span><br><span class="line"><span class="comment">; freqResolution = 1 / timeDuration</span></span><br><span class="line">dft( <span class="name">vtime</span>('tran <span class="string">"/OUT_P"</span>) <span class="number">0.5</span>n <span class="number">1</span>n <span class="number">1000</span> )</span><br></pre></td></tr></table></figure><h4 id="AC"><a href="#AC" class="headerlink" title="AC"></a>AC</h4><p>In the netlist, specify the ports</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PORT0 (INPUT 0) port r=50 num=1 mag=1</span><br><span class="line">PORT1 (OUTPUT 0) port r=50 num=2 type=sine</span><br></pre></td></tr></table></figure><p>In the Ocean script</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; specify the analysis</span></span><br><span class="line">analysis('ac ?start <span class="string">"0G"</span>  ?stop <span class="string">"50G"</span>  ?step <span class="string">"1G"</span>  )</span><br><span class="line"></span><br><span class="line"><span class="comment">; browse the result</span></span><br><span class="line">vfreq('ac <span class="string">"/OUT_P"</span>)</span><br><span class="line">ifreq('ac <span class="string">"/PORT1/PLUS"</span>)</span><br></pre></td></tr></table></figure><h4 id="SP"><a href="#SP" class="headerlink" title="SP"></a>SP</h4><p>In the netlist, specify the ports</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PORT0 (INPUT 0) port r=50 num=1 type=sine</span><br><span class="line">PORT1 (OUTPUT 0) port r=50 num=2 type=sine</span><br></pre></td></tr></table></figure><p>In the Ocean script</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; specify the analysis</span></span><br><span class="line">analysis(</span><br><span class="line">    'sp</span><br><span class="line">?ports list(<span class="string">"/PORT0"</span> <span class="string">"/PORT1"</span>)</span><br><span class="line">    ?start <span class="string">"0G"</span>  ?stop <span class="string">"100G"</span>  ?step <span class="string">"0.1G"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">; browse the result</span></span><br><span class="line"><span class="comment">; or S21 = db(sp(2 2 ?result "sp"))</span></span><br><span class="line">S21 = db(<span class="name">spm</span>('sp <span class="number">2</span> <span class="number">1</span>))</span><br><span class="line">plot( <span class="name">S21</span> ?expr '( <span class="string">"S21"</span> ) )</span><br></pre></td></tr></table></figure><h4 id="HB"><a href="#HB" class="headerlink" title="HB"></a>HB</h4><p>In the netlist, specify the ports</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PORT0 (INPUT 0) port r=50 num=1 type=sine freq=fin dbm=pin \</span><br><span class="line">        fundname=&quot;RFin&quot;</span><br><span class="line">PORT1 (OUTPUT 0) port r=50 num=2 type=sine type=dc</span><br></pre></td></tr></table></figure><p>In the Ocean Script</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; specify the analysis</span></span><br><span class="line">analysis('hb ?HBTranMode <span class="string">"No"</span>  ?tstab <span class="string">"0"</span>  ?saveinit <span class="string">""</span>  </span><br><span class="line">?autoharms <span class="string">""</span>  ?autotstab <span class="string">""</span>  ?oversample list(<span class="string">"1"</span>)  ?funds list(<span class="string">"RFin"</span>)  </span><br><span class="line">?maxharms list(<span class="string">"3"</span>)  ?param <span class="string">"pin"</span>  ?start <span class="string">"-30"</span>  ?stop <span class="string">"4"</span>  </span><br><span class="line">?sweepStep <span class="string">"2"</span>  )</span><br><span class="line"></span><br><span class="line"><span class="comment">; save the current</span></span><br><span class="line">save( 'i <span class="string">"/PORT1/MINUS"</span> <span class="string">"/PORT1/PLUS"</span> )</span><br><span class="line"><span class="comment">; save the voltage</span></span><br><span class="line">save( 'v <span class="string">"/OUT_N"</span> <span class="string">"/OUT_P"</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">; browse the result</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; obtain current at a specified harmonic</span></span><br><span class="line"><span class="comment">; analysis name, terminal, harmonic list</span></span><br><span class="line">ih('hb <span class="string">"/V0/PLUS"</span> '(<span class="number">0</span>))</span><br><span class="line"><span class="comment">; for rms value, use</span></span><br><span class="line"><span class="comment">; note that for 0 harmonic, only the peak value is correct</span></span><br><span class="line">rms( <span class="name">ih</span>('hb <span class="string">"/V0/PLUS"</span> '(<span class="number">0</span>)) )</span><br><span class="line"></span><br><span class="line"><span class="comment">; similarly, for voltage harmonics, use vh</span></span><br><span class="line">vh('hb <span class="string">"/OUT_P"</span> '(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">; obtain current waveform at all power levels</span></span><br><span class="line">itime('hb <span class="string">"/V0/PLUS"</span>)</span><br><span class="line"><span class="comment">; use value() to filter results at specified levels</span></span><br><span class="line"><span class="comment">; waveform, sweep variable, value</span></span><br><span class="line">value( <span class="name">itime</span>('hb <span class="string">"/V0/PLUS"</span>) <span class="string">"pin"</span> '(<span class="number">-30</span> <span class="number">-10</span>) )</span><br><span class="line"><span class="comment">; similarly, for voltage waveform, use vtime</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; obtain current spectrum</span></span><br><span class="line">ih('hb <span class="string">"/V0/PLUS"</span>)</span><br><span class="line"><span class="comment">; use value() to filter results at specified levels</span></span><br><span class="line">value(<span class="name">ih</span>('hb <span class="string">"/V0/PLUS"</span>) '<span class="string">"pin"</span> '-30)</span><br><span class="line"><span class="comment">; similarly, for voltage spectrum, use vh\</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; obtain power at specified harmonic</span></span><br><span class="line"><span class="comment">; analysis name, voltage +, voltage -, branch name 1, branch name 2, harmonic list</span></span><br><span class="line"><span class="comment">; usually, branch name 2 is set to be 0</span></span><br><span class="line">pvi('hb <span class="string">"/OUT_P"</span> <span class="string">"/OUT_N"</span> <span class="string">"/PORT1/PLUS"</span> <span class="number">0</span> '(<span class="number">1</span>))</span><br><span class="line"><span class="comment">; use dbm() to obtain power in dbm</span></span><br><span class="line">dbm( <span class="name">pvi</span>('hb <span class="string">"/OUT_P"</span> <span class="string">"/OUT_N"</span> <span class="string">"/PORT1/PLUS"</span> <span class="number">0</span> '(<span class="number">1</span>)) )</span><br><span class="line"></span><br><span class="line"><span class="comment">; to calculate power gain</span></span><br><span class="line"><span class="comment">; it is simply output power divided by input power, turned into db</span></span><br><span class="line">db10((<span class="name">pvi</span>('hb <span class="string">"/OUT_P"</span> <span class="string">"/OUT_N"</span> <span class="string">"/PORT1/PLUS"</span> <span class="number">0</span> '(<span class="number">1</span>)) / (<span class="name">-</span> pvi('hb <span class="string">"/IN_P"</span> <span class="string">"/IN_N"</span> <span class="string">"/PORT0/PLUS"</span> <span class="number">0</span> '<span class="number">1</span>))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; to calculate compression point</span></span><br><span class="line">compressionVRI((<span class="name">v</span>(<span class="string">"/OUT_P"</span> ?result <span class="string">"hb_fd"</span>) - v(<span class="string">"/OUT_N"</span> ?result <span class="string">"hb_fd"</span>)) '<span class="number">1</span> ?rport resultParam(<span class="string">"PORT1:r"</span> ?result <span class="string">"hb_fd"</span>) ?gcomp <span class="number">1</span> ?measure <span class="string">"Output"</span>)</span><br></pre></td></tr></table></figure><h2 id="The-SKILL®-Language"><a href="#The-SKILL®-Language" class="headerlink" title="The SKILL® Language"></a>The SKILL® Language</h2><p>Skill is a programming language integrated into the Virtuoso environment to extend its capabilities. Its grammar is similar to Lisp, with supplemented useful features.</p><h3 id="Operators"><a href="#Operators" class="headerlink" title="Operators"></a>Operators</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+<span class="comment">;plus</span></span><br><span class="line">-<span class="comment">;minus</span></span><br><span class="line">*<span class="comment">;multiply</span></span><br><span class="line">/<span class="comment">;divide</span></span><br><span class="line">**<span class="comment">;exponentiation</span></span><br><span class="line">==<span class="comment">;equal</span></span><br><span class="line">!=;nequal</span><br><span class="line">=<span class="comment">;assignment</span></span><br><span class="line">&lt;, &lt;=, &gt;, &gt;=, ==, !=;relation operator</span><br><span class="line">!, &amp;&amp;, ||;logic operators</span><br></pre></td></tr></table></figure><h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\;Escape for special characters</span><br><span class="line">( )<span class="comment">;Grouping of list elements, function calls</span></span><br><span class="line">[ ];Array index, super right bracket</span><br><span class="line">';Specifies a symbol (quoting the expression prevents its evaluation)</span><br><span class="line"><span class="string">""</span><span class="comment">;String delimiter</span></span><br><span class="line">,;Optional delimiter between list elements (different from Lisp)</span><br><span class="line"><span class="comment">;;Line-style comment character</span></span><br><span class="line">?;If first character, implies keyword parameter</span><br></pre></td></tr></table></figure><p>Calling a function</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plus(<span class="number">2</span>,<span class="number">3</span>)<span class="comment">;C style</span></span><br><span class="line">(<span class="name">plus</span> <span class="number">2</span> <span class="number">3</span>)<span class="comment">;Lisp style</span></span><br><span class="line">plus(<span class="number">2</span> <span class="number">3</span>)<span class="comment">;hybrid style</span></span><br><span class="line">(<span class="name">plus</span>,<span class="number">2</span>,<span class="number">3</span>)<span class="comment">;hybrid style</span></span><br></pre></td></tr></table></figure><p>Defining a variable</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">2</span><span class="comment">;C style</span></span><br><span class="line">(<span class="name">setf</span> a <span class="number">2</span>)  <span class="comment">;Lisp style</span></span><br></pre></td></tr></table></figure><p>Defining a list</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = '(<span class="number">3</span> <span class="number">3.14</span> <span class="string">"abc"</span>)<span class="comment">;use a ' to avoid evaluation</span></span><br><span class="line">a = (<span class="name">list</span> <span class="number">3</span> <span class="number">3.14</span> <span class="string">"abc"</span>)</span><br><span class="line">(<span class="name">cons</span> a a)<span class="comment">;concatenate lists</span></span><br><span class="line">(<span class="name">car</span> a)<span class="comment">;obtain the first element</span></span><br><span class="line">(<span class="name">cdr</span> a)<span class="comment">;obtain the rest elements (without the first)</span></span><br><span class="line">(<span class="name">nth</span> <span class="number">2</span> a)<span class="comment">;access data at the specified index, index starts at 1</span></span><br><span class="line">(<span class="name">length</span> a)<span class="comment">;count the elements</span></span><br><span class="line">aCoordinate = 300:400;equal to '( 300 400 )</span><br><span class="line">bBox = list( <span class="number">300</span>:<span class="number">400</span> <span class="number">500</span>:<span class="number">450</span> )<span class="comment">;equal to '(( 300 400 ) ( 500 450 ))</span></span><br></pre></td></tr></table></figure><p>Declaring a function</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">procedure(<span class="name">add</span>( <span class="name">x</span> y )</span><br><span class="line">x+y</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">; define local variable with let() function</span></span><br><span class="line">procedure(<span class="name">square</span>( <span class="name">x</span> )</span><br><span class="line">let(( <span class="name">n</span> )</span><br><span class="line">                n=2</span><br><span class="line">                x**2</span><br><span class="line">            )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">; use defun, note that defun accept 3 arguments</span></span><br><span class="line"><span class="comment">; there is a space between the function name and the argument list</span></span><br><span class="line">defun(<span class="name">add</span> ( <span class="name">x</span> y )</span><br><span class="line">x+y</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Loop and branch</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">;if</span></span><br><span class="line">if(<span class="name">-1&lt;0</span> print(<span class="string">"a&lt;0"</span>))</span><br><span class="line">if(<span class="name">-1&lt;0</span> print(<span class="string">"a&lt;0"</span>) print(<span class="string">"a&gt;=0"</span>))</span><br><span class="line">if(<span class="name">-1&lt;0</span></span><br><span class="line">then</span><br><span class="line">     print(<span class="string">"a&lt;0"</span>)</span><br><span class="line">else</span><br><span class="line">     print(<span class="string">"a&gt;=0"</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">;case</span></span><br><span class="line">case( <span class="string">"c"</span></span><br><span class="line">     ( <span class="string">"a"</span>print(<span class="string">"apple"</span>) )</span><br><span class="line">     ( <span class="string">"b"</span>print(<span class="string">"banana"</span>) )</span><br><span class="line">     ( <span class="string">"c"</span>print(<span class="string">"car"</span>) )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">;for</span></span><br><span class="line">for( <span class="name">i</span> <span class="number">1</span> <span class="number">5</span> printf( <span class="string">"%d"</span> i ) )<span class="comment">;including 1 and 5</span></span><br><span class="line"></span><br><span class="line">a = list(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">foreach( <span class="name">i</span> a printf( <span class="string">"%d"</span> i ) )</span><br><span class="line"></span><br><span class="line"><span class="comment">;while</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">while(<span class="name">i&lt;6</span></span><br><span class="line">printf( <span class="string">"%d"</span> i )</span><br><span class="line">    i++</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Datatype</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">nil</span><span class="comment">;atom, ogical false or empty list</span></span><br><span class="line"><span class="literal">t</span><span class="comment">;stom, logical true</span></span><br><span class="line"><span class="number">5</span><span class="comment">;integer</span></span><br><span class="line"><span class="number">5.3</span><span class="comment">;floating point number</span></span><br><span class="line"><span class="string">"abc"</span><span class="comment">;string</span></span><br></pre></td></tr></table></figure><h3 id="Useful-Functions"><a href="#Useful-Functions" class="headerlink" title="Useful Functions"></a>Useful Functions</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; calculate stability factor mu</span></span><br><span class="line">((1 - abs((aaSP(1 1)**2))) / (abs((aaSP(1 2) * aaSP(2 1))) + abs((aaSP(2 2) - (conjugate(aaSP(1 1)) * ((aaSP(1 1) * aaSP(2 2)) - (aaSP(1 2) * aaSP(2 1))))))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; calculate Vout vs. Pout</span></span><br><span class="line">waveVsWave(?y vh('hb <span class="string">"/PDET_OUT"</span> '(<span class="number">0</span>)) ?x dbm(<span class="name">pvr</span>('hb <span class="string">"/OUT_P"</span> <span class="string">"/OUT_N"</span> <span class="number">50.0</span> '(<span class="number">1</span>))) ?xName <span class="string">"Pout"</span> ?xUnits <span class="string">"dBm"</span> ?yName <span class="string">"Vout"</span> ?yUnits <span class="string">"V"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">; calculate equivalent capacitance</span></span><br><span class="line">let( ( (<span class="name">k1</span> <span class="number">1</span>) (<span class="name">k2</span> <span class="number">1</span>) ) imag(<span class="name">ypm</span>('sp k1 k2)) / <span class="number">2</span> / pi / xval(<span class="name">imag</span>(<span class="name">ypm</span>('sp k1 k2))) )</span><br><span class="line"></span><br><span class="line"><span class="comment">; calculate equivalent inductance</span></span><br><span class="line">let( ( (<span class="name">k1</span> <span class="number">1</span>) (<span class="name">k2</span> <span class="number">1</span>) ) imag(<span class="name">zpm</span>('sp k1 k2)) / <span class="number">2</span> / pi / xval(<span class="name">imag</span>(<span class="name">zpm</span>('sp k1 k2))) )</span><br><span class="line"></span><br><span class="line"><span class="comment">; calculate Gmax</span></span><br><span class="line">gmax(<span class="name">spm</span>('sp <span class="number">1</span> <span class="number">1</span>) spm('sp <span class="number">1</span> <span class="number">2</span>) spm('sp <span class="number">2</span> <span class="number">1</span>) spm('sp <span class="number">2</span> <span class="number">2</span>))</span><br></pre></td></tr></table></figure><h2 id="Multi-Thread-Simulation"><a href="#Multi-Thread-Simulation" class="headerlink" title="Multi-Thread Simulation"></a>Multi-Thread Simulation</h2><p>Spectre® engine itself does not support multi-thread simulation. To leverage the potential of multi-core processors, we can perform several Spectre simulation at the same time manually or automatically. One method to implement automatic parallel simulation is to use Threading module in Python to open up several threads. To achieve this</p><h3 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h3><p>The files should be arranged as follows</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- autoOceanSim.py# Python multi-thread control</span><br><span class="line">- result# A folder for the simulation results</span><br><span class="line">- ocean-script</span><br><span class="line">    - oceanScript.ocn# modified Ocean script</span><br><span class="line">- sample-netlist</span><br><span class="line">    - netlist# netlist folder generated by spectre</span><br><span class="line">- working-directory# working directory</span><br></pre></td></tr></table></figure><p>In the Ocean script, several places have to be modified</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; &lt;!--DIR--&gt; represents the working directory for specific project</span></span><br><span class="line">design(<span class="string">"&lt;!--DIR--&gt;/netlist/netlist"</span> )<span class="comment">; specify the netlist folder</span></span><br><span class="line">resultsDir( <span class="string">"&lt;!--DIR--&gt;/result"</span> )<span class="comment">; specify the raw results</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; specify the parameters to be swept</span></span><br><span class="line">desVar(  <span class="string">"fin"</span> &lt;!--FREQ--&gt;*1e9)</span><br><span class="line">desVar(  <span class="string">"pin"</span> &lt;!--PIN--&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment">; specify the folder for selected results</span></span><br><span class="line"><span class="comment">; &lt;!--RNAME--&gt; represents the "result" folder in the top level</span></span><br><span class="line">ocnPrint( ?output <span class="string">"&lt;!--RNAME--&gt;"</span> dbm(<span class="name">pvi</span>('hb <span class="string">"/OUT_P"</span> <span class="string">"/OUT_N"</span> <span class="string">"/PORT1/PLUS"</span> <span class="number">0</span> '(<span class="number">1</span>))) )</span><br></pre></td></tr></table></figure><h3 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">oceanDirectory = os.path.join(os.getcwd(), <span class="string">'ocean-script'</span>)</span><br><span class="line">workingDirectory = os.path.join(os.getcwd(), <span class="string">'working-directory'</span>)</span><br><span class="line">sampleNetlist = os.path.join(os.getcwd(), <span class="string">'sample-netlist'</span>)</span><br><span class="line">resultDirectory = os.path.join(os.getcwd(), <span class="string">'result'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">commandWrapper</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, command, timeOut, maxTry)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.name = name</span><br><span class="line">        self.command = command</span><br><span class="line">        self.timeOut = timeOut</span><br><span class="line">        self.maxTry = maxTry</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        run = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> run &lt; self.maxTry:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Start(%d) %s"</span> % (run+<span class="number">1</span>, self.name)</span><br><span class="line">                p = subprocess.Popen(self.command, preexec_fn=os.setsid, shell=<span class="literal">True</span>)</span><br><span class="line">                p.wait(self.timeOut)</span><br><span class="line">            <span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'Timeout(%d) %s'</span> % (run+<span class="number">1</span>, self.name)</span><br><span class="line">                p.terminate()</span><br><span class="line">                p.wait()</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    os.killpg(p.pid, signal.SIGKILL)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> error:</span><br><span class="line">                    <span class="keyword">print</span> error</span><br><span class="line">                run += <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Finish %s'</span> % self.name</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">simuController</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, oceanScriptName, maxThread=<span class="number">3</span>, timeOut=<span class="number">1800</span>, maxTry=<span class="number">3</span>)</span>:</span></span><br><span class="line">        self.oceanScriptName = oceanScriptName</span><br><span class="line">        self.__readOriginalOcean()</span><br><span class="line">        self.task = []</span><br><span class="line">        self.maxThread = maxThread</span><br><span class="line">        self.timeOut = timeOut</span><br><span class="line">        self.maxTry = maxTry</span><br><span class="line">        self.threads = []</span><br><span class="line">        self.closedThread = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># place cds.log file in the current directory to avoid collision</span></span><br><span class="line">        os.environ[<span class="string">'CDS_LOG_PATH'</span>] = os.getcwd()</span><br><span class="line">        <span class="comment"># name cds.log file with pid value</span></span><br><span class="line">        os.environ[<span class="string">'CDS_LOG_VERSION'</span>] = <span class="string">'pid'</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__readOriginalOcean</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(oceanDirectory, self.oceanScriptName), <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            self.rawData = f.read()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__preProcessOcean</span><span class="params">(self, conversionTable, currentDir, resultName)</span>:</span></span><br><span class="line">        tmpData = self.rawData</span><br><span class="line">        <span class="keyword">for</span> [x, y] <span class="keyword">in</span> conversionTable:</span><br><span class="line">            tmpData = tmpData.replace(x, y)</span><br><span class="line">        tmpData = tmpData.replace(<span class="string">'&lt;!--DIR--&gt;'</span>, currentDir)</span><br><span class="line">        tmpData = tmpData.replace(<span class="string">'&lt;!--RNAME--&gt;'</span>, os.path.join(resultDirectory, resultName+<span class="string">'.csv'</span>))</span><br><span class="line">        <span class="keyword">return</span> tmpData</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepareSimulation</span><span class="params">(self, conversionTable, resultName)</span>:</span></span><br><span class="line">        folderName = datetime.datetime.now().strftime(<span class="string">'%Y%m%d-%H%M%S'</span>) + <span class="string">'_'</span> + resultName</span><br><span class="line">        currentDir = os.path.join(workingDirectory, folderName)</span><br><span class="line">        os.mkdir(currentDir)</span><br><span class="line">        tmpData = self.__preProcessOcean(conversionTable, currentDir, resultName)</span><br><span class="line">        <span class="comment"># write the ocean script</span></span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(currentDir, <span class="string">'oceanScript.ocn'</span>), <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(tmpData)</span><br><span class="line">        <span class="comment"># copy the netlist folder</span></span><br><span class="line">        shutil.copytree(os.path.join(sampleNetlist, <span class="string">'netlist'</span>),\</span><br><span class="line">                        os.path.join(currentDir, <span class="string">'netlist'</span>))</span><br><span class="line">        command = <span class="string">'ocean &lt; %s &gt;&gt; %s'</span> % (os.path.join(currentDir, <span class="string">'oceanScript.ocn'</span>),\</span><br><span class="line">                                        os.path.join(currentDir, <span class="string">'ocean.log'</span>))</span><br><span class="line">        self.task.append([resultName, command])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">runSimulation</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> [name, command] <span class="keyword">in</span> self.task:</span><br><span class="line">            <span class="comment"># check if alive thread number exceeds the maximum</span></span><br><span class="line">            <span class="keyword">while</span> (threading.activeCount() - <span class="number">1</span>) &gt;= self.maxThread:</span><br><span class="line">                <span class="comment"># if everything's ok, wait for 10 seconds and check again</span></span><br><span class="line">                time.sleep(<span class="number">10</span>)</span><br><span class="line">            newSimulation = commandWrapper(name, command, self.timeOut, self.maxTry)</span><br><span class="line">            newSimulation.daemon = <span class="literal">True</span></span><br><span class="line">            newSimulation.start()</span><br><span class="line">            self.threads.append(newSimulation)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># wait for all the threads to terminate</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> self.threads:</span><br><span class="line">            t.join()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"All simulations have been finished!"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    sim = simuController(oceanScriptName=<span class="string">'oceanScript.ocn'</span>, maxThread=<span class="number">5</span>, timeOut=<span class="number">2400</span>, maxTry=<span class="number">3</span>)</span><br><span class="line">    <span class="comment"># add the points to be simulated</span></span><br><span class="line">    <span class="keyword">for</span> pin <span class="keyword">in</span> [<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">for</span> freq <span class="keyword">in</span> [<span class="number">29</span>]:</span><br><span class="line">            sim.prepareSimulation([[<span class="string">'&lt;!--PIN--&gt;'</span>, str(pin)],\</span><br><span class="line">                                    [<span class="string">'&lt;!--FREQ--&gt;'</span>, str(freq)]],\</span><br><span class="line">                                    <span class="string">'Loadpull_freq_%.1fGHz_pin_%.1fdBm'</span> % (freq, pin))</span><br><span class="line">    <span class="comment"># start the simulation</span></span><br><span class="line">    sim.runSimulation()</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><a href="https://acl.readthedocs.io/en/latest/zhCN/index.html" target="_blank" rel="noopener">ANSI Common Lisp 中文版</a></li></ol><p>SKILL® and Spectre® are the trademarks of the Cadence Design Systems, Inc.</p>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Matlab编程</title>
      <link href="/archives/3951eef4/programing-with-matlab.html"/>
      <url>/archives/3951eef4/programing-with-matlab.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了Matlab的基本语法及绘图常用指令。</p><a id="more"></a><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p>Matlab的变量类型有</p><ul><li>数值</li><li>向量/矩阵</li><li>结构体</li><li>元胞数组</li><li>字符和字符串</li><li>函数句柄</li></ul><p>需要查看变量类型时，可以使用<code>class(variable)</code></p><h3 id="数值"><a href="#数值" class="headerlink" title="数值"></a>数值</h3><p>Matlab的数值类型包括</p><ul><li>double（默认）</li><li>single</li><li>int8/uint8</li><li>int16/uint16</li><li>int32/uint32</li><li>int64/uint64</li></ul><p>Matlab支持复数运算，可以使用<code>1+2i</code>或者<code>1+2j</code>的形式表示。当运算结果为无穷时，表示为<code>Inf</code>，例如<code>2/0</code>;当运算结果不存在时，表示为<code>NaN</code>，例如 <code>Inf-Inf</code>。常见的运算有</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">floor</span>(<span class="built_in">pi</span>)<span class="comment">% 向上取整</span></span><br><span class="line"><span class="built_in">ceil</span>(<span class="built_in">pi</span>)<span class="comment">% 向下取整</span></span><br><span class="line"><span class="built_in">round</span>(<span class="built_in">pi</span>)<span class="comment">% 向最近整数取整，同int8(pi)</span></span><br></pre></td></tr></table></figure><h3 id="向量-矩阵"><a href="#向量-矩阵" class="headerlink" title="向量/矩阵"></a>向量/矩阵</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">size</span>(A)<span class="comment">% 获取矩阵形状</span></span><br><span class="line"><span class="built_in">numel</span>(A)<span class="comment">% 获取元素数目</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eye</span>(<span class="number">5</span>)<span class="comment">% 创建单位矩阵</span></span><br><span class="line"><span class="built_in">diag</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])<span class="comment">% 创建对角矩阵</span></span><br><span class="line"><span class="built_in">zeros</span>(<span class="number">2</span>, <span class="number">3</span>)<span class="comment">% 创建零矩阵</span></span><br><span class="line"><span class="built_in">rand</span>(<span class="number">2</span>, <span class="number">3</span>)<span class="comment">% 创建(0,1)均匀分布随机数矩阵</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">linspace</span>(x1, x2, n)<span class="comment">% 创建包括x1、x2之间n各等间距点的行向量</span></span><br><span class="line"><span class="built_in">logspace</span>(x1, x2, n)<span class="comment">% 创建包括10^a、10^b之间n各等间距点的行向量</span></span><br><span class="line"></span><br><span class="line">A(<span class="number">2</span>)<span class="comment">% 根据线性索引访问元素，线性索引按列排列</span></span><br><span class="line">A(<span class="number">2</span>, <span class="number">3</span>)<span class="comment">% 访问矩阵的一个元素</span></span><br><span class="line">A(<span class="number">2</span>, [<span class="number">1</span>, <span class="number">3</span>])<span class="comment">% 访问矩阵的多个元素</span></span><br><span class="line">A(<span class="number">1</span>:<span class="number">3</span>, <span class="number">2</span>:<span class="number">4</span>)<span class="comment">% 访问一个子矩阵</span></span><br><span class="line">A(<span class="number">1</span>:<span class="number">3</span>, <span class="number">2</span>:<span class="keyword">end</span>)<span class="comment">% 访问一个子矩阵，end指代末尾</span></span><br><span class="line">A(:, <span class="number">3</span>)<span class="comment">% 访问一个子矩阵，:指代左右行或者所有列</span></span><br><span class="line">A(:, <span class="number">3</span>) = []<span class="comment">% 删除矩阵的一列</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 创建多维数组，前两个维度为一个矩阵，后面的维度成为页，等同于zeros(3, 3, 2)</span></span><br><span class="line">A(<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>) = <span class="number">0</span></span><br><span class="line"><span class="comment">% 访问多维数组的一页，获得一个矩阵</span></span><br><span class="line">A(:, :, <span class="number">1</span>)</span><br><span class="line"><span class="comment">% 访问多维数组所有页的某一列，获得多个页的一列</span></span><br><span class="line">A(:, <span class="number">1</span>, :)</span><br><span class="line"><span class="comment">% 为了获得完整的矩阵，可以采用permute函数</span></span><br><span class="line"><span class="comment">% 将原来的第1、2、3维度移动为第1、3、2维度</span></span><br><span class="line">P = <span class="built_in">permute</span>(A, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line">P(:, :, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">reshape</span>(<span class="built_in">eye</span>(<span class="number">6</span>), <span class="number">18</span>, <span class="number">2</span>)<span class="comment">% 改变矩阵形状，按列进行修改，元素数目必须相同</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">find</span>(A)<span class="comment">% 获得非0元素的索引值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sort</span>(A)<span class="comment">% 对向量按升序排序，对矩阵按列排序</span></span><br><span class="line"><span class="built_in">sort</span>(A, dim)<span class="comment">% 对矩阵按指定维度排序</span></span><br><span class="line"><span class="built_in">sortrows</span>(A)<span class="comment">% 基于第一列中的元素按升序对矩阵行进行排序，影响整个行</span></span><br><span class="line"></span><br><span class="line">repelem([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="number">2</span>)<span class="comment">% 重复元素, 为[1,1,2,2,3,3]</span></span><br><span class="line">repelem([<span class="number">1</span>;<span class="number">2</span>;<span class="number">3</span>], <span class="number">2</span>)<span class="comment">% 重复元素, 为[1;1;2;2;3;3]</span></span><br><span class="line">repelem([<span class="number">1</span>,<span class="number">2</span>;<span class="number">3</span>,<span class="number">4</span>],<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment">% 重复元素，为</span></span><br><span class="line"><span class="comment">% [   1     1     2     2</span></span><br><span class="line"><span class="comment">%     1     1     2     2</span></span><br><span class="line"><span class="comment">%     1     1     2     2</span></span><br><span class="line"><span class="comment">%     3     3     4     4</span></span><br><span class="line"><span class="comment">%     3     3     4     4</span></span><br><span class="line"><span class="comment">%     3     3     4     4   ]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">repmat</span>(<span class="built_in">diag</span>([<span class="number">1</span>, <span class="number">2</span>]), <span class="number">2</span>)</span><br><span class="line"><span class="comment">% 重复矩阵，为</span></span><br><span class="line"><span class="comment">% [    1     0     1     0</span></span><br><span class="line"><span class="comment">%      0     2     0     2</span></span><br><span class="line"><span class="comment">%      1     0     1     0</span></span><br><span class="line"><span class="comment">%      0     2     0     2   ]</span></span><br><span class="line"><span class="built_in">repmat</span>(<span class="built_in">diag</span>([<span class="number">1</span>, <span class="number">2</span>]), <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment">% 重复矩阵，为</span></span><br><span class="line"><span class="comment">% [    1     0     1     0     1     0</span></span><br><span class="line"><span class="comment">%      0     2     0     2     0     2</span></span><br><span class="line"><span class="comment">%      1     0     1     0     1     0</span></span><br><span class="line"><span class="comment">%      0     2     0     2     0     2   ]</span></span><br></pre></td></tr></table></figure><h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>结构体数组是使用名为<strong>字段</strong>的数据容器将相关数据组合在一起的数据类型。每个字段都可以包含任意类型的数据。</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">patient.name = <span class="string">'John Doe'</span>;</span><br><span class="line">patient.billing = <span class="number">127.00</span>;</span><br><span class="line">patient.test = [<span class="number">79</span>, <span class="number">75</span>, <span class="number">73</span>; <span class="number">180</span>, <span class="number">178</span>, <span class="number">177.5</span>; <span class="number">220</span>, <span class="number">210</span>, <span class="number">205</span>];</span><br></pre></td></tr></table></figure><h3 id="元胞数组"><a href="#元胞数组" class="headerlink" title="元胞数组"></a>元胞数组</h3><p>元胞数组是一种包含名为元胞的索引数据容器的数据类型，其中的每个元胞都可以包含<strong>任意类型的数据</strong>。</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C = cell(<span class="number">2</span>,<span class="number">2</span>)<span class="comment">% 创建元胞数组</span></span><br><span class="line">C = &#123;<span class="number">1</span>, <span class="string">'hello'</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="字符和字符串"><a href="#字符和字符串" class="headerlink" title="字符和字符串"></a>字符和字符串</h3><p>Matlab的字符串可以用单引号或者双引号表示，常用函数有</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">'Hello World!'</span><span class="comment">% 创建一个字符串数组</span></span><br><span class="line">str(<span class="number">1</span>)<span class="comment">% 访问/修改一个字符</span></span><br><span class="line">[<span class="string">'hello'</span>, <span class="string">'world'</span>]<span class="comment">% 字符串的连接</span></span><br><span class="line">sprintf(<span class="string">'%0.5e'</span>, <span class="number">1</span>/<span class="built_in">eps</span>)<span class="comment">% 格式化输出, '4.50360e+15'</span></span><br><span class="line">sprintf(<span class="string">'%0.5f'</span>, <span class="number">1</span>/<span class="built_in">eps</span>)<span class="comment">% 格式化输出, '4503599627370496.00000'</span></span><br><span class="line">sprintf(<span class="string">'%0.5g'</span>, <span class="number">1</span>/<span class="built_in">eps</span>)<span class="comment">% 格式化输出, '4.5036e+15'</span></span><br><span class="line">sprintf(<span class="string">'%d'</span>, <span class="number">2</span>)<span class="comment">% 格式化输出, '2'</span></span><br><span class="line">sprintf(<span class="string">'%s'</span>, <span class="string">'hello'</span>)<span class="comment">% 格式化输出, 'hello'</span></span><br><span class="line">replace(<span class="string">'hello'</span>, <span class="string">'e'</span>, <span class="string">'a'</span>)<span class="comment">% 替换</span></span><br><span class="line">lower(<span class="string">'ABC'</span>)<span class="comment">% 转换为小写</span></span><br><span class="line">upper(<span class="string">'abc'</span>)<span class="comment">% 转换为大写</span></span><br><span class="line">strip(<span class="string">' hello '</span>)<span class="comment">% 删除前后空格</span></span><br></pre></td></tr></table></figure><p>正则表达式</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">'The regexp function helps you relax.'</span>;</span><br><span class="line">expression = <span class="string">'\w*x\w*'</span>;</span><br><span class="line">matchStr = regexp(str,expression,<span class="string">'match'</span>)</span><br><span class="line"><span class="comment">% Output:</span></span><br><span class="line"><span class="comment">% matchStr = 1x2 cell array</span></span><br><span class="line"><span class="comment">%     &#123;'regexp'&#125;    &#123;'relax'&#125;</span></span><br></pre></td></tr></table></figure><h3 id="函数句柄"><a href="#函数句柄" class="headerlink" title="函数句柄"></a>函数句柄</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 创建函数句柄</span></span><br><span class="line">f = @myfunction;<span class="comment">% 添加@符号创建句柄指向现有函数</span></span><br><span class="line">sqr = @(n) n.^<span class="number">2</span>;<span class="comment">% 通过匿名函数创建句柄</span></span><br></pre></td></tr></table></figure><h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><h3 id="CMD输入和输出"><a href="#CMD输入和输出" class="headerlink" title="CMD输入和输出"></a>CMD输入和输出</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">disp</span>(<span class="string">'Hello World!'</span>)<span class="comment">% 输出字符串</span></span><br><span class="line">num = input(<span class="string">'Input a number:'</span>)<span class="comment">% 获取输入表达式</span></span><br><span class="line">str = input(<span class="string">'Input a string:'</span>, <span class="string">'s'</span>)<span class="comment">% 获取输入字符串</span></span><br></pre></td></tr></table></figure><h3 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 导入数据，DELIM是分隔符，NHEADERLINES是头部行数</span></span><br><span class="line"><span class="comment">% 输出为一个结构，包括</span></span><br><span class="line"><span class="comment">% - 矩阵 data</span></span><br><span class="line">importdata(FILENAME, DELIM, NHEADERLINES)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 导入xls数据，SHEET是文件薄名称</span></span><br><span class="line"><span class="comment">% 数值放在NUM，文本放在TXT，其他放在RAW</span></span><br><span class="line">[NUM,TXT,RAW]=xlsread(FILE,SHEET)</span><br></pre></td></tr></table></figure><h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><p>Matlab的Figure的子对象包括</p><ul><li>Annotation</li><li>Axes</li><li>Illustration</li></ul><p>Matlab中的Axes对象同时包括x轴、y轴标注、标记、曲线等，其子对象有</p><ul><li>Line</li></ul><p>保存图片</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 保存图片</span></span><br><span class="line"><span class="comment">% 支持的格式有bmp, png, jpg; emf, pdf, eps, svg</span></span><br><span class="line">saveas(gcf,<span class="string">'example.png'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 以特定尺寸输出</span></span><br><span class="line">fig = gcf;</span><br><span class="line">fig.PaperUnits = <span class="string">'inches'</span>;</span><br><span class="line">fig.PaperPosition = [<span class="number">0</span> <span class="number">0</span> <span class="number">6</span> <span class="number">3</span>];</span><br><span class="line">saveas(gcf,<span class="string">'example.png'</span>)</span><br></pre></td></tr></table></figure><h3 id="线性图表"><a href="#线性图表" class="headerlink" title="线性图表"></a>线性图表</h3><p>基本绘制</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 绘制2D图表</span></span><br><span class="line"><span class="comment">% X是横坐标，Y是纵坐标</span></span><br><span class="line"><span class="comment">% h是返回的一组Line对象的向量</span></span><br><span class="line">h = <span class="built_in">plot</span>(X, Y)</span><br><span class="line"><span class="comment">% 在指定Axes上绘制</span></span><br><span class="line">h = <span class="built_in">plot</span>(ax, X, Y)</span><br><span class="line"><span class="comment">% x轴和y轴均为对数</span></span><br><span class="line">h = loglog(X, Y)</span><br><span class="line"><span class="comment">% x轴为对数</span></span><br><span class="line">h = semilogx(X, Y)</span><br><span class="line"><span class="comment">% y轴为对数</span></span><br><span class="line">h = semilogy(X, Y)</span><br></pre></td></tr></table></figure><p>双Y轴绘制</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 绘制双Y轴2D图表</span></span><br><span class="line">x = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">yyaxis left</span><br><span class="line"><span class="built_in">plot</span>(x,<span class="built_in">sin</span>(x))</span><br><span class="line"></span><br><span class="line">yyaxis right</span><br><span class="line"><span class="built_in">plot</span>(x, <span class="built_in">sin</span>(<span class="number">2</span>*x))</span><br></pre></td></tr></table></figure><p>标注及范围设置</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 设置坐标轴和标题名称</span></span><br><span class="line">title(<span class="string">''</span>)</span><br><span class="line">xlabel(<span class="string">''</span>)</span><br><span class="line">ylabel(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置范围</span></span><br><span class="line">axis([xmin, xmax, ymin, ymax])</span><br><span class="line">xlim([xmin, xmax])</span><br><span class="line">ylim([ymin, ymax])</span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置Tick位置</span></span><br><span class="line">xticks([<span class="number">-2</span>*<span class="built_in">pi</span> -<span class="built_in">pi</span> <span class="number">0</span> <span class="built_in">pi</span> <span class="number">2</span>*<span class="built_in">pi</span>])</span><br><span class="line"><span class="comment">% 设置Tick标注</span></span><br><span class="line">xticklabels(&#123;<span class="string">'-2\pi'</span>,<span class="string">'-\pi'</span>,<span class="string">'0'</span>,<span class="string">'\pi'</span>,<span class="string">'2\pi'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置图例</span></span><br><span class="line">lgd = <span class="built_in">legend</span>(label1, label2, <span class="string">'Location'</span>, <span class="string">'southeast'</span>)</span><br><span class="line"><span class="comment">% 设置部分图例，其中h1和h3是需要添加图例的Line Object</span></span><br><span class="line"><span class="built_in">legend</span>([h1 h3], &#123;<span class="string">'First'</span>,<span class="string">'Third'</span>&#125;)</span><br><span class="line"></span><br><span class="line">box on;</span><br><span class="line">grid on;</span><br></pre></td></tr></table></figure><p>属性设置</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 设置线条类型</span></span><br><span class="line"><span class="comment">% 可选属性有'none', '-', '--', ':', '-.'</span></span><br><span class="line">set(h, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>)</span><br><span class="line">h.LineStyle = <span class="string">'-'</span></span><br><span class="line"><span class="comment">% 设置线宽</span></span><br><span class="line">set(h, <span class="string">'LineWidth'</span>, <span class="number">0.5</span>)</span><br><span class="line"><span class="comment">% 设置线颜色</span></span><br><span class="line">set(h, <span class="string">'Color'</span>, [<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置Marker类型</span></span><br><span class="line"><span class="comment">% 可选属性有'none', '+', 'o', '*', '.', 'x', 'square', 'diamond', 'v', '^', '&lt;', '&gt;', 'pentagram', 'hexagram'</span></span><br><span class="line">set(h, <span class="string">'Marker'</span>, <span class="string">'x'</span>)</span><br><span class="line"><span class="comment">% 设置Marker大小</span></span><br><span class="line">set(h, <span class="string">'MarkerSize'</span>, <span class="number">6</span>)</span><br><span class="line"><span class="comment">% 设置Marker位置（每5个点）</span></span><br><span class="line">set(h, <span class="string">'MarkerIndices'</span>, <span class="number">1</span>:<span class="number">5</span>:<span class="built_in">length</span>(Y))</span><br><span class="line"><span class="comment">% Marker的颜色属性有'MarkerEdgeColor', 'MarkerFaceColor'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置字体</span></span><br><span class="line"><span class="comment">% 常见字体有</span></span><br><span class="line"><span class="comment">% - SimHei（黑体）</span></span><br><span class="line"><span class="comment">% - SimSun（宋体）</span></span><br><span class="line"><span class="comment">% - KaiTi（楷体）</span></span><br><span class="line"><span class="comment">% - FangSong（仿宋）</span></span><br><span class="line"><span class="comment">% - Times New Roman</span></span><br><span class="line"><span class="comment">% - Arial</span></span><br><span class="line"><span class="comment">% - Arial Narrow</span></span><br><span class="line"><span class="comment">% - Courier New</span></span><br><span class="line">set(h, <span class="string">'FontSize'</span>, <span class="string">'Arial'</span>)</span><br><span class="line"><span class="comment">% 设置字重，可选'normal', 'bold'</span></span><br><span class="line">set(h, <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>)</span><br><span class="line"><span class="comment">% 设置字号</span></span><br><span class="line">set(h, <span class="string">'FontSize'</span>, <span class="number">16</span>)</span><br></pre></td></tr></table></figure><p>综合示例</p><p><img src="programing-with-matlab/2d-plot.png" alt="2D plot"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">figure</span>(<span class="number">1</span>);          <span class="comment">% obtain a handle to the Figure</span></span><br><span class="line">a = subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);   <span class="comment">% obtain a handle to the Axes</span></span><br><span class="line"></span><br><span class="line">a.LineWidth = <span class="number">1.5</span>;</span><br><span class="line">a.FontName = <span class="string">'Arial'</span>;</span><br><span class="line">a.FontWeight = <span class="string">'bold'</span>;</span><br><span class="line">a.FontSize = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">colororder(&#123;<span class="string">'k'</span>, <span class="string">'k'</span>&#125;)  <span class="comment">% set the color of the left and the right axes</span></span><br><span class="line"></span><br><span class="line">yyaxis(a, <span class="string">'left'</span>);      <span class="comment">% switch to the left part of the Axes</span></span><br><span class="line">hl = <span class="built_in">plot</span>(x, <span class="built_in">sin</span>(x));   <span class="comment">% obtain a handle to the Line</span></span><br><span class="line">hl.LineWidth = <span class="number">1.5</span>;</span><br><span class="line">hl.Marker = <span class="string">"^"</span>;</span><br><span class="line">hl.MarkerIndices = <span class="number">1</span>:<span class="number">5</span>:<span class="built_in">length</span>(x);</span><br><span class="line">ylabel(a, <span class="string">'Sin[x]'</span>)</span><br><span class="line">ylim(a, [<span class="number">-1.5</span>, <span class="number">1.5</span>])</span><br><span class="line"></span><br><span class="line">yyaxis(a, <span class="string">'right'</span>)      <span class="comment">% switch to the right part of the Axes</span></span><br><span class="line">hr = <span class="built_in">plot</span>(x, <span class="built_in">sin</span>(<span class="number">2</span>*x));</span><br><span class="line">hr.LineStyle = <span class="string">'--'</span>;</span><br><span class="line">hr.LineWidth = <span class="number">1.5</span>;</span><br><span class="line">hr.Marker = <span class="string">'o'</span>;</span><br><span class="line">hr.MarkerIndices = <span class="number">1</span>:<span class="number">5</span>:<span class="built_in">length</span>(x);</span><br><span class="line">ylabel(a, <span class="string">'Sin[2x]'</span>)</span><br><span class="line">ylim(a, [<span class="number">-2</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">xlabel(a, <span class="string">'\theta'</span>)</span><br><span class="line">xlim(a, [<span class="number">0</span> <span class="number">3</span>*<span class="built_in">pi</span>])</span><br><span class="line">xticks(a, [<span class="number">0</span>, <span class="built_in">pi</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">3</span>*<span class="built_in">pi</span>])</span><br><span class="line">xticklabels(a, &#123;<span class="string">'0'</span>, <span class="string">'\pi'</span>, <span class="string">'2\pi'</span>, <span class="string">'3\pi'</span>&#125;)</span><br><span class="line"></span><br><span class="line">box on;</span><br><span class="line">grid on;</span><br><span class="line"></span><br><span class="line">lgd = <span class="built_in">legend</span>([hl, hr], &#123;<span class="string">'Sin[x]'</span>, <span class="string">'Sin[2x]'</span>&#125;, <span class="string">'Location'</span>, <span class="string">"southeast"</span>);</span><br><span class="line">tl = title(a, <span class="string">'Plot of Sin[x] and Sin[2x]'</span>);</span><br><span class="line">tl.FontName = <span class="string">'Arial'</span>;</span><br><span class="line">tl.FontWeight = <span class="string">'bold'</span>;</span><br><span class="line">tl.FontSize = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">f.PaperUnits = <span class="string">'inches'</span>;</span><br><span class="line">f.PaperPosition = [<span class="number">0</span> <span class="number">0</span> <span class="number">8</span> <span class="number">6</span>];</span><br><span class="line">saveas(f,<span class="string">'example.png'</span>)<span class="comment">% export the figure</span></span><br></pre></td></tr></table></figure><h3 id="极坐标绘图"><a href="#极坐标绘图" class="headerlink" title="极坐标绘图"></a>极坐标绘图</h3><p><img src="programing-with-matlab/polar-plot.png" alt="Polar plot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = linspace(0, 2*pi);</span><br><span class="line">En = abs(cos(pi/2*cos(x))./sin(x));</span><br><span class="line">h = polarplot(x, En);</span><br></pre></td></tr></table></figure><h3 id="等高线图"><a href="#等高线图" class="headerlink" title="等高线图"></a>等高线图</h3><p><img src="programing-with-matlab/contour-plot.png" alt="Contour plot"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="built_in">linspace</span>(<span class="number">-2</span>*<span class="built_in">pi</span>,<span class="number">2</span>*<span class="built_in">pi</span>);</span><br><span class="line">y = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">4</span>*<span class="built_in">pi</span>);</span><br><span class="line">[X,Y] = <span class="built_in">meshgrid</span>(x,y);</span><br><span class="line">Z = <span class="built_in">sin</span>(X)+<span class="built_in">cos</span>(Y);</span><br><span class="line">contour(X, Y, Z)<span class="comment">% X, Y为完整矩阵，或者</span></span><br><span class="line">contour(x, y, Z)<span class="comment">% x, y为向量，相同结果</span></span><br><span class="line">contour(X, Y, Z, [<span class="number">-1.2</span>, <span class="number">-0.6</span>, <span class="number">0</span>, <span class="number">0.6</span>, <span class="number">1.2</span>]) <span class="comment">% 指定幅度等高线</span></span><br><span class="line">contour(X, Y, Z, <span class="string">'ShowText'</span>, <span class="string">'on'</span>)<span class="comment">% 带有标注</span></span><br></pre></td></tr></table></figure><h3 id="史密斯圆等高线图"><a href="#史密斯圆等高线图" class="headerlink" title="史密斯圆等高线图"></a>史密斯圆等高线图</h3><p><img src="programing-with-matlab/smith-contour-plot.png" alt="Smith contour plot"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = importdata(fileName, &apos;,&apos;, 5);</span><br><span class="line">data = data.data;</span><br><span class="line">data = data(:, 2:end);</span><br><span class="line">[r, theta] = meshgrid(0:0.05:0.95, (0:10:350)/180*pi);</span><br><span class="line">h = smithchart();</span><br><span class="line">h.LabelVisible = &apos;off&apos;;</span><br><span class="line">h.SubColor = [0.2 0.2 0.2];</span><br><span class="line">delete(h)</span><br><span class="line">hold on</span><br><span class="line">contour(r.*cos(theta), r.*sin(theta), data, [4,6,8,10,11,12,13], &apos;ShowText&apos;,&apos;on&apos;, &apos;LineWidth&apos;, 1)</span><br></pre></td></tr></table></figure><h3 id="伪彩色图"><a href="#伪彩色图" class="headerlink" title="伪彩色图"></a>伪彩色图</h3><p><img src="programing-with-matlab/pseudo-color-plot.png" alt="Pseudo color plot"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="built_in">linspace</span>(<span class="number">-2</span>*<span class="built_in">pi</span>,<span class="number">2</span>*<span class="built_in">pi</span>);</span><br><span class="line">y = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">4</span>*<span class="built_in">pi</span>);</span><br><span class="line">[X,Y] = <span class="built_in">meshgrid</span>(x,y);</span><br><span class="line">Z = <span class="built_in">sin</span>(X)+<span class="built_in">cos</span>(Y);</span><br><span class="line">s = pcolor(x, y, Z);</span><br><span class="line">colorbar;<span class="comment">% 显示颜色图例</span></span><br><span class="line">caxis([<span class="number">-5</span>, <span class="number">5</span>])<span class="comment">% 颜色范围</span></span><br><span class="line">colormap(gca, spring);<span class="comment">% 更换颜色图</span></span><br><span class="line">s.LineStyle = <span class="string">'none'</span>;<span class="comment">% 无线条</span></span><br><span class="line">s.FaceColor = <span class="string">'interp'</span>;<span class="comment">% 对颜色插值</span></span><br></pre></td></tr></table></figure><h3 id="曲面图"><a href="#曲面图" class="headerlink" title="曲面图"></a>曲面图</h3><p><img src="programing-with-matlab/surf-plot.png" alt="Surf plot"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="built_in">linspace</span>(<span class="number">-2</span>*<span class="built_in">pi</span>,<span class="number">2</span>*<span class="built_in">pi</span>);</span><br><span class="line">y = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">4</span>*<span class="built_in">pi</span>);</span><br><span class="line">[X,Y] = <span class="built_in">meshgrid</span>(x,y);</span><br><span class="line">Z = <span class="built_in">sin</span>(X)+<span class="built_in">cos</span>(Y);</span><br><span class="line">s = surf(x, y, Z);</span><br><span class="line">view(gca, [<span class="number">-37.5</span>, <span class="number">60</span>]);<span class="comment">% 调整视角，默认视角为[-37.5, 30]；视角为[0, 90]时退化为伪色彩图</span></span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li><a href="https://www.mathworks.com/help/matlab/" target="_blank" rel="noopener">Official Matlab Reference Documentation</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Class J Power Amplifier</title>
      <link href="/archives/74ab8a26/class-j-power-amplifier.html"/>
      <url>/archives/74ab8a26/class-j-power-amplifier.html</url>
      
        <content type="html"><![CDATA[<p>This article includes a brief introduction to the class J PA.</p><a id="more"></a><h2 id="Harmonic-Short-Termination"><a href="#Harmonic-Short-Termination" class="headerlink" title="Harmonic Short Termination"></a>Harmonic Short Termination</h2><h3 id="Equal-Harmonic-Termination"><a href="#Equal-Harmonic-Termination" class="headerlink" title="Equal Harmonic Termination"></a>Equal Harmonic Termination</h3><p>In the analysis from class A to class C PA, it is assumed the load can provide a short at higher harmonics. If this assumption cannot hold, the efficiency of the power amplifier will reduce. The waveform in the following figure is a class B PA with harmonic short. Ideally, it can achieve a drain efficiency of $\pi/4$ , or approximately 78.5%.</p><p><img src="class-j-power-amplifier/class-b-pa-with-harmonic-short-load.svg" alt="Class B PA with harmonic short load"></p><p>In the figure, current is normalized to $I_{max}$, while voltage is normalized to $2V_{dd}$.</p><p>For a class B PA with the same impedance across all harmonics, it should assume a waveform as follows. When the load impedance is modified so as to make voltage average equal to $V_{dd}$, it has an efficiency of $\pi^2/(8-8\pi)$, or approximately 57.6%.</p><p><img src="class-j-power-amplifier/class-b-pa-with-constant-load.svg" alt="Class B PA with constant load"></p><p>Therefore, without harmonic short, the efficiency of traditional PA is greatly reduced.</p><p>The output capacitance of the device $C_{ds}$ reduces the load impedance at high frequency, and thus can be considered as a approximation to ideal harmonic termination. Following this method, the reactance of the capacitor should be as low as possible. The metric $X_{C_{ds}}/R_L$ at the fundamental is defined to assess the approximation. If $X_{C_{ds}}/R_L\ll1$, the classic result can be expected. However, even if $X_{C_{ds}}/R_L&gt;1$, with a substantial reactive component, the efficiency can be restored or even enhanced. This technique is called class J PA.</p><h3 id="Capacitive-Harmonic-Termination"><a href="#Capacitive-Harmonic-Termination" class="headerlink" title="Capacitive Harmonic Termination"></a>Capacitive Harmonic Termination</h3><p>Due to the influence of $C_{ds}$, the voltage waveform is</p><script type="math/tex; mode=display">v(\theta)=\cos\theta+v_2\sin 2\theta</script><p>Addition of the second harmonic would increase peak-to-peak range. If the peak voltage is kept the same, the fundamental component is reduced, thereby reducing the efficiency.</p><p>As shown in the figure below, a high $X_{C_{ds}}$ would lower the fundamental voltage, thereby reducing the efficiency achievable. On the other hand, however, a low $X_{C_{ds}}$ would increase the quality factor of the output node, and thus reducing the output bandwidth.</p><p><img src="class-j-power-amplifier/efficiency-degradation-due-to-small-cds.svg" alt="Efficiency degradation due to small Cds"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">result = &#123;&#125;;</span><br><span class="line"><span class="keyword">For</span>[Iq = <span class="number">0</span>, Iq &lt;= <span class="number">0.5</span>, Iq += <span class="number">0.1</span>, Imax = <span class="number">1</span>;</span><br><span class="line"> Ipk = Imax - Iq;</span><br><span class="line"> alpha = <span class="number">2</span> <span class="keyword">ArcCos</span>[-Iq/Ipk];</span><br><span class="line"> Id[t_] := </span><br><span class="line">  <span class="keyword">Piecewise</span>[&#123;&#123;Imax (<span class="keyword">Cos</span>[t] - <span class="keyword">Cos</span>[alpha/<span class="number">2</span>])/(<span class="number">1</span> - <span class="keyword">Cos</span>[alpha/<span class="number">2</span>]), -alpha/</span><br><span class="line">       <span class="number">2</span> &lt; t &lt; alpha/<span class="number">2</span>&#125;, &#123;<span class="number">0</span>, <span class="keyword">True</span>&#125;&#125;];</span><br><span class="line"> Idc = <span class="number">1</span>/<span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[Id[t] , &#123;t, -alpha/<span class="number">2</span>, alpha/<span class="number">2</span>&#125;];</span><br><span class="line"> I1 = <span class="number">1</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[Id[t] <span class="keyword">Cos</span>[t], &#123;t, -alpha/<span class="number">2</span>, alpha/<span class="number">2</span>&#125;];</span><br><span class="line"> I2 = <span class="number">1</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[Id[t] <span class="keyword">Cos</span>[<span class="number">2</span> t], &#123;t, -alpha/<span class="number">2</span>, alpha/<span class="number">2</span>&#125;];</span><br><span class="line"> eta = I1/<span class="number">2</span>/Idc;</span><br><span class="line"> x = <span class="keyword">Table</span>[k, &#123;k, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0.25</span>&#125;];</span><br><span class="line"> y = <span class="keyword">Table</span>[</span><br><span class="line">   eta/<span class="keyword">Maximize</span>[&#123;<span class="keyword">Cos</span>[t] + I2/I1 k/<span class="number">2</span> <span class="keyword">Sin</span>[<span class="number">2</span> t], <span class="number">0</span> &lt; t &lt; <span class="number">2</span> <span class="keyword">Pi</span>&#125;, t][[</span><br><span class="line">     <span class="number">1</span>]], &#123;k, x&#125;];</span><br><span class="line"> result = <span class="keyword">Append</span>[result, <span class="keyword">Table</span>[&#123;x[[k]], y[[k]]&#125;, &#123;k, <span class="keyword">Length</span>[x]&#125;]]]</span><br><span class="line"><span class="keyword">ListLinePlot</span>[result, <span class="keyword">PlotRange</span> -&gt; &#123;<span class="number">0.4</span>, <span class="number">0.8</span>&#125;, </span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"Vq=0"</span>, <span class="string">"Vq=0.1"</span>, <span class="string">"Vq=0.2"</span>, <span class="string">"Vq=0.3"</span>, <span class="string">"Vq=0.4"</span>, </span><br><span class="line">   <span class="string">"Vq=0.5"</span>&#125;, <span class="keyword">AxesLabel</span> -&gt; &#123;<span class="string">"Xcds/Rl"</span>, <span class="string">"Efficiency [%]"</span>&#125;]</span><br></pre></td></tr></table></figure><h2 id="Class-J-Power-Amplifier"><a href="#Class-J-Power-Amplifier" class="headerlink" title="Class J Power Amplifier"></a>Class J Power Amplifier</h2><p>The class J power amplifier differs from classic amplifiers in that:</p><ul><li>The load is not purely resistive at the fundamental frequency</li><li>The load presents high impedances at higher harmonics</li><li>The output capacitance is used to provide a specific reactive termination at the second harmonic, generating a non-sinusoidal waveform.</li></ul><p><img src="class-j-power-amplifier/schematic-of-class-j-pa.png" alt="Schematic of class J PA"></p><p>In the analysis, the transistor is assumed to be a current generator. In class B condition, it has a current of</p><script type="math/tex; mode=display">\begin{aligned}I_T&=I_{max}\sin\theta &&0<\theta<\pi\\&=0 &&\pi<\theta<2\pi\end{aligned}</script><p>The fundamental current flowing in the matching branch has the form</p><script type="math/tex; mode=display">I_F=I_1\sin(\theta+\phi)</script><p>And thus the current flowing through the capacitor is</p><script type="math/tex; mode=display">I_C=I_{DC}-I_T-I_F</script><p>Thus, the voltage can be obtained through integration</p><script type="math/tex; mode=display">\begin{aligned}V_o(\theta) =&\frac{1}{\omega C}\int_0^\theta \left( \frac{I_{max}}{\pi}-I_{max}\sin\varphi-I_1\sin(\varphi+\phi) \right)d\varphi+V_{off} &&0<\theta<2\pi\\=&\frac{1}{\omega C}\int_0^\pi \left( \frac{I_{max}}{\pi}-I_{max}\sin\varphi-I_1\sin(\varphi+\phi) \right)d\varphi\\&+\frac{1}{\omega C}\int_\pi^\theta \left( \frac{I_{max}}{\pi}-I_1\sin(\varphi+\phi) \right)d\varphi+V_{off} &&\pi<\theta<2\pi\end{aligned}</script><p>where $V_{off}$ is an arbitrary offset to make $V_o(\theta)\ge0$, and $1/\omega C$ is adjusted to make the average of $V_o(\theta)$ equal to $V_{dd}$.</p><p>For instance, for $I_1=0.6,\phi=10.2^\circ$, calculated results are</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Xcds (1/wC) = 7.69585</span><br><span class="line">Xcds/Rl = 3.84793</span><br><span class="line">Zl (with Cds) = 1.63538 +1.39322 I</span><br><span class="line">Zl (without Cds) = 1.13568 +1.384 I</span><br><span class="line">Zl/Rl (with Cds) = 0.817691 +0.696608 I</span><br><span class="line">Zl/Rl (without Cds) = 0.567841 +0.692 I</span><br><span class="line">efficiency = 0.642213</span><br><span class="line">Prf = -0.874108</span><br></pre></td></tr></table></figure><p><img src="class-j-power-amplifier/waveform-of-class-j-pa.svg" alt="Waveform of class J PA"></p><p>In the figure, current is normalized to $I_{max}$, while voltage is normalized to $V_{dd}$.</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(*define the current and the voltage waveform*)</span></span><br><span class="line">condition = &#123;Imax -&gt; <span class="number">1</span>, I1 -&gt; <span class="number">2</span>, Phi -&gt; (<span class="number">180</span> - <span class="number">68.01</span>)/<span class="number">180</span> <span class="keyword">Pi</span>, </span><br><span class="line">   Xcds -&gt; <span class="number">1</span>&#125;;</span><br><span class="line">Io[t_] := <span class="keyword">Piecewise</span>[&#123;&#123;Imax <span class="keyword">Sin</span>[t], <span class="number">0</span> &lt; t &lt; <span class="keyword">Pi</span>&#125;, &#123;<span class="number">0</span>, true&#125;&#125;];</span><br><span class="line">Vo[t_] := </span><br><span class="line">  <span class="keyword">Piecewise</span>[&#123;&#123;Xcds <span class="keyword">Integrate</span>[</span><br><span class="line">       Imax/<span class="keyword">Pi</span> - Imax <span class="keyword">Sin</span>[p] - I1 <span class="keyword">Sin</span>[p + Phi], &#123;p, <span class="number">0</span>, t&#125;], </span><br><span class="line">     t &lt;= <span class="keyword">Pi</span>&#125;, &#123;Xcds <span class="keyword">Integrate</span>[</span><br><span class="line">        Imax/<span class="keyword">Pi</span> - Imax <span class="keyword">Sin</span>[p] - I1 <span class="keyword">Sin</span>[p + Phi], &#123;p, <span class="number">0</span>, <span class="keyword">Pi</span>&#125;] + </span><br><span class="line">      Xcds <span class="keyword">Integrate</span>[Imax/<span class="keyword">Pi</span> - I1 <span class="keyword">Sin</span>[p + Phi], &#123;p, <span class="keyword">Pi</span>, t&#125;], t &gt; <span class="keyword">Pi</span>&#125;&#125;];</span><br><span class="line"><span class="comment">(*set the parameters*)</span></span><br><span class="line">a = Vo[t] /. condition;</span><br><span class="line">b = Io[t] /. condition;</span><br><span class="line"><span class="comment">(*add suitable Voff to make Vo&gt;0*)</span></span><br><span class="line">min = <span class="keyword">Minimize</span>[&#123;a, <span class="number">0</span> &lt; t &lt; <span class="number">2</span> <span class="keyword">Pi</span>&#125;, t];</span><br><span class="line">a = a - min[[<span class="number">1</span>]];</span><br><span class="line"><span class="comment">(*scale the expression to make the mean value equal to 1*)</span></span><br><span class="line">ave = <span class="keyword">Integrate</span>[a, &#123;t, <span class="number">0</span>, <span class="number">2</span> <span class="keyword">Pi</span>&#125;]/<span class="number">2</span>/<span class="keyword">Pi</span>;</span><br><span class="line">a = a/ave;</span><br><span class="line"><span class="comment">(*calculate Xcds/Rl,note that Rl equal to 2Vdd/Imax,or simply 2 after normalization*)</span></span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Xcds (1/wC) = "</span>, <span class="number">1</span>/ave]</span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Xcds/Rl = "</span>, <span class="number">1</span>/ave/<span class="number">2</span>]</span><br><span class="line"><span class="comment">(*perform the fourier tranformation to obtain the in-phase and quadrature component*)</span></span><br><span class="line"><span class="comment">(*note that the current is reversed to represent the one flow through the load*)</span></span><br><span class="line">SinCoe = <span class="number">1</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[a <span class="keyword">Sin</span>[t], &#123;t, <span class="number">0</span>, <span class="number">2</span> <span class="keyword">Pi</span>&#125;];</span><br><span class="line">CosCoe = <span class="number">1</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[a <span class="keyword">Cos</span>[t], &#123;t, <span class="number">0</span>, <span class="number">2</span> <span class="keyword">Pi</span>&#125;];</span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Zl (with Cds) = "</span>, (CosCoe - I SinCoe)/(<span class="number">1</span>/<span class="number">2</span> I)]</span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Zl (without Cds) = "</span>, (CosCoe - I SinCoe)/</span><br><span class="line">    I1/(<span class="keyword">Sin</span>[Phi] - I <span class="keyword">Cos</span>[Phi]) /. condition ]</span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Zl/Rl (with Cds) = "</span>, (CosCoe - I SinCoe)/(<span class="number">1</span>/<span class="number">2</span> I)/<span class="number">2</span>]</span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Zl/Rl (without Cds) = "</span>, (CosCoe - I SinCoe)/</span><br><span class="line">     I1/(<span class="keyword">Sin</span>[Phi] - I <span class="keyword">Cos</span>[Phi])/<span class="number">2</span> /. condition ]</span><br><span class="line"><span class="comment">(*calculate the efficiency and power*)</span></span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"efficiency = "</span>, <span class="keyword">Abs</span>[SinCoe] <span class="keyword">Pi</span>/<span class="number">4</span>]</span><br><span class="line"><span class="keyword">Print</span>[<span class="string">"Prf = "</span>, <span class="number">10</span> <span class="keyword">Log10</span>[<span class="keyword">Abs</span>[SinCoe]]]</span><br><span class="line"><span class="comment">(*plot the waveforms*)</span></span><br><span class="line"><span class="keyword">Plot</span>[&#123;a, b&#125;, &#123;t, <span class="number">0</span>, <span class="number">2</span> <span class="keyword">Pi</span>&#125;, <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"Vo"</span>, <span class="string">"Io"</span>&#125;]</span><br></pre></td></tr></table></figure><p>Similarly, the analysis can be performed for several other occasions.</p><div class="table-container"><table><thead><tr><th>No.</th><th>I1</th><th>Phi</th><th>Xcds/Rl</th><th>Prf</th><th>Eff</th><th>R1</th><th>X1</th></tr></thead><tbody><tr><td>1</td><td>2.0</td><td>112</td><td>0.27</td><td>0</td><td>78.5</td><td>1.0</td><td>0.13</td></tr><tr><td>2</td><td>0.7</td><td>164.4</td><td>2.65</td><td>0</td><td>78.5</td><td>1.0</td><td>0.92</td></tr><tr><td>3</td><td>0.6</td><td>10.2</td><td>3.82</td><td>-0.9</td><td>63.9</td><td>0.82</td><td>0.69</td></tr></tbody></table></div><p> <img src="class-j-power-amplifier/waveforms-of-three-different-class-j-pas.svg" alt="Waveforms of three different class J PAs"></p><p>The key class J design maneuver is to shift the phasing of the voltage and current waveforms, without changing their shape, such that the second harmonic voltage and current components are in phase quadrature.</p>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
            <tag> Power Amplifier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Modeling of Transistors in Small-Signal Condition</title>
      <link href="/archives/d4a45699/modeling-of-transistors.html"/>
      <url>/archives/d4a45699/modeling-of-transistors.html</url>
      
        <content type="html"><![CDATA[<p>This article is about the modeling of MOSFET in small-signal condition.</p><a id="more"></a><h2 id="Direct-Extraction-Conditions"><a href="#Direct-Extraction-Conditions" class="headerlink" title="Direct Extraction Conditions"></a>Direct Extraction Conditions</h2><div class="table-container"><table><thead><tr><th>Bias State</th><th>Condition</th></tr></thead><tbody><tr><td>Zero bias</td><td>$V_{gs}=0,V_{ds}=0$</td></tr><tr><td>Strong inversion</td><td>$V_{gs}&gt;V_{th},V_{ds}=0$</td></tr><tr><td>Active</td><td>$V_{ds}&gt;V_{gs}-V_{th}&gt;0$</td></tr></tbody></table></div><h2 id="Small-Signal-Parameter-Extraction"><a href="#Small-Signal-Parameter-Extraction" class="headerlink" title="Small-Signal Parameter Extraction"></a>Small-Signal Parameter Extraction</h2><h3 id="Model-Description"><a href="#Model-Description" class="headerlink" title="Model Description"></a>Model Description</h3><p>Schematic of the small-signal MOSFET model. It is comprised of an intrinsic transistor and extrinsic parasitic resistors and inductors (not drawn). In the model, the non-quasi-static (NQS) effect is represented by a delay $\tau_g$ in the voltage-controlled current source (VCCS).</p><p><img src="modeling-of-transistors/schematic-of-the-small-signal-mosfet-model.png" alt="Schematic of the small signal MOSFET model"></p><p>The Y parameter of the intrinsic transistor $Y&#39;$ is</p><script type="math/tex; mode=display">\begin{aligned}Y'_{11}&=\frac{\omega^2R_{gd}C_{gd}^2+j\omega C_{gd}}{1+\omega^2R_{gd}^2C_{gd}^2}+\frac{\omega^2R_{gs}C_{gs}^2+j\omega C_{gs}}{1+\omega^2R_{gs}^2C_{gs}^2}\\Y'_{12}&=-\frac{\omega^2R_{gd}C_{gd}^2+j\omega C_{gd}}{1+\omega^2R_{gd}^2C_{gd}^2}\\Y'_{21}&=-\frac{\omega^2R_{gd}C_{gd}^2+j\omega C_{gd}}{1+\omega^2R_{gd}^2C_{gd}^2}+\frac{g_me^{-j\omega\tau_g}(1-j\omega C_{gs})}{1+\omega^2R_{gs}^2C_{gs}^2}\\Y'_{22}&=\frac{\omega^2R_{gd}C_{gd}^2+j\omega C_{gd}}{1+\omega^2R_{gd}^2C_{gd}^2}+\frac{\omega^2R_{db}C_{db}^2+j\omega C_{db}}{1+\omega^2R_{db}^2C_{db}^2}+\frac{1}{R_{ds}}+j\omega C_{ds}\end{aligned}</script><p>Several observations can be made from the Y parameter. First, the denominator of these equations approaches unit when the frequency approaches zero. For instance, at sufficiently low frequency, we have</p><script type="math/tex; mode=display">Y'_{22}+Y'_{12}=\frac{1}{R_{ds}}+\omega^2R_{db}C_{db}^2+j\omega(C_{ds}+C_{db})</script><p>Second, at sufficiently high frequency, the Y parameter can be simplified as</p><script type="math/tex; mode=display">Y'_{22}+Y'_{12}=\frac{1}{R_{ds}}+\frac{1}{R_{db}}+j\omega C_{ds}</script><p>Adopting these two conditions, we may calculate $R_{ds}, R_{db}, C_{ds}, C_{db}$.</p><p>The Z parameter of the whole transistor $Z$ is</p><script type="math/tex; mode=display">\begin{aligned}Z_{11}&=Z'_{11}+R_g+R_s+j\omega(L_s+L_g)\\Z_{12}&=Z'_{12}+R_s+j\omega L_s\\Z_{21}&=Z'_{21}+R_s+j\omega L_s\\Z_{22}&=Z'_{22}+R_d+R_s+j\omega(L_s+L_d)\end{aligned}</script><p>where $Z&#39;$ is the Z parameter of the intrinsic transistor, and can be converted from the aforementioned Y parameter.</p><p>To extract the outside parasitic parameters, coldFET method is used. In the setting, the transistor is biased in <strong>strong inversion region</strong> (high Vgs and zero Vds). Hence, the drain and the source of the intrinsic transistor is assumed to be connected together. The Z parameter for this setting is</p><script type="math/tex; mode=display">\begin{aligned}Z_{11}=&R_s+R_g+j\omega(L_s+L_g)+\\&\frac{(1+j\omega C_{gd}R_{gd})(1+j\omega C_{gs}R_{gs})}{j\omega(C_{gd}+C_{gs})-j\omega C_{gd}C_{gs}(R_{gd}+R_{gs})}\\Z_{12}=&Z_{21}=R_s+j\omega L_s\\Z_{22}=&R_s+R_d+j\omega(L_s+L_d)\end{aligned}</script><p>We may further split the real and imaginary part of the $Z_{11}$, as</p><script type="math/tex; mode=display">\begin{aligned}\mathrm{real}(Z_{11})&=R_s+R_g+\frac{A_1+B_1\omega^2}{C+D\omega^2}\\\mathrm{imag}(Z_{11})&=\omega(L_s+L_g)+\frac{1}{\omega}\frac{A_2+B_2\omega^2}{C+D\omega^2}\\A_1&=C_{gs}^2R_{gs}+C_{gd}^2R_{gd}\\B_1&=C_{gs}^2C_{gd}^2R_{gs}R_{gd}(R_{gs}+R_{gd})\\A_2&=C_{gs}+C_{gd}\\B_2&=C_{gs}C_{gd}(C_{gs}R_{gs}^2+C_{gd}R_{gd}^2)\\C&=(C_{gs}+C_{gd})^2\\D&=C_{gs}^2C_{gd}^2(R_{gs}+R_{gd})^2\end{aligned}</script><p>After manipulation, $L_g, R_g$ can be obtained from</p><script type="math/tex; mode=display">\begin{aligned}\frac{\partial\ \mathrm{real}(Z_{11})\omega^2}{\partial\ \omega^2}&=R_s+R_g+\frac{A_1C+\omega^2B_1(2C+\omega^2D)}{(C+D\omega^2)^2}\\\frac{\partial\ \mathrm{imag}(Z_{11})\omega}{\partial\ \omega^2}&=L_s+L_g+\frac{B_2 C- A_2D}{(C+D\omega^2)^2}\end{aligned}</script><h3 id="Extraction"><a href="#Extraction" class="headerlink" title="Extraction"></a>Extraction</h3><p>In the first step, we have to extract the extrinsic parameters. Equations are detailed as follows. Unless otherwise stated, the extraction can be performed at any frequency. The transistor must be biased in <strong>strongly inversed region</strong> (i.e., high Vgs and zero Vds).</p><script type="math/tex; mode=display">\begin{aligned}R_s&=\mathrm{real}(Z_{12})\\L_s&=\frac{\mathrm{imag}(Z_{12})}{\omega}\\R_d&=\mathrm{real}(Z_{22}-Z_{12})\\L_d&=\frac{\mathrm{imag}(Z_{22}-Z_{12})}{\omega}\\R_g&\approx \frac{\partial\ \mathrm{real}(Z_{11})\omega^2}{\partial\ \omega^2}\bigg|_{\omega\to\infty}-R_s\\&\approx\frac{\mathrm{imag}(Z_{11}-Z_{12})}{\omega}\\L_g&=\frac{\partial\ \mathrm{imag}(Z_{11})\omega}{\partial\ \omega^2}\bigg|_{\omega\to\infty}-L_s\end{aligned}</script><p>The second step is to de-embed the extrinsic parameters. For measured data, the extrinsic parameters can be subtracted from the Z parameter; for simulation, we can simply add negative resistors and inductors at proper positions to cancel the original extrinsic parasitics.</p><p>The third step is to assess the intrinsic parameters. For this measurement, the transistor has to be biased at <strong>nominal</strong> gate and drain voltage. Y parameter is measured at both very low and high frequencies. Equations are as follows.</p><p>At a sufficient low frequency</p><script type="math/tex; mode=display">\begin{aligned}C_{gs}&=\frac{\mathrm{imag}(Y'_{11}+Y'_{12})}{\omega}\bigg|_{\omega\to0}\\R_{gs}&=\frac{\mathrm{real}(Y'_{11}+Y'_{12})}{\omega^2C_{gs}^2}\bigg|_{\omega\to0}\\C_{gd}&=\frac{\mathrm{imag}(-Y'_{12})}{\omega}\bigg|_{\omega\to0}\\R_{gd}&=\frac{\mathrm{real}(-Y'_{12})}{\omega^2C_{gd}^2}\bigg|_{\omega\to0}\\g_m&=\left|\frac{Y'_{21}-Y'_{12}}{Y'_{11}+Y'_{12}}\right|\mathrm{imag}(Y'_{11}+Y'_{12})\bigg|_{\omega\to0}\\&\approx\mathrm{real}(Y'_{21})\bigg|_{\omega\to0}\\\tau_g&=\mathrm{phase}\left|\frac{Y'_{21}-Y'_{12}}{Y'_{11}+Y'_{12}}\right|\frac{\mathrm{imag}(Y'_{11}+Y'_{12})}{\omega}\bigg|_{\omega\to0}\end{aligned}</script><p>Besides</p><script type="math/tex; mode=display">\begin{aligned}C_{ds}&=\frac{\mathrm{imag}(Y'_{22}+Y'_{12})}{\omega}|_{\omega\to\infty}\\C_{db}&=\frac{\mathrm{imag}(Y'_{22}+Y'_{12})}{\omega}-C_{ds}\bigg|_{\omega\to0}\\R_{ds}&=\frac{1}{\mathrm{real}(Y'_{22}+Y'_{12})}\bigg|_{\omega\to0}\\R_{db}&=\frac{1}{\mathrm{real}(Y'_{22}+Y'_{12})-1/R_{ds}}\bigg|_{\omega\to\infty}\\\end{aligned}</script><h2 id="Extraction-Example"><a href="#Extraction-Example" class="headerlink" title="Extraction Example"></a>Extraction Example</h2><h3 id="Extrinsic-Parameter-Extraction"><a href="#Extrinsic-Parameter-Extraction" class="headerlink" title="Extrinsic Parameter Extraction"></a>Extrinsic Parameter Extraction</h3><p><img src="modeling-of-transistors/schematic-for-extrinsic-parameter-extraction.png" alt="Schematic for extrinsic parameter extraction"></p><p><img src="modeling-of-transistors/simulated-result-for-extrinsic-parameter-extraction.png" alt="Simulated result for extrinsic parameter extraction"></p><p>Thus, estimated parameters are $R_s=0.39,R_d=0.36,R_g=0.51$, inductances are ignored.</p><h3 id="De-Embedding"><a href="#De-Embedding" class="headerlink" title="De-Embedding"></a>De-Embedding</h3><p>The de-embedding can be implemented simply by adding negative &quot;resistors&quot; and &quot;inductors&quot; to each terminal of the transistor.</p><h3 id="Intrinsic-Parameter-Extraction"><a href="#Intrinsic-Parameter-Extraction" class="headerlink" title="Intrinsic Parameter Extraction"></a>Intrinsic Parameter Extraction</h3><p><img src="modeling-of-transistors/schematic-for-intrinsic-parameter-extraction.png" alt="Schematic for intrinsic parameter extraction"></p><p><img src="modeling-of-transistors/simulated-result-for-intrinsic-parameter-extraction.png" alt="Simulated result for intrinsic parameter extraction"></p><h3 id="Verification"><a href="#Verification" class="headerlink" title="Verification"></a>Verification</h3><p>In the verification, the NQS effect is ignored.</p><p><img src="modeling-of-transistors/extracted-parameters.png" alt="Extracted parameters"></p><p><img src="modeling-of-transistors/comparison-of-the-results.png" alt="Comparison of the results"></p><h3 id="Strange-Things"><a href="#Strange-Things" class="headerlink" title="Strange Things"></a>Strange Things</h3><ol><li>Negative inductance at the each gate and drain</li><li>Rgd is negative</li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>丛诗力. <em>毫米波CMOS晶体管建模技术研究</em>.</li><li>李志群, 王志功. <em>射频集成电路与系统</em>.</li><li>Yang Tang, Li Zhang, Yan Wang, &quot;Accurate small signal modeling and extraction of silicon MOSFET for RF IC application,&quot; <em>Solid-State Electronics</em>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Class F Power Amplifier</title>
      <link href="/archives/e1b3e277/class-f-power-amplifier.html"/>
      <url>/archives/e1b3e277/class-f-power-amplifier.html</url>
      
        <content type="html"><![CDATA[<p>This article is about the design of class F power amplifier.</p><a id="more"></a><h2 id="Assumption"><a href="#Assumption" class="headerlink" title="Assumption"></a>Assumption</h2><p>Strong non-linearity assumption</p><p><img src="class-f-power-amplifier/strong-non-linearity-transfer-function.png" alt="Strong non-linearity transfer function"></p><h2 id="Overdriven-Class-A-Amplifier"><a href="#Overdriven-Class-A-Amplifier" class="headerlink" title="Overdriven Class A Amplifier"></a>Overdriven Class A Amplifier</h2><p><img src="class-f-power-amplifier/waveform-of-overdriven-class-a-amplifier.png" alt="Waveform of overdriven class A amplifier"></p><p>The clipping angle is defined as</p><script type="math/tex; mode=display">I_{dc}+I_{lin}\cos\alpha=I_{max}\\\cos\alpha=\frac{I_{max}}{2I_{lin}}</script><p>Thus, we may define the clipped cosine wave as</p><script type="math/tex; mode=display">\begin{aligned}i(\theta) &= I_{max} &&0<\theta<\alpha,2\pi-\alpha<\theta<2\pi\\&= \frac{1}{2}I_{max}+I_{lin}\cos\theta &&\alpha<\theta<\pi-\alpha,\pi+\alpha<\theta<2\pi-\alpha\\&=0 && \pi-\alpha<\theta<\pi+\alpha\end{aligned}</script><p>Using Fourier series, we can obtain</p><script type="math/tex; mode=display">I_1=I_{max} \cdot \frac{2}{\pi} \cdot \frac{\sin2\alpha+\pi-2\alpha}{4\cos\alpha}</script><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r = <span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[Imax <span class="keyword">Cos</span>[x], &#123;x, <span class="number">0</span>, a&#125;] + </span><br><span class="line"> <span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[(<span class="number">0.5</span> Imax + Ilin <span class="keyword">Cos</span>[x]) <span class="keyword">Cos</span>[x], &#123;x, a, <span class="keyword">Pi</span> - a&#125;]</span><br><span class="line">I1 = <span class="keyword">Simplify</span>[r /. Ilin -&gt; Imax/<span class="number">2</span>/<span class="keyword">Cos</span>[a]]</span><br><span class="line"><span class="comment">(* (Imax Sec[a] (-2 a + \[Pi] + Sin[2 a]))/(2 \[Pi]) *)</span></span><br></pre></td></tr></table></figure><p>The fundamental power and the maximal linear power are defined as</p><script type="math/tex; mode=display">P_{rf}=\frac{I_1^2}{2R_L}\\P_{lin}=\frac{I_{max}^2}{8R_L}</script><p>The power compression curve can be plotted as ($I_{max}$ and $R_L$ are normalized)</p><p><img src="class-f-power-amplifier/output-power-of-overdriven-class-a-amplifier.svg" alt="Output power of overdriven class A amplifier"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">r = <span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[Imax <span class="keyword">Cos</span>[x], &#123;x, <span class="number">0</span>, a&#125;] + </span><br><span class="line">  <span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[(<span class="number">0.5</span> Imax + Ilin <span class="keyword">Cos</span>[x]) <span class="keyword">Cos</span>[x], &#123;x, a, <span class="keyword">Pi</span> - a&#125;]</span><br><span class="line">I1 = <span class="keyword">Simplify</span>[r /. a -&gt; <span class="keyword">ArcCos</span>[Imax/<span class="number">2</span>/Ilin]]</span><br><span class="line"><span class="keyword">LogLogPlot</span>[</span><br><span class="line"> <span class="keyword">Piecewise</span>[&#123;&#123;I1, Ilin &gt; Imax/<span class="number">2</span>&#125;, &#123;Ilin, Ilin &lt; Imax/<span class="number">2</span>&#125;&#125;] /. </span><br><span class="line">  Imax -&gt; <span class="number">1</span>, &#123;Ilin, <span class="number">0.2</span>, <span class="number">2</span>&#125;, </span><br><span class="line"> <span class="keyword">AxesLabel</span> -&gt; &#123;<span class="string">"Input Power"</span>, <span class="string">"Output Power"</span>&#125;, <span class="keyword">PlotRange</span> -&gt; <span class="keyword">All</span>]</span><br></pre></td></tr></table></figure><p>and the efficiency</p><p><img src="class-f-power-amplifier/efficiency-of-overdriven-class-a-amplifier.svg" alt="Efficiency of overdriven class A amplifier"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LogLinearPlot</span>[</span><br><span class="line"> <span class="keyword">Piecewise</span>[&#123;&#123;(I1^<span class="number">2</span>/<span class="number">2</span>)/(Imax^<span class="number">2</span>/<span class="number">4</span>), </span><br><span class="line">     Ilin &gt; Imax/<span class="number">2</span>&#125;, &#123;(Ilin^<span class="number">2</span>/<span class="number">2</span>)/(Imax^<span class="number">2</span>/<span class="number">4</span>), Ilin &lt; Imax/<span class="number">2</span>&#125;&#125;] /. </span><br><span class="line">  Imax -&gt; <span class="number">1</span>, &#123;Ilin, <span class="number">0.2</span>, <span class="number">2</span>&#125;, </span><br><span class="line"> <span class="keyword">AxesLabel</span> -&gt; &#123;<span class="string">"Input Power"</span>, <span class="string">"Efficiency"</span>&#125;, <span class="keyword">PlotRange</span> -&gt; <span class="keyword">All</span>]</span><br></pre></td></tr></table></figure><p>It can be observed at 1-dB compression point, more power is extracted with no extra DC consumption, achieving an efficiency of 63 %. The maximal efficiency is $8/\pi^2$, where a infinite $I_{lin}$ is required. Hence, we can trade linearity for efficiency. </p><h2 id="Overdriven-Class-AB-Amplifier"><a href="#Overdriven-Class-AB-Amplifier" class="headerlink" title="Overdriven Class AB Amplifier"></a>Overdriven Class AB Amplifier</h2><p><img src="class-f-power-amplifier/waveform-of-overdriven-class-ab-amplifier.png" alt="Waveform of overdriven class AB amplifier"></p><p>In the analysis, the transconductance is assumed to be 1. The nominal conduction angle is</p><script type="math/tex; mode=display">\cos\beta=\frac{v_q}{v_q-1}\\</script><p>The maximal linear amplitude is</p><script type="math/tex; mode=display">v_{lin}=1-v_q</script><p>The overdriven conduction angle is</p><script type="math/tex; mode=display">\cos\gamma=-\frac{v_q}{v_s}</script><p>The clipping angle is given by</p><script type="math/tex; mode=display">\cos\alpha=\frac{1-v_q}{v_s}</script><p>The device output current is</p><script type="math/tex; mode=display">\begin{aligned}i(\theta) &= 1 &&0<\theta<\alpha,2\pi-\alpha<\theta<2\pi\\&= v_q+v_s\cos\theta &&\alpha<\theta<\gamma,2\pi-\gamma<\theta<2\pi-\alpha\\&=0 && \gamma<\theta<2\pi-\gamma\end{aligned}</script><p>Adopting Fourier series, we have</p><script type="math/tex; mode=display">I_{dc}=\frac{1}{\pi}\int_{0}^{\pi}i(\theta)\ d\theta\\I_{1}=\frac{2}{\pi}\int_{0}^{\pi}i(\theta)\cos\theta\ d\theta</script><p><strong>Different</strong> from the above analysis, the voltage waveform is assumed to be cosine wave with peak amplitude $V_{dc}$.</p><script type="math/tex; mode=display">P_{rf}=\frac{V_{dc}I_1}{2}\\P_{dc}=V_{dc}I_{dc}\\\eta=\frac{I_1}{2I_{dc}}</script><p>Efficiency</p><p><img src="class-f-power-amplifier/efficiency-of-overdriven-class-ab-amplifier.svg" alt="Efficiency of overdriven class AB amplifier"></p><p>Power</p><p><img src="class-f-power-amplifier/output-power-of-overdriven-class-ab-amplifier.svg" alt="Output power of overdriven class AB amplifier"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vq = <span class="keyword">Cos</span>[b]/(<span class="keyword">Cos</span>[b] - <span class="number">1</span>);</span><br><span class="line">g = <span class="keyword">ArcCos</span>[-vq/vs];</span><br><span class="line">a = <span class="keyword">ArcCos</span>[(<span class="number">1</span> - vq)/vs];</span><br><span class="line">Idc = <span class="number">1</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[<span class="number">1</span>, &#123;x, <span class="number">0</span>, a&#125;] + </span><br><span class="line">   <span class="number">1</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[vq + vs <span class="keyword">Cos</span>[x], &#123;x, a, g&#125;];</span><br><span class="line">I1 = <span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[<span class="keyword">Cos</span>[x], &#123;x, <span class="number">0</span>, a&#125;] + </span><br><span class="line">   <span class="number">2</span>/<span class="keyword">Pi</span> <span class="keyword">Integrate</span>[(vq + vs <span class="keyword">Cos</span>[x]) <span class="keyword">Cos</span>[x], &#123;x, a, g&#125;];</span><br><span class="line">eta = I1/<span class="number">2</span>/Idc;</span><br><span class="line"></span><br><span class="line"><span class="comment">(* plot efficiency *)</span></span><br><span class="line"><span class="keyword">Plot</span>[&#123;eta /. vs -&gt; (<span class="number">1</span> - vq), eta /. vs -&gt; (<span class="number">1</span> - vq) <span class="number">10</span>^<span class="number">0.1</span>, </span><br><span class="line">  eta /. vs -&gt; (<span class="number">1</span> - vq) <span class="number">10</span>^<span class="number">0.2</span>, eta /. vs -&gt; (<span class="number">1</span> - vq) <span class="number">10</span>^<span class="number">0.3</span>&#125;, &#123;b, </span><br><span class="line">  <span class="number">0.01</span>, <span class="keyword">Pi</span>&#125;, <span class="keyword">AxesLabel</span> -&gt; &#123;<span class="string">"Conduction Angle"</span>, <span class="string">"Efficiency"</span>&#125;, </span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"0 dB"</span>, <span class="string">"2 dB"</span>, <span class="string">"4 dB"</span>, <span class="string">"6 dB"</span>&#125;]</span><br><span class="line"> </span><br><span class="line"><span class="comment">(* plot power *)</span></span><br><span class="line">I1dB = <span class="number">20</span> <span class="keyword">Log10</span>[I1*<span class="number">2</span>];</span><br><span class="line"><span class="keyword">Plot</span>[&#123;I1dB /. vs -&gt; (<span class="number">1</span> - vq), I1dB /. vs -&gt; (<span class="number">1</span> - vq) <span class="number">10</span>^<span class="number">0.1</span>, </span><br><span class="line">  I1dB /. vs -&gt; (<span class="number">1</span> - vq) <span class="number">10</span>^<span class="number">0.2</span>, I1dB /. vs -&gt; (<span class="number">1</span> - vq) <span class="number">10</span>^<span class="number">0.3</span>&#125;, &#123;b, </span><br><span class="line">  <span class="number">0.01</span>, <span class="keyword">Pi</span>&#125;, <span class="keyword">AxesLabel</span> -&gt; &#123;<span class="string">"Conduction Angle"</span>, <span class="string">"Power"</span>&#125;, </span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"0 dB"</span>, <span class="string">"2 dB"</span>, <span class="string">"4 dB"</span>, <span class="string">"6 dB"</span>&#125;]</span><br></pre></td></tr></table></figure><p>For class AB and class A amplifier, input overdrive can increase the efficiency and the output power simultaneously; for class B amplifier the power improvement is offset by a reduction in efficiency; for class C amplifier, the increase in power is dramatic while the efficiency decreases slightly.</p><h2 id="Class-F-Amplifier"><a href="#Class-F-Amplifier" class="headerlink" title="Class F Amplifier"></a>Class F Amplifier</h2><p>Addition of third order in-phase harmonic can lower the peak amplitude.</p><p><img src="class-f-power-amplifier/addition-of-third-order-harmonic.svg" alt="Addition of third order harmonic"></p><p>Assume a waveform of</p><script type="math/tex; mode=display">v(\theta)=\cos\theta-k\cos3\theta</script><p>For</p><ol><li>$k&lt;1/9$, there will be a single peak</li><li>$k=1/6$, the peak amplitude reaches global minimum</li><li>$k&gt;1/2.5$, the peak amplitude raises beyond 1</li></ol><p>Assuming a class B operation, the efficiency improvement is calculated as</p><p><img src="class-f-power-amplifier/performance-of-different-value-of-third-order-harmonic.svg" alt="Performance of different value of third order harmonic"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">D[<span class="keyword">Cos</span>[x] - k <span class="keyword">Cos</span>[<span class="number">3</span> x], x]</span><br><span class="line"><span class="keyword">Solve</span>[-<span class="keyword">Sin</span>[x] + <span class="number">3</span> k <span class="keyword">Sin</span>[<span class="number">3</span> x] == <span class="number">0</span> &amp;&amp; <span class="number">0</span> &lt; x &lt; \[<span class="keyword">Pi</span>]/<span class="number">2</span> &amp;&amp; <span class="number">1</span> &gt; k &gt; <span class="number">1</span>/<span class="number">9</span>,</span><br><span class="line">  x]</span><br><span class="line">Vpk = <span class="keyword">Piecewise</span>[&#123;&#123;<span class="number">1</span> - k, </span><br><span class="line">     k &lt;= <span class="number">1</span>/<span class="number">9</span>&#125;, &#123;<span class="keyword">Cos</span>[x] - k <span class="keyword">Cos</span>[<span class="number">3</span> x] /. </span><br><span class="line">      x -&gt; <span class="number">1</span>/<span class="number">2</span> <span class="keyword">ArcCos</span>[(<span class="number">1</span> - <span class="number">3</span> k)/(<span class="number">6</span> k)], k &gt; <span class="number">1</span>/<span class="number">9</span>&#125;&#125;];</span><br><span class="line"><span class="keyword">Plot</span>[&#123;Vpk, <span class="number">10</span> <span class="keyword">Log10</span>[<span class="number">1</span>/Vpk], <span class="keyword">Pi</span>/<span class="number">4</span>/Vpk&#125;, &#123;k, <span class="number">0</span>, <span class="number">0.5</span>&#125;, </span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"Peak Value"</span>, <span class="string">"Power Increase [dB]"</span>, <span class="string">"Efficiency"</span>&#125;]</span><br></pre></td></tr></table></figure><p>Consider the maximal flat condition where $k=1/9$, the power improvement is 1.125, and the efficiency is 88.4 %. It is illustrated by the following figure.</p><p><img src="class-f-power-amplifier/maximally-flat-class-f-waveforms.png" alt="Maximally flat class F waveforms"></p><p>In the configuration, the current waveform is half-wave rectified sinewave, and the voltage is maximally flat third harmonically enhanced sinewave. It can be called class F operation.</p><p><img src="class-f-power-amplifier/generation-of-third-order-harmonic.png" alt="Generation of third order harmonic"></p><p>However, a half-wave rectified sine wave has no odd harmonics. To generate a voltage waveform with third order harmonic, the circuit must see an infinite third harmonic impedance, which is unrealizable. In reality, the action of the device knee region is to clip the peaks of the current wave, thus generating substantial amounts of third harmonic. </p><h2 id="Class-FD-Amplifier"><a href="#Class-FD-Amplifier" class="headerlink" title="Class FD Amplifier"></a>Class FD Amplifier</h2><p>Instead of manipulating odd harmonic impedance, the desired waveform can be obtain through clipping.</p><p><img src="class-f-power-amplifier/clipped-sinewave-formulation.png" alt="Clipped sinewave formulation"></p><p>The schematic is as follows</p><p><img src="class-f-power-amplifier/circuit-for-clipped-class-f-amplifier-analysis.png" alt="Circuit for clipped Class F amplifier analysis"></p><p>The key elements are</p><ol><li>SCSS even harmonic short</li><li>Fundamental load, whose value is deliberately higher</li><li>Series LC resonator at the fundamental to present open circuit at higher odd harmonics</li></ol><p>The voltage waveform should be a sinewave with amplitude of $I_{max}R_L/2$. It would attempt to clip at zero and $2V_{dc}$. The even harmonic short-circuit forces the upper clipping to mirror the actual physical clipping which occurs in the knee region.</p><p><img src="class-f-power-amplifier/class-fd-amplifier-schematic.png" alt="Class FD amplifier schematic"></p><p><img src="class-f-power-amplifier/simulated-results-of-class-fd-amplifier.png" alt="Simulated results of class FD amplifier"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>S. C. Cripps. <em>RF Power Amplifier for Wireless Communications</em>. Artech House, 2014.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
            <tag> Power Amplifier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Class D Power Amplifier</title>
      <link href="/archives/358f72b0/class-d-power-amplifier.html"/>
      <url>/archives/358f72b0/class-d-power-amplifier.html</url>
      
        <content type="html"><![CDATA[<p>This article intends to cover basic concepts of switching mode power amplifier, and the design of class D power amplifier.</p><a id="more"></a><h2 id="Simple-Switching-Amplifier"><a href="#Simple-Switching-Amplifier" class="headerlink" title="Simple Switching Amplifier"></a>Simple Switching Amplifier</h2><p><img src="class-d-power-amplifier/schematic-of-switching-amplifier.png" alt="Schematic of switching amplifier"></p><p><img src="class-d-power-amplifier/current-and-voltage-waveform.png" alt="Current and voltage waveform"></p><p>where we have</p><script type="math/tex; mode=display">V_{dc}=\frac{1}{2\pi}\int_{-\pi}^{\pi} v_{sw}(\theta)\ d\theta=\frac{\pi-\alpha}{\pi}V_{pk}\\I_{dc}=\frac{1}{2\pi}\int_{-\pi}^{\pi} i_{sw}(\theta)\ d\theta=\frac{\alpha}{\pi}I_{pk}</script><p>As for the fundamental components</p><script type="math/tex; mode=display">V_1=\frac{1}{\pi}\int_{-\pi}^{\pi}v_{sw}(\theta)\cos\theta\ d\theta=-\frac{2\sin\alpha}{\pi}V_{pk}\\I_1=\frac{1}{\pi}\int_{-\pi}^{\pi}i_{sw}(\theta)\cos\theta\ d\theta=\frac{2\sin\alpha}{\pi}I_{pk}\\</script><p>Mathematica code for Fourier series</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f[x_] := <span class="keyword">Piecewise</span>[&#123;&#123;<span class="number">0</span>, -a &lt;= x &lt;= a&#125;, &#123;<span class="number">1</span>, x &lt; -a&#125;, &#123;<span class="number">1</span>, x &gt; a&#125;&#125;]</span><br><span class="line"><span class="keyword">FourierCosCoefficient</span>[f[x], x, <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>Hence, we can calculate the efficiency as</p><script type="math/tex; mode=display">\eta=\frac{P_{rf}}{P_{dc}}=\frac{-\frac{1}{2}V_1I_1}{V_{dc}I_{dc}}=\frac{2\sin^2\alpha}{\alpha(\pi-\alpha)}</script><p>To compare with the class A PA, we write the output power as</p><script type="math/tex; mode=display">PUF=\frac{P_1}{P_{lin}}=\frac{V_{dc}I_{pk}\frac{2\sin^2\alpha}{\pi(\pi-\alpha)}}{\frac{1}{4}V_{dc}I_{pk}}=\frac{8\sin^2\alpha}{\pi(\pi-\alpha)}</script><p>We can plot the efficiency and PUF vs. conduction angle</p><p><img src="class-d-power-amplifier/efficiency-and-puf-vs-conduction-angle.png" alt="Efficiency and PUF vs conduction angle"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Eff[a_] := <span class="number">2</span> <span class="keyword">Sin</span>[a]^<span class="number">2</span>/a/(<span class="keyword">Pi</span> - a);</span><br><span class="line">PUF[a_] := <span class="number">8</span> <span class="keyword">Sin</span>[a]^<span class="number">2</span>/<span class="keyword">Pi</span>/(<span class="keyword">Pi</span> - a);</span><br><span class="line"><span class="keyword">Plot</span>[&#123;Eff[a], PUF[a]&#125;, &#123;a, <span class="number">0</span>, <span class="keyword">Pi</span>&#125;,</span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; <span class="string">"Expressions"</span>]</span><br></pre></td></tr></table></figure><p>The peak power occurs at a conduction angle of around 113 degrees. Though the structure dissipate no heat, the peak efficiency is about 81%, as some of the power is wasted in harmonic components.</p><h2 id="Switching-Amplifier-with-Harmonic-Short"><a href="#Switching-Amplifier-with-Harmonic-Short" class="headerlink" title="Switching Amplifier with Harmonic Short"></a>Switching Amplifier with Harmonic Short</h2><p>To remove harmonic components, we can place a harmonic short across the load.</p><p><img src="class-d-power-amplifier/switching-amplifier-with-harmonic-short.png" alt="Switching amplifier with harmonic short"></p><p>In this case, the voltage waveform must assume a sinusoidal form.</p><p><img src="class-d-power-amplifier/waveform-of-the-switching-amplifier-with-harmonic-short.png" alt="Waveform of the switching amplifier with harmonic short"></p><p>Repeat the analysis, we have</p><script type="math/tex; mode=display">\eta=\frac{P_{rf}}{P_{dc}}=\frac{\sin\alpha}{\alpha}\\PUF=\frac{P_1}{P_{lin}}=\frac{4\sin\alpha}{\pi}</script><p>It can be plotted as</p><p><img src="class-d-power-amplifier/efficiency-and-puf-vs-conduction-angle-of-switching-amplifier-with-harmonic-short.png" alt="Efficiency and PUF vs conduction angle of switching amplifier with harmonic short"></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Eff[a_] := <span class="keyword">Sin</span>[a]/a;</span><br><span class="line">PUF[a_] := <span class="number">4</span> <span class="keyword">Sin</span>[a]/<span class="keyword">Pi</span>;</span><br><span class="line"><span class="keyword">Plot</span>[&#123;Eff[a], PUF[a]&#125;, &#123;a, <span class="number">0</span>, <span class="keyword">Pi</span>&#125;,</span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; <span class="string">"Expressions"</span>]</span><br></pre></td></tr></table></figure><p>The peak power occurs at a conduction angle of 90 degrees with an efficiency of 63 %.</p><h2 id="Class-D-Power-Amplifier"><a href="#Class-D-Power-Amplifier" class="headerlink" title="Class D Power Amplifier"></a>Class D Power Amplifier</h2><p><img src="class-d-power-amplifier/class-d-power-amplifier.png" alt="Class D power amplifier"></p><p>The key point is that the <strong>current</strong> in the LCR branch is constrained to remain sinusoidal. With a sufficiently large bypass capacitor, the voltage $v_{sw}$ would remain $V_{dc}$ when the switch is turned to A, and remain zero when turned to B.</p><p><img src="class-d-power-amplifier/waveform-of-class-d-power-amplifier.png" alt="Waveform of class D power amplifier"></p><p>We have</p><script type="math/tex; mode=display">V_1=\frac{2}{\pi}V_{dc}\\I_1=\frac{1}{2}I_{pk}\\I_{pk}=\pi I_{dc}\\\eta=\frac{P_{rf}}{P_{dc}}=\frac{\frac{V_{dc}I_{pk}}{\pi}}{V_{dc}I_{dc}}=1\\PUF=\frac{\frac{V_{dc}I_{pk}}{\pi}}{\frac{1}{4}V_{dc}I_{pk}}=\frac{4}{\pi}</script><p>It can achieve theoretically 100 % efficiency with 1 dB higher power than class A amplifier.</p><p>A realization</p><p><img src="class-d-power-amplifier/schematic.png" alt="Schematic"></p><p><img src="class-d-power-amplifier/simulated-result.png" alt="Simulated result"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>S. C. Cripps. <em>RF Power Amplifier for Wireless Communications</em>. Artech House, 2014.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
            <tag> Power Amplifier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Class E Power Amplifier</title>
      <link href="/archives/b229b9f3/class-e-power-amplifier.html"/>
      <url>/archives/b229b9f3/class-e-power-amplifier.html</url>
      
        <content type="html"><![CDATA[<p>This article details the design of class E power amplifier.</p><a id="more"></a><h2 id="Calculation"><a href="#Calculation" class="headerlink" title="Calculation"></a>Calculation</h2><p><img src="class-e-power-amplifier/schematic-of-class-e-pa.png" alt="Schematic of class E PA"></p><p>In the analysis, all the time variable $t$ is replaced with conduction angle $\theta$.</p><p>It is apparent that $i(\theta)$ is composed of two component, namely</p><script type="math/tex; mode=display">i(\theta)=I_{dc}+I_{rf}\cos\theta</script><p>With the normalization $m=I_{rf}/I_{dc}$, we can write</p><script type="math/tex; mode=display">i(\theta)=I_{dc}(1+m\cos\theta)</script><p>The current waveform is as follows</p><p><img src="class-e-power-amplifier/current-waveform.png" alt="Current waveform"></p><p>The switched transistor turn on from $-\alpha_1$ to $\alpha_2$, where all the current flow through the transistor, and thus the $i_{sw}(\theta)$ replicates $i(\theta)$. Similarly, for the duration from $\alpha_2$ till $2\pi-\alpha_2$.</p><p>The conduction angle is defined as</p><script type="math/tex; mode=display">\phi=\alpha_1+\alpha_2</script><p>From the peak current, we have</p><script type="math/tex; mode=display">I_{pk}=I_{dc}(1+m)</script><p>From the initial condition $I_{dc}(1+m\cos\alpha_1)=0$, we have</p><script type="math/tex; mode=display">\cos\alpha_1=-\frac{1}{m}</script><p>Since the average current flow through the transistor equals to $I_{dc}$, we have</p><script type="math/tex; mode=display">\frac{I_{dc}}{2\pi}\int_{-\alpha_1}^{\alpha_2} (1+m\cos\theta) \ d\theta=I_{dc}</script><p>Combined with aforementioned equations, it leads to</p><script type="math/tex; mode=display">\sin\alpha_1=\frac{2\pi+\sin\phi-\phi}{m(1-\cos\phi)}</script><p>or</p><script type="math/tex; mode=display">1+\left(\frac{2\pi+\sin\phi-\phi}{1-\cos\phi}\right)=m^2</script><p>or</p><script type="math/tex; mode=display">(\alpha_1+\alpha_2)+m(\sin\alpha_1+\sin\alpha_2)=2\pi</script><p>where we established the connection between the conduction angle and the peak/average ratio. Note that this requirement also ensures that $\int_{\alpha_2}^{2\pi-\alpha_1} i_c(\theta) d\theta=0$ and $v_C(2\pi-\alpha_2)=0$.</p><p>The voltage can be written as</p><script type="math/tex; mode=display">\begin{aligned}v_C(\theta)&=\frac{I_{dc}}{\omega C_p}\int_{\alpha_2}^{\theta} (1+m\cos\theta) \ d\theta\\&=\frac{I_{dc}}{\omega C_p}(\theta+m\sin\theta-\alpha_2-m\sin\alpha_2)&&\alpha_2<\theta<2\pi-\alpha_1\\&=0&&-\alpha_1<\theta<\alpha_2\end{aligned}</script><p>The voltage waveform is as follows</p><p><img src="class-e-power-amplifier/voltage-waveform.png" alt="Voltage waveform"></p><p>The average DC value is</p><script type="math/tex; mode=display">\begin{aligned}V_{dc}&=\frac{I_{dc}}{2\pi\omega C_p}\int_{\alpha_2}^{2\pi-\alpha_1}(\theta+m\sin\theta-\alpha_2-m\sin\alpha_2)d\theta\\&=\frac{I_{dc}}{2\pi\omega C_p}\cdot\frac{m}{2}[m(\sin^2\alpha_1-\sin^2\alpha_2)+2(\cos\alpha_2-\cos\alpha_1)]\end{aligned}</script><p>The in-phase component</p><script type="math/tex; mode=display">\begin{aligned}V_{ci}&=\frac{I_{dc}}{\pi\omega C_p}\int_{\alpha_2}^{2\pi-\alpha_1}(\theta+m\sin\theta-\alpha_2-m\sin\alpha_2)\cos\theta\ d\theta\\&=-\frac{I_{dc}}{\pi\omega C_p}\cdot\frac{1}{2}[m(\sin^2\alpha_1-\sin^2\alpha_2)+2(\cos\alpha_2-\cos\alpha_1)]\end{aligned}</script><p>The quadrature component</p><script type="math/tex; mode=display">\begin{aligned}V_{cq}&=\frac{I_{dc}}{\pi\omega C_p}\int_{\alpha_2}^{2\pi-\alpha_1}(\theta+m\sin\theta-\alpha_2-m\sin\alpha_2)\sin\theta\ d\theta\\&=\frac{I_{dc}}{\pi\omega C_p}\cdot\frac{1}{2}[(m^2-2)(\sin\alpha_1+\sin\alpha_2)-\frac{m}{2}(\sin2\alpha_1+\sin2\alpha_2)]\end{aligned}</script><p>Power deliver to the load is therefore</p><script type="math/tex; mode=display">P_{rf}=\frac{1}{2}\mathrm{Re}[V\cdot I^*]=-\frac{1}{2}I_{pk}\cdot V_{ci}</script><p>and the DC power consumption is</p><script type="math/tex; mode=display">P_{dc}=I_{dc}\cdot V_{dc}</script><p>The two are identical, and thus the efficiency is 100%.</p><p>To calculate the required output impedance</p><p><img src="class-e-power-amplifier/output-impedance-calculation.png" alt="Output impedance calculation"></p><p>we may write</p><script type="math/tex; mode=display">V_{ci}\sin\omega t+V_{cq} \sin\omega t+I(R_L\cos\omega t-X_L\sin\omega t)=0</script><p>Real and imaginary parts are</p><script type="math/tex; mode=display">R_L=-\frac{V_{ci}}{I},X_L=\frac{V_{cq}}{I}</script><p>where $I=mI_{dc}$.</p><h2 id="Design-Consideration"><a href="#Design-Consideration" class="headerlink" title="Design Consideration"></a>Design Consideration</h2><p>The peak voltage is</p><script type="math/tex; mode=display">V_{pk}=\frac{I_{dc}}{\omega C_p}(\alpha_1+m\sin\alpha_1-\alpha_2-m\sin\alpha_2)</script><p>The peak current is</p><script type="math/tex; mode=display">I_{pk}=I_{dc}(1+m)</script><p>Thus, equivalent class A PA can deliver a power of</p><script type="math/tex; mode=display">P_{A}=\frac{1}{2}\frac{V_{pk}}{2}\frac{I_{pk}}{2}=\frac{1}{8}V_{pk}I_{pk}</script><p>It can be demonstrated that as the conduction angle increases, both the voltage peak-to-average ratio and the PUF (Power Utilization Factor, compared to class A PA with the same $V_{pk}$ and $I_{pk}$) increases.</p><p><img src="class-e-power-amplifier/peak-to-average-ratio-and-puf-vs-conduction-angle.png" alt="Peak-to-average ratio and PUF vs conduction angle"></p><p>The Mathematica code is as follows</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a1 = <span class="keyword">ArcTan</span>[-((<span class="number">2</span> <span class="keyword">Pi</span> + <span class="keyword">Sin</span>[phi] - phi)/(<span class="number">1</span> - <span class="keyword">Cos</span>[phi]))] + <span class="keyword">Pi</span>;</span><br><span class="line">a2 = phi - a1;</span><br><span class="line">m = <span class="number">-1</span>/<span class="keyword">Cos</span>[a1];</span><br><span class="line">Vpk = (a1 - a2 + m (<span class="keyword">Sin</span>[a1] - <span class="keyword">Sin</span>[a2]));</span><br><span class="line">Vdc = (<span class="number">1</span>/<span class="number">2</span>/<span class="keyword">Pi</span>) (m/<span class="number">2</span>) (m (<span class="keyword">Sin</span>[a1]^<span class="number">2</span> - <span class="keyword">Sin</span>[a2]^<span class="number">2</span>) + </span><br><span class="line">     <span class="number">2</span> (<span class="keyword">Cos</span>[a2] - <span class="keyword">Cos</span>[a1]));</span><br><span class="line">Ipk = m + <span class="number">1</span>;</span><br><span class="line">Pa = <span class="number">1</span>/<span class="number">8</span> Vpk Ipk;</span><br><span class="line">Pe = Vdc;</span><br><span class="line"><span class="keyword">Plot</span>[&#123;Vpk/Vdc, <span class="number">10</span> <span class="keyword">Log10</span>[Pe/Pa]&#125;, &#123;phi, <span class="number">0</span>, <span class="keyword">Pi</span>&#125;, </span><br><span class="line"> <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"Vpk/Vdc"</span>, <span class="string">"PUF"</span>&#125;]</span><br></pre></td></tr></table></figure><p>Required load</p><p><img src="class-e-power-amplifier/load-impedance-vs-conduction-angle.png" alt="Load impedance vs conduction angle"></p><p>The Mathematica code is as follows</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a1 = <span class="keyword">ArcTan</span>[-((<span class="number">2</span> <span class="keyword">Pi</span> + <span class="keyword">Sin</span>[phi] - phi)/(<span class="number">1</span> - <span class="keyword">Cos</span>[phi]))] + <span class="keyword">Pi</span>;</span><br><span class="line">a2 = phi - a1;</span><br><span class="line">m = <span class="number">-1</span>/<span class="keyword">Cos</span>[a1];</span><br><span class="line">Vci = <span class="number">-1</span>/<span class="number">2</span>/<span class="keyword">Pi</span> (m (<span class="keyword">Sin</span>[a1]^<span class="number">2</span> - <span class="keyword">Sin</span>[a2]^<span class="number">2</span>) + <span class="number">2</span> (<span class="keyword">Cos</span>[a2] - <span class="keyword">Cos</span>[a1]));</span><br><span class="line">Vcq = <span class="number">1</span>/<span class="number">2</span>/</span><br><span class="line">    <span class="keyword">Pi</span> ((m^<span class="number">2</span> - <span class="number">2</span>) (<span class="keyword">Sin</span>[a1] + <span class="keyword">Sin</span>[a2]) - m/<span class="number">2</span> (<span class="keyword">Sin</span>[<span class="number">2</span> a1] + <span class="keyword">Sin</span>[<span class="number">2</span> a2]));</span><br><span class="line"><span class="keyword">Plot</span>[&#123;-Vci/m, Vcq/m&#125;, &#123;phi, <span class="number">0</span>, <span class="keyword">Pi</span>&#125;, <span class="keyword">PlotLegends</span> -&gt; &#123;<span class="string">"Real"</span>, <span class="string">"Imag"</span>&#125;]</span><br></pre></td></tr></table></figure><h2 id="Design-Example"><a href="#Design-Example" class="headerlink" title="Design Example"></a>Design Example</h2><h3 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h3><ol><li><p>Choose the conduction angle $\phi$, and calculate normalized parameters. For instance, for a conduction angle of 125°.</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a1 = <span class="keyword">ArcTan</span>[-((<span class="number">2</span> <span class="keyword">Pi</span> + <span class="keyword">Sin</span>[phi] - phi)/(<span class="number">1</span> - <span class="keyword">Cos</span>[phi]))] + <span class="keyword">Pi</span>;</span><br><span class="line">a2 = phi - a1;</span><br><span class="line">m = <span class="number">-1</span>/<span class="keyword">Cos</span>[a1];</span><br><span class="line">Vdc = (<span class="number">1</span>/<span class="number">2</span>/<span class="keyword">Pi</span>) (m/<span class="number">2</span>) (m (<span class="keyword">Sin</span>[a1]^<span class="number">2</span> - <span class="keyword">Sin</span>[a2]^<span class="number">2</span>) + </span><br><span class="line">     <span class="number">2</span> (<span class="keyword">Cos</span>[a2] - <span class="keyword">Cos</span>[a1]));</span><br><span class="line">Ipk = m + <span class="number">1</span>;</span><br><span class="line">Vci = <span class="number">-1</span>/<span class="number">2</span>/<span class="keyword">Pi</span> (m (<span class="keyword">Sin</span>[a1]^<span class="number">2</span> - <span class="keyword">Sin</span>[a2]^<span class="number">2</span>) + <span class="number">2</span> (<span class="keyword">Cos</span>[a2] - <span class="keyword">Cos</span>[a1]));</span><br><span class="line">Vcq = <span class="number">1</span>/<span class="number">2</span>/</span><br><span class="line">    <span class="keyword">Pi</span> ((m^<span class="number">2</span> - <span class="number">2</span>) (<span class="keyword">Sin</span>[a1] + <span class="keyword">Sin</span>[a2]) - m/<span class="number">2</span> (<span class="keyword">Sin</span>[<span class="number">2</span> a1] + <span class="keyword">Sin</span>[<span class="number">2</span> a2]));</span><br><span class="line">Rl = -Vci/m;</span><br><span class="line">Xl = Vcq/m;</span><br><span class="line">&#123;Vdc, Ipk, Rl, Xl&#125; /. phi -&gt; <span class="number">125</span>/<span class="number">180</span> <span class="keyword">Pi</span> // N</span><br><span class="line"><span class="comment">(* result: &#123;1.36071, 4.28307, 0.252485, 0.532716&#125; *)</span></span><br></pre></td></tr></table></figure></li><li><p>Scaling the parameters</p><ol><li>Scale the $I_{pk}$ by $I_{dc}$</li><li>Scale the $V_{dc}$ by $I_{dc}/(\omega C_p)$</li><li>Scale the impedances by $1/(\omega C_p)$</li></ol><p>For instance, for a actual $I_{pk}=1,V_{dc}=4.8$, the voltage need to be scaled by 4.8/1.36, the current need to be scaled by 1/4.28, and the impedances need to be scaled by 15.1.</p></li></ol><h3 id="Verification"><a href="#Verification" class="headerlink" title="Verification"></a>Verification</h3><p><img src="class-e-power-amplifier/schematic-of-an-ideal-class-e-pa.png" alt="Schematic of an ideal class E PA"></p><p>The simulation results are as follows:</p><p><img src="class-e-power-amplifier/simulated-result-of-the-ideal-pa.png" alt="Simulated result of the ideal PA"></p><p>The oscillating problem can be alleviated by reducing the capacitor from 12.4 pF to 10.4 pF.</p><p><img src="class-e-power-amplifier/simulated-result-of-the-ideal-pa-with-tuning.png" alt="Simulated result of the ideal PA with tuning"></p><p>If we adopt a real transistor</p><p><img src="class-e-power-amplifier/schematic-of-a-real-class-e-pa-in-180nm-cmos.png" alt="Schematic of a real class E PA in 180nm CMOS"></p><p>The simulated performance is</p><p><img src="class-e-power-amplifier/simulated-result-of-the-real-pa.png" alt="Simulated result of the real PA"></p><p>It delivers 19 dBm output power with DE of 82% at 850 MHz.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>S. C. Cripps. <em>RF Power Amplifier for Wireless Communications</em>. Artech House, 2014.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
            <tag> Power Amplifier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IC Calculator</title>
      <link href="/archives/7ca3cc72/ic-calculator.html"/>
      <url>/archives/7ca3cc72/ic-calculator.html</url>
      
        <content type="html"><![CDATA[<p>This article features calculators of:</p><ul><li>Simple calculator</li><li>Resonating frequency.</li><li>Impedance conversion.</li><li>Transmission line RLGC parameters from S parameters.</li></ul><a id="more"></a><h1 id="Simple-Calculator-with-mathjs"><a href="#Simple-Calculator-with-mathjs" class="headerlink" title="Simple Calculator with mathjs"></a>Simple Calculator with mathjs</h1><p>Usages includes:</p><ul><li>Direct calculation: <code>(1+2) 3/4</code> (where space denotes multiplication)</li><li>Variable definition: <code>x=2</code></li><li>Function definition: <code>db(x)=20 log10(x)</code></li><li>Matrix calculation: <code>det([1, 2;3, 4])</code></li><li>Symbolic calaulation:<ul><li><code>a=simplify(&#39;x+x&#39;)</code></li><li><code>a.evaluate({x:2})</code></li><li><code>derivative(&#39;log(x)&#39;,&#39;x&#39;)</code></li></ul></li></ul><p>Refer to <a href="https://mathjs.org/docs/index.html" target="_blank" rel="noopener">mathjs documentation</a> for detailed usages.</p><html><script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script><script type="text/javascript">const { complex, add, subtract, multiply, divide, sqrt, pow, abs, pi, e, log, log10, format } = math;const parser = math.parser()function s2rlgc(s11, s12, s21, s22, linelength, freq, z0){    precision = 5;    output = 'Result:<br/><table>'    s11_2 = pow(s11, 2);    s21_2 = pow(s21, 2);    Z2_num = subtract(pow(add(1, s11), 2), s21_2);    Z2_den = subtract(pow(subtract(1, s11), 2), s21_2);    knum2 = multiply(Z2_num, Z2_den);    knum = sqrt(knum2);    expGammaLenPos = divide(add(add(subtract(1, s11_2), s21_2), knum), multiply(2, s21));    logexp = log(expGammaLenPos);    gamma = divide(logexp, linelength);    output += ('<tr><td>Gamma:</td><td>' + gamma.format(precision) + '</td></tr>');    Z2 = divide(multiply(pow(z0, 2), Z2_num), Z2_den);    Zc = sqrt(Z2);    output += ('<tr><td>Zc:</td><td>' + Zc.format(precision) + '</td></tr>');    w = multiply(2, multiply(pi, freq));    R = multiply(gamma, Zc).re;    L = divide(multiply(gamma, Zc).im, w);    G = divide(gamma, Zc).re;    C = divide(divide(gamma, Zc).im, w);    output += ('<tr><td>R:</td><td>' + format(R, precision) + '</td></tr>');    output += ('<tr><td>L:</td><td>' + format(L, precision) + '</td></tr>');    output += ('<tr><td>G:</td><td>' + format(G, precision) + '</td></tr>');    output += ('<tr><td>C:</td><td>' + format(C, precision) + '</td></tr>');    A = 20 * gamma.re * log10(e);    output += ('<tr><td>A [dB/m]:</td><td>' + format(A, precision) + '</td></tr>');    keff = pow(gamma.im * 299792458 / w, 2);    output += ('<tr><td>Keff:</td><td>' + format(keff, precision) + '</td></tr>');    theta = multiply(divide(multiply(linelength, gamma.im), pi), 180);    output += ('<tr><td>Theta [deg]:</td><td>' + format(theta, precision) + '</td></tr>');    output += '</table>';    return output;}function calcImp(){    precision = 5;    freq = parseFloat($("#freqi").val()) * 1e9;    w = 2 * pi * freq;    Z = complex(parseFloat($("#Ireal").val()), parseFloat($("#Iimag").val()));    Y = divide(1, Z);    Z0 = complex(parseFloat($("#Nr").val()), parseFloat($("#Ni").val()));    R = divide(subtract(Z, Z0), add(Z, Z0));    //$("#Ireal").val(format(Z.re, precision));    //$("#Iimag").val(format(Z.im, precision));    $("#Areal").val(format(Y.re, precision));    $("#Aimag").val(format(Y.im, precision));    $("#SR").val(format(Z.re, precision));    $("#PR").val(format(1/Y.re, precision));    $("#Rr").val(format(R.re, precision));    $("#Ri").val(format(R.im, precision));    if( Z.im < 0 ){ // Capacitative        SC = -1 / w / Z.im * 1e15;        PC = Y.im / w * 1e15;        $("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        $("#ST").val("Scap");        $("#PT").val("Pcap");    }    else{        SC = Z.im / w * 1e12;        PC = -1 / w / Y.im * 1e12;        $("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        $("#ST").val("Sind");        $("#PT").val("Pind");    }    G = R.abs()    $("#vswr").html(format((1+G)/(1-G), precision));    $("#q").html(format(abs(Z.im/Z.re), precision));}function calcAdm(){    precision = 5;    freq = parseFloat($("#freqi").val()) * 1e9;    w = 2 * pi * freq;    Y = complex(parseFloat($("#Areal").val()), parseFloat($("#Aimag").val()));    Z = divide(1, Y);    Z0 = complex(parseFloat($("#Nr").val()), parseFloat($("#Ni").val()));    R = divide(subtract(Z, Z0), add(Z, Z0));    $("#Ireal").val(format(Z.re, precision));    $("#Iimag").val(format(Z.im, precision));    //$("#Areal").val(format(Y.re, precision));    //$("#Aimag").val(format(Y.im, precision));    $("#SR").val(format(Z.re, precision));    $("#PR").val(format(1/Y.re, precision));    $("#Rr").val(format(R.re, precision));    $("#Ri").val(format(R.im, precision));    if( Z.im < 0 ){ // Capacitative        SC = -1 / w / Z.im * 1e15;        PC = Y.im / w * 1e15;        $("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        $("#ST").val("Scap");        $("#PT").val("Pcap");    }    else{        SC = Z.im / w * 1e12;        PC = -1 / w / Y.im * 1e12;        $("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        $("#ST").val("Sind");        $("#PT").val("Pind");    }    G = R.abs()    $("#vswr").html(format((1+G)/(1-G), precision));    $("#q").html(format(abs(Z.im/Z.re), precision));}function calcS(){    precision = 5;    freq = parseFloat($("#freqi").val()) * 1e9;    w = 2 * pi * freq;    if($("#ST").val() == "Scap"){        Zi = -1 / parseFloat($("#SC").val()) / w * 1e15;    }    else{        Zi = parseFloat($("#SC").val()) * w * 1e-12;    }    Z = complex(parseFloat($("#SR").val()), Zi);    Y = divide(1, Z);    Z0 = complex(parseFloat($("#Nr").val()), parseFloat($("#Ni").val()));    R = divide(subtract(Z, Z0), add(Z, Z0));    $("#Ireal").val(format(Z.re, precision));    $("#Iimag").val(format(Z.im, precision));    $("#Areal").val(format(Y.re, precision));    $("#Aimag").val(format(Y.im, precision));    //$("#SR").val(format(Z.re, precision));    $("#PR").val(format(1/Y.re, precision));    $("#Rr").val(format(R.re, precision));    $("#Ri").val(format(R.im, precision));    if( Z.im < 0 ){ // Capacitative        //SC = -1 / w / Z.im * 1e15;        PC = Y.im / w * 1e15;        //$("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        //$("#ST").val("Scap");        $("#PT").val("Pcap");    }    else{        //SC = Z.im / w * 1e12;        PC = -1 / w / Y.im * 1e12;        //$("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        //$("#ST").val("Sind");        $("#PT").val("Pind");    }    G = R.abs()    $("#vswr").html(format((1+G)/(1-G), precision));    $("#q").html(format(abs(Z.im/Z.re), precision));}function calcP(){    precision = 5;    freq = parseFloat($("#freqi").val()) * 1e9;    w = 2 * pi * freq;    if($("#PT").val() == "Pcap"){        Yi = parseFloat($("#PC").val()) * w * 1e-15;    }    else{        Yi = -1 / parseFloat($("#PC").val()) / w * 1e12;    }    Y = complex(1/parseFloat($("#PR").val()), Yi);    Z = divide(1, Y);    Z0 = complex(parseFloat($("#Nr").val()), parseFloat($("#Ni").val()));    R = divide(subtract(Z, Z0), add(Z, Z0));    $("#Ireal").val(format(Z.re, precision));    $("#Iimag").val(format(Z.im, precision));    $("#Areal").val(format(Y.re, precision));    $("#Aimag").val(format(Y.im, precision));    $("#SR").val(format(Z.re, precision));    //$("#PR").val(format(1/Y.re, precision));    $("#Rr").val(format(R.re, precision));    $("#Ri").val(format(R.im, precision));    if( Z.im < 0 ){ // Capacitative        SC = -1 / w / Z.im * 1e15;        //PC = Y.im / w * 1e15;        $("#SC").val(format(SC, precision));        //$("#PC").val(format(PC, precision));        $("#ST").val("Scap");        //$("#PT").val("Pcap");    }    else{        SC = Z.im / w * 1e12;        //PC = -1 / w / Y.im * 1e12;        $("#SC").val(format(SC, precision));        //$("#PC").val(format(PC, precision));        $("#ST").val("Sind");        //$("#PT").val("Pind");    }    G = R.abs()    $("#vswr").html(format((1+G)/(1-G), precision));    $("#q").html(format(abs(Z.im/Z.re), precision));}function calcR(){    precision = 5;    freq = parseFloat($("#freqi").val()) * 1e9;    w = 2 * pi * freq;    Z0 = complex(parseFloat($("#Nr").val()), parseFloat($("#Ni").val()));    R = complex(parseFloat($("#Rr").val()), parseFloat($("#Ri").val()));    Z = multiply(Z0, divide(add(1, R), subtract(1, R)));    Y = divide(1, Z);    $("#Ireal").val(format(Z.re, precision));    $("#Iimag").val(format(Z.im, precision));    $("#Areal").val(format(Y.re, precision));    $("#Aimag").val(format(Y.im, precision));    $("#SR").val(format(Z.re, precision));    $("#PR").val(format(1/Y.re, precision));    $("#Rr").val(format(R.re, precision));    $("#Ri").val(format(R.im, precision));    if( Z.im < 0 ){ // Capacitative        SC = -1 / w / Z.im * 1e15;        PC = Y.im / w * 1e15;        $("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        $("#ST").val("Scap");        $("#PT").val("Pcap");    }    else{        SC = Z.im / w * 1e12;        PC = -1 / w / Y.im * 1e12;        $("#SC").val(format(SC, precision));        $("#PC").val(format(PC, precision));        $("#ST").val("Sind");        $("#PT").val("Pind");    }    G = R.abs()    $("#vswr").html(format((1+G)/(1-G), precision));    $("#q").html(format(abs(Z.im/Z.re), precision));}$(document).ready(function(){    $("#calcRLGC").click(function(){        Z0 = parseFloat($("#Z0").val());        length = parseFloat($("#l").val());        freq = parseFloat($("#freq").val());        if( $("#S22r").val() == '' ){            $("#S22r").val($("#S11r").val());        }        if( $("#S22i").val() == '' ){            $("#S22i").val($("#S11i").val());        }        if( $("#S12r").val() == '' ){            $("#S12r").val($("#S21r").val());        }        if( $("#S12i").val() == '' ){            $("#S12i").val($("#S21i").val());        }        S11 = complex({r: parseFloat($("#S11r").val()), phi: parseFloat($("#S11i").val()) * pi / 180});        S12 = complex({r: parseFloat($("#S12r").val()), phi: parseFloat($("#S12i").val()) * pi / 180});        S21 = complex({r: parseFloat($("#S21r").val()), phi: parseFloat($("#S21i").val()) * pi / 180});        S22 = complex({r: parseFloat($("#S22r").val()), phi: parseFloat($("#S22i").val()) * pi / 180});        $("#resRLGC").html(s2rlgc(S11, S12, S21, S22, length * 1e-6, freq * 1e9, Z0));    });    $("#calcImp").click(calcImp);    $("#Ireal").change(calcImp);    $("#Iimag").change(calcImp);    $("#calcAdm").click(calcAdm);    $("#Areal").change(calcAdm);    $("#Aimag").change(calcAdm);    $("#calcS").click(calcS);    $("#SR").change(calcS);    $("#SC").change(calcS);    $("#calcP").click(calcP);    $("#PR").change(calcP);    $("#PC").change(calcP);    $("#calcR").click(calcR);    $("#Rr").change(calcR);    $("#Ri").change(calcR);    $("#calcImpConv").click(calcImpConv);    $("#Sreal").change(calcImpConv);    $("#Simag").change(calcImpConv);    $("#Lreal").change(calcImpConv);    $("#Limag").change(calcImpConv);    $("#Fconv").change(calcImpConv);    //$("#simp-input").change(calcSimp);});function calcResFreq(){    $("#res-freq").val(format(1/2/pi/sqrt(parseFloat($("#res-ind").val())*parseFloat($("#res-cap").val())*1e-27)/1e9, 5));}function calcResInd(){    $("#res-ind").val(format(1/4/pi/pi/pow(parseFloat($("#res-freq").val()), 2)/parseFloat($("#res-cap").val())*1e9, 5));}function calcResCap(){    $("#res-cap").val(format(1/4/pi/pi/pow(parseFloat($("#res-freq").val()), 2)/parseFloat($("#res-ind").val())*1e9, 5));}function calcSimp(){    input = $("#simp-input").val();    inputHistory.push( input );    currentItem = inputHistory.length;    $("#simp-input").val("");    if(input == ""){        return;    }    else if(input == "clean"){        $("#simp-res").html("");        return;    }    else if(input == "clear"){        cleanSimp();        return;    }    content = ">>> " + input + "\n";    try{        var tmp = parser.evaluate(input).toString();        if(tmp == "function e(t,r){\"use strict\";if(arguments.length===_&&p(t)&&v(r)){return j.apply(null,arguments)}if(arguments.length===I&&m(t)&&b(r)){return E.apply(null,arguments)}if(arguments.length===q&&h(t)&&x(r)){return S.apply(null,arguments)}if(arguments.length===B&&d(t)&&w(r)){return A.apply(null,arguments)}if(arguments.length===k&&y(t)&&N(r)){return C.apply(null,arguments)}if(arguments.length===z&&g(t)&&O(r)){return T.apply(null,arguments)}return P.apply(null,arguments)}"){            tmp = "Function defined";        }        content += tmp + "\n";    }    catch(err){        content += "Error: " + err.message + "\n";    }    $("#simp-res").append(content);    var height = $("#simp-res")[0].scrollHeight;    $("#simp-res").scrollTop(height);}function cleanSimp(){    $("#simp-res").html("");    parser.clear();    $("#simp-input").val("");    inputHistory = new Array();    currentItem = 0;}var keyEnter = 13;var keyUp = 38;var keyDown = 40;var inputHistory = new Array();var tmpInput = '';var currentItem = 0;$(document).keydown(function(event){    var isFocus=$("#simp-input").is(":focus");    if(isFocus){        //alert(event.keyCode);        if(event.keyCode == keyEnter){            calcSimp();            return false;        }        if(event.keyCode == keyUp){            if(currentItem != 0){                if(currentItem == inputHistory.length){                    tmpInput = $("#simp-input").val();                }                currentItem -= 1;                $("#simp-input").val(inputHistory[currentItem]);                var l = inputHistory[currentItem].length;                document.getElementById('simp-input').setSelectionRange(l, l);            }            return false;        }        if(event.keyCode == keyDown){            if(currentItem < inputHistory.length - 1){                currentItem += 1;                $("#simp-input").val(inputHistory[currentItem]);                var l = inputHistory[currentItem].length;                document.getElementById('simp-input').setSelectionRange(l, l);            }            else if(currentItem == inputHistory.length - 1){                currentItem += 1;                $("#simp-input").val(tmpInput);            }            return false;        }    }})function unitConv(x){    var y = abs(x);    if( y <= 1e-18 ){        return format(x, 5) + ' '    }    else if ( y <= 1e-12 ){        return ( x * 1e15 ).toFixed(2) + ' f'    }    else if( y <= 1e-9 ){        return ( x * 1e12 ).toFixed(2) + ' p'    }    else if( y <= 1e-6 ){        return ( x * 1e9 ).toFixed(2) + ' n'    }    else if( y <= 1e-3 ){        return ( x * 1e6 ).toFixed(2) + ' u'    }    else if( y <= 1 ){        return ( x * 1e3 ).toFixed(2) + ' m'    }    else{        return format(x, 5) + ' '    }}function parseLC(x, w){    if(x > 0){        return 'L<br>(' + unitConv(x/w) + 'H)';    }    else{        return 'C<br>(' + unitConv(-1/w/x) + 'F)';    }}function calcImpConv(){    var output = '<table>'    var F = parseFloat($("#Fconv").val());    var w = 2 * pi * F * 1e9;    var R2 = parseFloat($("#Sreal").val());    var X2 = parseFloat($("#Simag").val());    var R1 = parseFloat($("#Lreal").val());    var X1 = parseFloat($("#Limag").val());    // type 1    var XP = (R2*X1 - sqrt(R1*R1*R1*R2 - R1*R1*R2*R2 + R1*R2*X1*X1))/(R1 - R2);    var XS = (R2*X1 - (R1*R2*X1)/(R1 - R2) + (R2*R2*X1)/(R1 - R2) + (R1*sqrt((-R1)*R2*(-R1*R1 + R1*R2 - X1*X1)))/(R1 - R2) - (R2*sqrt((-R1)*R2*(-R1*R1 + R1*R2 - X1*X1)))/(R1 - R2) + R1*X2)/R1;    if(!isNaN(XP) && !isNaN(XS)){        output += '<tr>'        output += ('<td>Zs*<br>(' + R2.toFixed(2) + '+j*' + X2.toFixed(2) + ')</td>');        output += ('<td>Series ' + parseLC(XS, w) + '</td>');        output += ('<td>Shunt ' + parseLC(XP, w) + '</td>');        output += ('<td>Zl<br>(' + R1.toFixed(2) + '+j*' + X1.toFixed(2) + ')</td>');        output += '</tr>'    }    // type 2    XP = (R2*X1 + sqrt(R1*R1*R1*R2 - R1*R1*R2*R2 + R1*R2*X1*X1))/(R1 - R2);    XS = (R2*X1 - (R1*R2*X1)/(R1 - R2) + (R2*R2*X1)/(R1 - R2) - (R1*sqrt((-R1)*R2*(-R1*R1 + R1*R2 - X1*X1)))/(R1 - R2) + (R2*sqrt((-R1)*R2*(-R1*R1 + R1*R2 - X1*X1)))/(R1 - R2) + R1*X2)/R1;    if(!isNaN(XP) && !isNaN(XS)){        output += '<tr>'        output += ('<td>Zs*<br>(' + R2.toFixed(2) + '+j*' + X2.toFixed(2) + ')</td>');        output += ('<td>Series ' + parseLC(XS, w) + '</td>');        output += ('<td>Shunt ' + parseLC(XP, w) + '</td>');        output += ('<td>Zl<br>(' + R1.toFixed(2) + '+j*' + X1.toFixed(2) + ')</td>');        output += '</tr>'    }    // type 3    XP = (R1*X2 - sqrt((-R1*R1)*R2*R2 + R1*R2*R2*R2 + R1*R2*X2*X2))/(R1 - R2);    XS = ((-R2)*X1 - R1*X2 + (R1*R1*X2)/(R1 - R2) - (R1*R2*X2)/(R1 - R2) - (R1*sqrt(R1*R2*((-R1)*R2 + R2*R2 + X2*X2)))/(R1 - R2) + (R2*sqrt(R1*R2*((-R1)*R2 + R2*R2 + X2*X2)))/(R1 - R2))/R2;    if(!isNaN(XP) && !isNaN(XS)){        output += '<tr>'        output += ('<td>Zs*<br>(' + R2.toFixed(2) + '+j*' + X2.toFixed(2) + ')</td>');        output += ('<td>Shunt ' + parseLC(XP, w) + '</td>');        output += ('<td>Series ' + parseLC(XS, w) + '</td>');        output += ('<td>Zl<br>(' + R1.toFixed(2) + '+j*' + X1.toFixed(2) + ')</td>');        output += '</tr>'    }    // type 3    XP = (R1*X2 + sqrt((-R1*R1)*R2*R2 + R1*R2*R2*R2 + R1*R2*X2*X2))/(R1 - R2);    XS = ((-R2)*X1 - R1*X2 + (R1*R1*X2)/(R1 - R2) - (R1*R2*X2)/(R1 - R2) + (R1*sqrt(R1*R2*((-R1)*R2 + R2*R2 + X2*X2)))/(R1 - R2) - (R2*sqrt(R1*R2*((-R1)*R2 + R2*R2 + X2*X2)))/(R1 - R2))/R2;    if(!isNaN(XP) && !isNaN(XS)){        output += '<tr>'        output += ('<td>Zs*<br>(' + R2.toFixed(2) + '+j*' + X2.toFixed(2) + ')</td>');        output += ('<td>Shunt ' + parseLC(XP, w) + '</td>');        output += ('<td>Series ' + parseLC(XS, w) + '</td>');        output += ('<td>Zl<br>(' + R1.toFixed(2) + '+j*' + X1.toFixed(2) + ')</td>');        output += '</tr>'    }    output += '</table>'    $("#resImpConv").html(output);}</script><style type="text/css">    input {        text-align:center;        vertical-align:middle    }    #simp-res {        font-family:"Courier New";        font-weight:bold;        background-color: #F1F1F1;        line-height: normal;        border:none;        width:100%;    }    #simp-input {        font-family:"Courier New";        font-weight:bold;    }</style>    <div id="simp-res-div">        <textarea id="simp-res" readonly="readonly" rows="16"></textarea>    </div>    <input type="text" id="simp-input" value size="30" style="text-align:left">    <button type="button" onclick="calcSimp()">Calculate</button>    <button type="button" onclick="cleanSimp()">Clear</button><h2>Resonance</h2><table>    <tr>        <td>Frequency [GHz]</td>        <td><input type="text" id="res-freq" value="28" size="10" onclick="this.select()"></td>        <td><button type="button" onclick="calcResFreq()">Calculate This</button></td>    </tr>    <tr>        <td>Inductance [pH]</td>        <td><input type="text" id="res-ind" value="200" size="10" onclick="this.select()"></td>        <td><button type="button" onclick="calcResInd()">Calculate This</button></td>    </tr>    <tr>        <td>Capacitance [fF]</td>        <td><input type="text" id="res-cap" value="160" size="10" onclick="this.select()"></td>        <td><button type="button" onclick="calcResCap()">Calculate This</button></td>    </tr></table><h2>Impedance Conversion</h2><table>    <tr>        <td>Frequency [GHz]</td>        <td><input type="text" id="freqi" value="28" size="10" onclick="this.select()"></td>        <td></td>        <td></td>        <td></td>    </tr>    <tr>        <td>Impedance</td>        <td><input type="text" id="Ireal" value="50" size="10" onclick="this.select()"></td>        <td>+j*</td>        <td><input type="text" id="Iimag" value="0" size="10" onclick="this.select()"></td>        <td><button type="button" id="calcImp">Calculate</button></td>    </tr>    <tr>        <td>Admittance</td>        <td><input type="text" id="Areal" value="0.02" size="10" onclick="this.select()"></td>        <td>+j*</td>        <td><input type="text" id="Aimag" value="0" size="10" onclick="this.select()"></td>        <td><button type="button" id="calcAdm">Calculate</button></td>    </tr>    <tr>        <td>Series</td>        <td><input type="text" id="SR" value="50" size="10" onclick="this.select()"></td>        <td>+</td>        <td>            <input type="text" id="SC" value="0" size="10" onclick="this.select()">            <select id="ST">                <option value="Scap">fF</option>                <option value="Sind">pH</option>            </select>        </td>        <td><button type="button" id="calcS">Calculate</button></td>    </tr>    <tr>        <td>Shunt</td>        <td><input type="text" id="PR" value="50" size="10" onclick="this.select()"></td>        <td>||</td>        <td>            <input type="text" id="PC" value="0" size="10" onclick="this.select()">            <select id="PT">                <option value="Pcap">fF</option>                <option value="Pind">pH</option>            </select></td>        <td><button type="button" id="calcP">Calculate</button></td>    </tr>    <tr>        <td>Z0</td>        <td><input type="text" id="Nr" value="50" size="10" onclick="this.select()"></td>        <td>+j*</td>        <td><input type="text" id="Ni" value="0" size="10" onclick="this.select()"></td>        <td></td>    </tr>    <tr>        <td>Reflection</td>        <td><input type="text" id="Rr" value="0" size="10" onclick="this.select()"></td>        <td>+j*</td>        <td><input type="text" id="Ri" value="0" size="10" onclick="this.select()"></td>        <td><button type="button" id="calcR">Calculate</button></td>    </tr>    <tr>        <td>VSWR</td>        <td id="vswr"></td>        <td></td>        <td></td>        <td></td>    </tr>    <tr>        <td>Q</td>        <td id="q"></td>        <td></td>        <td></td>        <td></td>    </tr></table><h2>Impedance Matching</h2><table>    <tr>        <td>Frequency [GHz]</td>        <td><input type="text" id="Fconv" value="28" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>Zs*</td>        <td><input type="text" id="Sreal" value="50" size="10" onclick="this.select()"></td>        <td>+j*</td>        <td><input type="text" id="Simag" value="0" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>Zl</td>        <td><input type="text" id="Lreal" value="50" size="10" onclick="this.select()"></td>        <td>+j*</td>        <td><input type="text" id="Limag" value="0" size="10" onclick="this.select()"></td>    </tr></table><button type="button" id="calcImpConv">Calculate</button><p id="resImpConv"></p><h2>S to RLGC</h2><table>    <tr>        <td>Z0 [Ohm]</td>        <td><input type="text" id="Z0" value="50" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>Length [um]</td>        <td><input type="text" id="l" value="200" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>Frequency [GHz]</td>        <td><input type="text" id="freq" value="28" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>S11,mag</td>        <td><input type="text" id="S11r" value="0.012" size="10" onclick="this.select()">        </td><td>S11,pha</td>        <td><input type="text" id="S11i" value="-115.7" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>S21,mag</td>        <td><input type="text" id="S21r" value="0.985" size="10" onclick="this.select()">        </td><td>S21,pha</td>        <td><input type="text" id="S21i" value="-14.3" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>S12,mag</td>        <td><input type="text" id="S12r" size="10" onclick="this.select()">        </td><td>S12,pha</td>        <td><input type="text" id="S12i" size="10" onclick="this.select()"></td>    </tr>    <tr>        <td>S22,mag</td>        <td><input type="text" id="S22r" size="10" onclick="this.select()">        </td><td>S22,pha</td>        <td><input type="text" id="S22i" size="10" onclick="this.select()"></td>    </tr></table><button type="button" id="calcRLGC">Calculate</button><p id="resRLGC"></p></html>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
            <tag> RF </tag>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lumped-Element Circuit</title>
      <link href="/archives/df4c5938/lumped-element-circuit.html"/>
      <url>/archives/df4c5938/lumped-element-circuit.html</url>
      
        <content type="html"><![CDATA[<p>This paper explains how to implemented distributed components (e.g., transmission line, balun, coupler) with lumped elements.</p><a id="more"></a><h2 id="Transmission-Line"><a href="#Transmission-Line" class="headerlink" title="Transmission Line"></a>Transmission Line</h2><h3 id="Cutoff-Frequency"><a href="#Cutoff-Frequency" class="headerlink" title="Cutoff Frequency"></a>Cutoff Frequency</h3><p><img src="lumped-element-circuit/ladder-network.png" alt="Ladder network"></p><p>For an infinite ladder network shown above, the input impedance to the right of each nodes is the same (e.g., <strong><em>A, B, C</em></strong>). Therefore, we may write</p><script type="math/tex; mode=display">Z_{in}=Z+[(1/Y)||Z_{in}]</script><p>Solution to the above equation is</p><script type="math/tex; mode=display">Z_{in}=\frac{Z}{2}\left(1\pm\sqrt{1+\frac{4}{ZY}}\right)</script><p>Assuming a sufficiently small $|ZY|$, the above is simply</p><script type="math/tex; mode=display">Z_{in}\approx\sqrt{Z/Y}</script><p>If $Z=sL,Y=sC$, we may note that the input impedance is purely real and act like a resistor. However, the transmission line of infinite length is made of purely reactive elements and does not dissipate power. The solution is that the energy keeps travelling along the line forever.</p><p>Suppose that $Y=j\omega C,Z=j\omega L$, the exact input impedance is</p><script type="math/tex; mode=display">Z_{in}=\frac{j\omega L}{2}\left(1\pm\sqrt{1-\frac{4}{\omega^2LC}}\right)</script><p>It is apparent that the term under the radical becomes positive above a frequency of</p><script type="math/tex; mode=display">\omega_h=2/\sqrt{LC}</script><p>which makes the input impedance purely imaginary, and sets an upper bound of the artificial transmission line.</p><h3 id="Equivalent-π-Representation"><a href="#Equivalent-π-Representation" class="headerlink" title="Equivalent-π Representation"></a>Equivalent-π Representation</h3><p><img src="lumped-element-circuit/pi-representation.png" alt="Pi representation"></p><p>we have</p><script type="math/tex; mode=display">\begin{aligned}Z&=Z_0{\sinh\gamma l}\\&=jZ_0\sin\theta\\Y&=\frac{1}{Z_0}\tanh(\gamma l/2)\\&=\frac{j}{Z_0}\tan(\theta/2)\end{aligned}</script><p>To synthesize a $\lambda/4$ transmission line, we need a inductor of $L=Z_0/\omega_0$ and capacitors of $C=1/(\omega_0Z_0)$. Alternatively, we may synthesize $3\lambda/4$ transmission line, the inductor and the capacitor may swap position.</p><h3 id="Equivalent-T-Representation"><a href="#Equivalent-T-Representation" class="headerlink" title="Equivalent-T Representation"></a>Equivalent-T Representation</h3><p><img src="lumped-element-circuit/t-representation.png" alt="T representation"></p><p>we have</p><script type="math/tex; mode=display">\begin{aligned}Z&=Z_0{\tanh(\gamma l/2)}\\&=jZ_0\tan(\theta/2)\\Y&=\frac{1}{Z_0}\sinh(\gamma l)\\&=\frac{j}{Z_0}\sin(\theta)\end{aligned}</script><p>To synthesize a $\lambda/4$ transmission line, we need inductors of $Z_0/\omega_0$ and a capacitor of $1/(\omega_0Z_0)$.</p><h2 id="Coupled-Transmission-Line"><a href="#Coupled-Transmission-Line" class="headerlink" title="Coupled Transmission Line"></a>Coupled Transmission Line</h2><h3 id="Transformer-based"><a href="#Transformer-based" class="headerlink" title="Transformer-based"></a>Transformer-based</h3><p><img src="lumped-element-circuit/coupled-transmission-line.png" alt="Coupled transmission line"></p><p>Equating their respective parameters, we have</p><script type="math/tex; mode=display">L=\frac{(Z_{0e}+Z_{0o})\sin\theta}{2\omega_0}\\M=\frac{(Z_{0e}-Z_{0o})\sin\theta}{2\omega_0}\\C_g=\frac{\tan(\theta/2)}{\omega_0Z_{0e}}\\C_c=\left(\frac{1}{Z_{0o}}-\frac{1}{Z_{0e}}\right)\frac{\tan(\theta/2)}{2\omega_0}</script><p>Define two coupling coefficient as</p><script type="math/tex; mode=display">k_L=\frac{M}{L}=\frac{Z_{0e}-Z_{0o}}{Z_{0e}+Z_{0o}}\\k_C=\frac{C_c}{C_c+C_g}=\frac{C_c}{C}</script><p>Then, the even and odd mode characteristic and velocity can be written as</p><script type="math/tex; mode=display">Z_{0e}=\sqrt{\frac{L(1+k_L)}{C(1-k_C)}}\\v_e=\frac{1}{\sqrt{L(1+k_L)C(1-k_C)}}\\Z_{0o}=\sqrt{\frac{L(1-k_L)}{C(1+k_C)}}\\v_o=\frac{1}{\sqrt{L(1-k_L)C(1+k_C)}}\\Z_0=\sqrt{Z_{0o}Z_{0e}}</script><p>For the desired transverse electromagnetic mode (TEM) propagation, the even-mode and odd-mode propagation velocities should equal to avoid dispersions. Therefore, we have $k_L=k_C$.</p><p>For a specified power division, the calculation process is as follows:</p><ol><li>From $k=\sqrt{10^{C/10}}$ and $k_L=k_C$, the coupling coefficients are determined. Note that $C$ denotes the coupled power to input power ratio in decibel.</li><li>From $Z_0=\sqrt{Z_{0o}Z_{0e}}$ and $k_L=(Z_{0e}-Z_{0o})/(Z_{0e}+Z_{0o})$, the even and odd mode characteristic impedances are determined.</li><li>Setting $\theta=\pi/2$ and from the equations, the component values are determined.</li></ol><p>For instance, if we want 3-dB power division, then $k\approx0.707$. At 28 GHz, the schematic is</p><p><img src="lumped-element-circuit/schematic-of-a-lumped-element-coupler.png" alt="Schematic of a lumped element coupler"></p><p>And the simulated results is</p><p><img src="lumped-element-circuit/simulated-result-of-the-lumped-element-coupler.png" alt="Simulated result of the lumped element coupler"></p><p>A example of the layout of the lumped-element coupler is as follows:</p><p><img src="lumped-element-circuit/lumped-element-coupler.png" alt="Lumped-element coupler"></p><h2 id="Balun"><a href="#Balun" class="headerlink" title="Balun"></a>Balun</h2><h3 id="Lattice-type-LC-balun"><a href="#Lattice-type-LC-balun" class="headerlink" title="Lattice-type LC balun"></a>Lattice-type LC balun</h3><p>Schematic of the lattice-type LC balun is</p><p><img src="lumped-element-circuit/img.gif" alt="Lattice-type LC balun"></p><p>This circuit transforms the balanced input into an unbalanced output by shifting the phase of one input port by +90° and the second input port by −90° and vice versa. To act like a balun, it must have $T_e=0$, which translates to</p><script type="math/tex; mode=display">\omega_0=\frac{1}{\sqrt{LC}}</script><p>In that case, we have $Y_e=0$. It is required, therefore, $Y_{odd}=2Y_{in}=2Y_1$. To calculate $Y_o$, we resort to the a differential load, with impedance of $Y_{out}=2R_L$. It can be proved that the input impedance $Z_{odd}$ is</p><script type="math/tex; mode=display">Z_{odd}=\frac{1}{2R_L}\frac{L}{C}=\frac{R_1}{2}</script><p>Both equations lead to</p><script type="math/tex; mode=display">L=\frac{\sqrt{R_1R_L}}{\omega_0}\\C=\frac{1}{\omega_0\sqrt{R_1R_L}}</script><h2 id="Wilkinson-Power-Divider"><a href="#Wilkinson-Power-Divider" class="headerlink" title="Wilkinson Power Divider"></a>Wilkinson Power Divider</h2><h3 id="Single-ended"><a href="#Single-ended" class="headerlink" title="Single-ended"></a>Single-ended</h3><p>Wilkinson power divider is comprised of two $\lambda/4$ transmission lines with $Z_C=\sqrt{2}R$, and a resistor of $2R$ connecting the split terminals. Two transmission lines can be realized using equivalent-π representation, where the two capacitors at one side can be combined.</p><p><img src="lumped-element-circuit/lumped-wilkinson-power-divider.png" alt="Lumped Wilkinson power divider"></p><p>where we have</p><script type="math/tex; mode=display">L=\frac{\sqrt{2}R}{\omega_0}\\C=\frac{1}{\sqrt{2}\omega_0R}</script><p>The same method can be applied to design multi-section Wilkinson power divider to further extend the bandwidth.</p><h3 id="Differential"><a href="#Differential" class="headerlink" title="Differential"></a>Differential</h3><p>The schematic and the layout of a differential inductor is as follows</p><p><img src="lumped-element-circuit/differential-inductor.png" alt="Differential inductor"></p><p>Note that in this design, the mutual inductance is negative if the positive terminals are assumed to locate at the left side. Therefore, if driven differentially, the mutual inductance add to the self-inductance, creating an equivalent inductance $L(1+k)$ for both sides. For the common excitation, however, the equivalent inductance is mitigated to be $L(1-k)$.</p><p>The knowledge of mutual inductance can be used to guide the design of the differential Wilkinson power divider. The schematic is show below.</p><p><img src="lumped-element-circuit/differential-wilkinson-power-divider.png" alt="Differential Wilkinson power divider"></p><p>The differential inductor is adopted to provide higher inductance while ensuring compact layout. If the source and load impedance are both $R$, half circuit seen an impedance of $R/2$. Thus, the resistance needed to implement isolation is twice that of the half-circuit characteristic impedance, and is $R$ again. $\lambda/4$ transmission line is realized with differential inductor and the capacitors, with a characteristic impedance of $R/\sqrt{2}$.</p><h2 id="Attenuator"><a href="#Attenuator" class="headerlink" title="Attenuator"></a>Attenuator</h2><h3 id="π-Circuit"><a href="#π-Circuit" class="headerlink" title="π Circuit"></a>π Circuit</h3><p><img src="lumped-element-circuit/pi-circuit-attenuator.png" alt="Pi circuit attenuator"></p><p>Design equations are</p><script type="math/tex; mode=display">\begin{aligned}R_3 &= \frac{1}{2} (10^{L/10}-1)\sqrt{\frac{Z_{in}Z_{out}}{10^{L/10}}} \\R_2 &= \frac{1}{\frac{10^{L/10}+1}{Z_{out}(10^{L/10}-1)} - \frac{1}{R_3}} \\R_1 &= \frac{1}{\frac{10^{L/10}+1}{Z_{in}(10^{L/10}-1)} - \frac{1}{R_3}}\end{aligned}</script><p>where the minimal loss that can be achieved is</p><script type="math/tex; mode=display">L_{min}=20\log\left(\sqrt{\frac{Z_{in}}{Z_{out}}}+\sqrt{\frac{Z_{in}}{Z_{out}}-1}\right)</script><h3 id="T-Circuit"><a href="#T-Circuit" class="headerlink" title="T Circuit"></a>T Circuit</h3><p><img src="lumped-element-circuit/t-circuit-attenuator.png" alt="T-circuit attenuator"></p><p>Design equations are</p><script type="math/tex; mode=display">\begin{aligned}R_3 &= \frac{2\sqrt{Z_{in}Z_{out}10^{L/10}}}{10^{L/10}-1} \\R_2 &= \frac{10^{L/10}+1}{10^{L/10}-1}Z_{out} - R_3 \\R_1 &= \frac{10^{L/10}+1}{10^{L/10}-1}Z_{in} - R_3\end{aligned}</script><p>where the minimal loss that can be achieved is</p><script type="math/tex; mode=display">L_{min}=20\log\left(\sqrt{\frac{Z_{in}}{Z_{out}}}+\sqrt{\frac{Z_{in}}{Z_{out}}-1}\right)</script><h3 id="Bridge-T-Circuit"><a href="#Bridge-T-Circuit" class="headerlink" title="Bridge T Circuit"></a>Bridge T Circuit</h3><p><img src="lumped-element-circuit/bridge-t-attenuator.png" alt="Bridge-T attenuator"></p><p>Design equations are</p><script type="math/tex; mode=display">\begin{aligned}R_1 &= Z_0(10^{L/20}-1) \\R_4 &= \frac{Z_0}{10^{L/20}-1}\end{aligned}</script><h2 id="Quadrature-Generation"><a href="#Quadrature-Generation" class="headerlink" title="Quadrature Generation"></a>Quadrature Generation</h2><h3 id="Direct"><a href="#Direct" class="headerlink" title="Direct"></a>Direct</h3><p><img src="lumped-element-circuit/direct-quadrature-generation.png" alt="Direct quadrature generation"></p><p>It should satisfy</p><script type="math/tex; mode=display">Z_2=(j\omega L)||(\frac{1}{j\omega C_1})||(50\ \Omega)\\Z_3=(\frac{1}{j\omega C_2})||(50\ \Omega)\\</script><p>Since $Z_2+Z_3=50 \Omega$, and we need a 90° phase difference</p><script type="math/tex; mode=display">\frac{Z_2}{Z_3}=\frac{25+j25}{25-j25}</script><p>A high coupling transformer can be used to isolate port 2 from port 3. </p><p>For a differential implementation</p><p><img src="lumped-element-circuit/direct-differential-quadrature-generation.png" alt="Direct differential quadrature generation"></p><p>Capacitors can be combined, as</p><p><img src="lumped-element-circuit/simplified-direct-differential-quadrature-generation.png" alt="Simplified direct differential quadrature generation"></p><p>Layout of the above circuit is</p><p><img src="lumped-element-circuit/loose-layout-of-the-direct-quadrature-generation.png" alt="Loose layout of the direct quadrature generation"></p><p>When the right half is rotated</p><p><img src="lumped-element-circuit/coil-rotation.png" alt="Coil rotation"></p><p>It can be combined with the left coil for area reduction</p><p><img src="lumped-element-circuit/compact-layout-of-the-direct-quadrature-generation.png" alt="Compact layout of the direct quadrature generation"></p><p>This layout can be further rotated to facilitate port connection</p><p><img src="lumped-element-circuit/rotated-compact-layout-of-the-direct-quadrature-generation.png" alt="Rotated compact layout of the direct quadrature generation"></p><h3 id="Hybrid"><a href="#Hybrid" class="headerlink" title="Hybrid"></a>Hybrid</h3><p>The schematic is given below</p><p><img src="lumped-element-circuit/transformer-based-hybrid.png" alt="Transformer-based hybrid"></p><p>Layout is as follows</p><p><img src="lumped-element-circuit/hybrid.png" alt="Hybrid"></p><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><h3 id="Derivation-of-π-circuit-attenuator"><a href="#Derivation-of-π-circuit-attenuator" class="headerlink" title="Derivation of π-circuit attenuator"></a>Derivation of π-circuit attenuator</h3><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Parallel[x_, y_] := x y/(x + y);</span><br><span class="line"><span class="comment">(* Both ports are matched *)</span></span><br><span class="line">result = <span class="keyword">Solve</span>[&#123;Zin == <span class="keyword">Simplify</span>[Parallel[R1, Parallel[Zout, R2] + R3]],</span><br><span class="line">   Zout == Parallel[R2, Parallel[Zin, R1] + R3]&#125;, &#123;R1, R2&#125;]</span><br><span class="line"><span class="comment">(* Specify the insertion loss *)</span></span><br><span class="line">T = Parallel[Zout, R2];</span><br><span class="line">Ul = Uin/<span class="number">2</span> T/(T + R3);</span><br><span class="line">result2 = <span class="keyword">Solve</span>[A == <span class="number">4</span> Zin/Zout (Ul/Uin)^<span class="number">2</span> /. result[[<span class="number">2</span>]], &#123;R3&#125;]</span><br><span class="line"><span class="comment">(* Obtaining R3 *)</span></span><br><span class="line"><span class="keyword">Simplify</span>[R3 /. result2[[<span class="number">1</span>]] /. A -&gt; <span class="number">10</span>^(L/<span class="number">10</span>)]</span><br><span class="line"><span class="comment">(* Obtaining R2 *)</span></span><br><span class="line"><span class="keyword">Simplify</span>[<span class="number">1</span>/(R2) /. result[[<span class="number">2</span>]], &#123;Zin &gt; <span class="number">0</span>, Zout &gt; <span class="number">0</span>, R3 &gt; <span class="number">0</span>&#125;]</span><br></pre></td></tr></table></figure><p>Here we have</p><script type="math/tex; mode=display">\frac{1}{R_2}=\frac{R_{3}^2+Z_{in} Z_{out}-Z_{out}^2}{R_{3} Z_{out}^2+R_{3} Z_{out} \sqrt{R_{3}^2+Z_{in} Z_{out}}}</script><p>If we define $A=10^{L/10}$, it is apparent that</p><script type="math/tex; mode=display">R_3^2+Z_{in}Z_{out}=R_3^2\frac{(A+1)^2}{(A-1)^2}</script><p>Substitute the equation into the expression, we have</p><script type="math/tex; mode=display">\frac{1}{R_2}=\frac{1}{R_3Z_{out}}\frac{(R_3\frac{A+1}{A-1}+Z_{out})(R_3\frac{A+1}{A-1}-Z_{out})}{R_3\frac{A+1}{A-1}+Z_{out}}\\=\frac{A+1}{Z_{out}(A-1)} - \frac{1}{R_3}</script><p>which is equivalent to the expression in the article. The same could be done for the $R_3$.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>For a inspiring discussion of various lumped-element circuit, refer to</p><ul><li>T. H. Lee, <em>Planar Microwave Engineering</em>.</li><li>P. Vizmuller, <em>RF Design Guide - Systems, Circuits, and Equations</em>.</li></ul><p>For the transformation of <strong>coupled transmission line</strong>, refer to</p><ul><li><p>J. Hogerheiden, M. Ciminera and G. Jue, &quot;Improved planar spiral transformer theory applied to a miniature lumped element quadrature hybrid,&quot; <em>IEEE Trans. Microw. Theory Techn.</em>, vol. 45, no. 4, pp. 543-545, April 1997, doi: <a href="https://doi.org/10.1109/22.566635" target="_blank" rel="noopener">10.1109/22.566635</a>.</p></li><li><p>R. Garg and A. S. Natarajan, &quot;A 28-GHz low-power phased-array receiver front-end with 360° RTPS phase shift range,&quot; <em>IEEE Trans. Microw. Theory Techn.</em>, vol. 65, no. 11, pp. 4703-4714, Nov. 2017, doi: <a href="https://doi.org/10.1109/TMTT.2017.2707414" target="_blank" rel="noopener">10.1109/TMTT.2017.2707414</a>.</p></li></ul><p>For the design of the <strong>lattice balun</strong>, refer to</p><ul><li>W. Bakalski, W. Simburger, H. Knapp, H. -D. Wohlmuth and A. L. Scholtz, &quot;Lumped and distributed lattice-type LC-baluns,&quot; <em>2002 IEEE MTT-S Int. Microw. Symp. Digest</em>, Seattle, WA, USA, 2002, pp. 209-212 vol.1, doi: <a href="https://doi.org/10.1109/MWSYM.2002.1011595" target="_blank" rel="noopener">10.1109/MWSYM.2002.1011595</a>.</li></ul><p>For more details about single-ended and differential <strong>Wilkinson power divider</strong>, refer to</p><ul><li>M. Balducci and H. Schumacher, &quot;Ka band passive differential 4:1 power divider/combiner based on Wilkinson topology,&quot; <em>2017 13th Conference on Ph.D. Research in Microelectronics and Electronics (PRIME)</em>, Giardini Naxos, 2017, pp. 189-192.</li></ul><p>For more information about <strong>quadrature signal generation</strong>, refer to</p><ul><li>J. S. Park, S. Kousai and H. Wang, &quot;A fully differential ultra-compact broadband transformer based quadrature generation scheme,&quot; <em>Proc. Custom Integr. Circuits Conf.</em>, San Jose, CA, 2013, pp. 1-4, doi: <a href="https://doi.org/10.1109/CICC.2013.6658546" target="_blank" rel="noopener">10.1109/CICC.2013.6658546</a>.</li><li>J. S. Park and H. Wang, &quot;A transformer-based poly-phase network for ultra-broadband quadrature signal generation,&quot; <em>IEEE Trans. Microw. Theory and Techn.</em>, vol. 63, no. 12, pp. 4444-4457, Dec. 2015, doi: <a href="https://doi.org/10.1109/TMTT.2015.2496187" target="_blank" rel="noopener">10.1109/TMTT.2015.2496187</a>.</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Even and Odd Mode Analysis</title>
      <link href="/archives/c3975ee1/even-odd-mode-analysis.html"/>
      <url>/archives/c3975ee1/even-odd-mode-analysis.html</url>
      
        <content type="html"><![CDATA[<p>Analysis in this section will derive S parameters directly.</p><a id="more"></a><h2 id="Wilkinson-Power-Divider"><a href="#Wilkinson-Power-Divider" class="headerlink" title="Wilkinson Power Divider"></a>Wilkinson Power Divider</h2><p><img src="even-odd-mode-analysis/wilkinson-power-divider.png" alt="Wilkinson power divider"></p><p>It can be normalized as</p><p><img src="even-odd-mode-analysis/normalized-wilkinson-power-divider.png" alt="Normalized Wilkinson power divider"></p><p>It is assumed that for even mode $V_{g2}=V_{g3}=2V_0$, and for odd mode $V_{g2}=-V_{g3}=2V_0$.</p><p>Apply even and odd mode analysis, where $Z=\sqrt{2},r=2$</p><p><img src="even-odd-mode-analysis/even-odd-mode-analysis-of-wpd.png" alt="Even-odd mode analysis of WPD"></p><p>For the <strong>even</strong> mode, the node 2 is matched, so $V_{2}^e=V_0$. By establishing transmission line equation, we have</p><script type="math/tex; mode=display">\begin{aligned}V_1^e&=V(-\lambda/4)=jV^+(1-\Gamma)=V_0\\V_2^e&=V(0)=V^+(1+\Gamma)=jV_0\frac{\Gamma+1}{\Gamma-1}\\\Gamma&=\frac{2-\sqrt{2}}{2+\sqrt{2}}\\V_1^e&=-jV_0\sqrt{2}\end{aligned}</script><p>For the <strong>odd</strong> mode, the impedance seen to the left of the port 2 is 1, and the power is dissipated at the resistor. We have $V_1^o=0,V_2^o=V_0$.</p><script type="math/tex; mode=display">\begin{aligned}S_{11}&=0 &&Z_{in}=1\\S_{22}&=S_{33}=0 &&\text{ports 2-3 matched}\\S_{12}&=S_{21}=\frac{V_1^e+V_1^o}{V_2^e+V_2^o}=-j/\sqrt{2} &&\text{symmetry due to reciprocity}\\S_{13}&=S_{13}=-j/\sqrt{2} &&\text{symmetry of port 2-3}\\S_{23}&=S_{32}=0 &&\text{short or open at bisection}\\\end{aligned}</script><h2 id="Quadrature-90◦-Hybrid"><a href="#Quadrature-90◦-Hybrid" class="headerlink" title="Quadrature (90◦) Hybrid"></a>Quadrature (90◦) Hybrid</h2><p><img src="even-odd-mode-analysis/quadrature-hybrid.png" alt="Quadrature hybrid"></p><p>S parameter is</p><script type="math/tex; mode=display">\mathbf{S}=\frac{-1}{\sqrt{2}}\left[\begin{matrix}{0} & {j} & {1} & {0} \\{j} & {0} & {0} & {1} \\{1} & {0} & {0} & {j} \\{0} & {1} & {j} & {0}\end{matrix}\right]</script><p>Calculation is detailed as follows. It can be normalized as</p><p><img src="even-odd-mode-analysis/normalized-schematic-of-the-quadrature-hybrid.png" alt="Normalized schematic of the quadrature hybrid"></p><p>Apply even and odd mode analysis</p><p><img src="even-odd-mode-analysis/even-odd-mode-analysis-of-the-hybrid.png" alt="Even-odd mode analysis of the hybrid"></p><p>For the <strong>even</strong> mode, we have</p><script type="math/tex; mode=display">\left[\begin{matrix}A & B \\C & D\end{matrix}\right]_e=\left[\begin{matrix}1 & 0 \\j & 1\end{matrix}\right]\left[\begin{matrix}0 & j/\sqrt{2} \\j\sqrt{2} & 0\end{matrix}\right]\left[\begin{matrix}1 & 0 \\j & 1\end{matrix}\right]=\frac{1}{\sqrt{2}}\left[\begin{matrix}-1 & j \\j & -1\end{matrix}\right]</script><p>and thus</p><script type="math/tex; mode=display">\begin{aligned}\Gamma_e&=\frac{A+B-C-D}{A+B+C+D}=0\\T_e&=\frac{2}{A+B+C+D}=\frac{1}{\sqrt{2}}(-1-j)\end{aligned}</script><p>For the <strong>odd</strong> mode, we have</p><script type="math/tex; mode=display">\left[\begin{matrix}A & B \\C & D\end{matrix}\right]_o=\left[\begin{matrix}1 & 0 \\-j & 1\end{matrix}\right]\left[\begin{matrix}0 & j/\sqrt{2} \\j\sqrt{2} & 0\end{matrix}\right]\left[\begin{matrix}1 & 0 \\-j & 1\end{matrix}\right]=\frac{1}{\sqrt{2}}\left[\begin{matrix}1 & j \\j & 1\end{matrix}\right]</script><p>and thus</p><script type="math/tex; mode=display">\begin{aligned}\Gamma_o&=\frac{A+B-C-D}{A+B+C+D}=0\\T_o&=\frac{2}{A+B+C+D}=\frac{1}{\sqrt{2}}(1-j)\end{aligned}</script><p>Suppose a unit wave of $A_1=1$ presents at port 1, it can be decomposed as $A_o=1/2, A_e=1/2$, and thus</p><script type="math/tex; mode=display">\begin{aligned}B_1&=\frac{1}{2}\Gamma_e+\frac{1}{2}\Gamma_o=0\\B_2&=\frac{1}{2}T_e+\frac{1}{2}T_o=-\frac{j}{\sqrt{2}}\\B_3&=\frac{1}{2}T_e-\frac{1}{2}T_o=-\frac{1}{\sqrt{2}}\\B_4&=\frac{1}{2}\Gamma_e-\frac{1}{2}\Gamma_o=0\end{aligned}</script><p>Other ports can be calculated similarly.</p><h2 id="Coupled-Line-Coupler"><a href="#Coupled-Line-Coupler" class="headerlink" title="Coupled Line Coupler"></a>Coupled Line Coupler</h2><p><img src="even-odd-mode-analysis/coupled-line-coupler.png" alt="Coupled line coupler"></p><script type="math/tex; mode=display">\mathbf{S}=\left[\begin{matrix}{0} & {-j\sqrt{1-C^2}} & {C} & {0} \\{-j\sqrt{1-C^2}} & {0} & {0} & {C} \\{C} & {0} & {0} & {-j\sqrt{1-C^2}} \\{0} & {C} & {-j\sqrt{1-C^2}} & {0}\end{matrix}\right]</script><p>Its equivalent even-odd mode circuit is</p><p><img src="even-odd-mode-analysis/even-odd-mode-analysis-of-the-coupler.png" alt="Even-odd mode analysis of the coupler"></p><p>It can be observed that</p><script type="math/tex; mode=display">\begin{aligned}V_1^o &= V_0\frac{Z_{in}^o}{Z_{in}^o+Z_0}\\V_1^e &= V_0\frac{Z_{in}^e}{Z_{in}^e+Z_0}\\I_1^o &= \frac{V_0}{Z_{in}^o+Z_0}\\I_1^e &= \frac{V_0}{Z_{in}^e+Z_0}\\Z_{in} &= \frac{V_1^o+V_1^e}{I_1^o+I_1^e}\\    &= Z_0+\frac{2(Z_{in}^oZ_{in}^e-Z_0^2)}{Z_{in}^o+Z_{in}^e+2Z_0}\end{aligned}</script><p>If we further assume that $Z_0=\sqrt{Z_{0o}Z_{0e}}$, the input impedance is</p><script type="math/tex; mode=display">\begin{aligned}Z_{in}^o &= Z_{0o}\frac{Z_0+jZ_{0o}\tan\theta}{Z_{0o}+jZ_0\tan\theta}\\    &=Z_{0o}\frac{\sqrt{Z_{0e}}+j\sqrt{Z_{0o}}\tan\theta}{\sqrt{Z_{0o}}+j\sqrt{Z_{0e}}\tan\theta}\\Z_{in}^e &= Z_{0e}\frac{Z_0+jZ_{0e}\tan\theta}{Z_{0e}+jZ_0\tan\theta}\\    &=Z_{0e}\frac{\sqrt{Z_{0o}}+j\sqrt{Z_{0e}}\tan\theta}{\sqrt{Z_{0e}}+j\sqrt{Z_{0o}}\tan\theta}\\\end{aligned}</script><p>It follows that $Z_{in}^eZ_{in}^o=Z_{0e}Z_{0o}=Z_0^2$, and $Z_{in}=Z_0$. Hence, all ports will be matched. Voltage at the ports can be written as</p><script type="math/tex; mode=display">\begin{aligned}V_3 &=V_1^e-V_1^o\\&= V_0\frac{j(Z_{0e}-Z_{0o})\tan{\theta}}{2Z_0+j(Z_{0e}+Z_{0o})\tan{\theta}}\\\end{aligned}</script><p>Assume that</p><script type="math/tex; mode=display">C=\frac{Z_{0e}-Z_{0o}}{Z_{0e}+Z_{0o}}</script><p>Several inferences are</p><script type="math/tex; mode=display">\sqrt{1-C^2}=2Z_0/(Z_{0e}+Z_{0o})\\Z_{0e}=Z_0\sqrt{\frac{1+C}{1-C}}\\Z_{0o}=Z_0\sqrt{\frac{1-C}{1+C}}</script><p>With these annotation, we may rewrite $V_3$ as</p><script type="math/tex; mode=display">V_3=V_0\frac{jC\tan\theta}{\sqrt{1-C^2}+j\tan\theta}</script><p>$V_2, V_4$ are derived as follow.</p><script type="math/tex; mode=display">\Gamma_e=\frac{Z_0-Z_{0e}}{Z_0+Z_{0e}}\\\Gamma_o=\frac{Z_0-Z_{0o}}{Z_0+Z_{0o}}\\V_2^e=V_1^e\frac{1+\Gamma_e}{e^{j\theta}+\Gamma_e e^{-j\theta}}\\V_2^o=V_1^e\frac{1+\Gamma_o}{e^{j\theta}+\Gamma_o e^{-j\theta}}</script><p>Those equations lead to</p><script type="math/tex; mode=display">V_2=V_2^e+V_2^o=V_0\frac{\sqrt{1-C^2}}{\sqrt{1-C^2}\cos\theta+j\sin\theta}\\V_4=V_2^e-V_2^o=0</script><p>These results can be used to derive the S parameter. If the electrical length is $\pi/4$, we may write the S parameter as in the beginning.</p><h3 id="Termination"><a href="#Termination" class="headerlink" title="Termination"></a>Termination</h3><p><img src="even-odd-mode-analysis/RTPS.png" alt="Signal graph of the coupler"></p><p>Thus, we may write</p><script type="math/tex; mode=display">\begin{aligned}S_{11,new} &= S_{21}S_{12}\Gamma_2+S_{31}S_{13}\Gamma_3\\    &=C^2\Gamma_3-(1-C^2)\Gamma_2\\S_{41,new} &= S_{42}S_{21}\Gamma_2+S_{43}S_{31}\Gamma_3\\    &=-jC\sqrt{1-C^2}(\Gamma_2+\Gamma_3)\end{aligned}</script><p>In the case that $C=\sqrt{2}/2, \Gamma_3=-\Gamma_2=1$, we have $S_{11,new}=1,S_{41,new}=0$. Thus, it constitute an all-stop filter, as having been derived using the network parameters. In the case that $C=\sqrt{2}/2,\Gamma_3=\Gamma_2=\Gamma$, we have $S_{11,new}=0,S_{41,new}=-j\Gamma$. This is the result that leads to the design of reflective-type attenuator and reflective-type phase shifter. Note that $\Gamma$ is defined as</p><script type="math/tex; mode=display">\Gamma=\frac{Z_L-Z_0}{Z_L+Z_0}</script><h2 id="Marchand-Balun"><a href="#Marchand-Balun" class="headerlink" title="Marchand Balun"></a>Marchand Balun</h2><h3 id="General-Balun"><a href="#General-Balun" class="headerlink" title="General Balun"></a>General Balun</h3><p><img src="even-odd-mode-analysis/general-balun.png" alt="General Balun"></p><p>It is assumed that the general balun has the following properties:</p><ul><li>Single-ended port is matched ($S_{11}=0$).</li><li>Differential ports are matched ($S_{22}=S_{23}=S_{32}=S_{33}$).</li><li>The power present at the common port is evenly divided between the two differential ports with opposite polarity ($S_{21}=(1/\sqrt{2})e^{-j\theta},S_{31}=-(1/\sqrt{2})e^{-j\theta}$).</li></ul><p>To illustrate the second point, the following schematic is adopted.</p><p><img src="even-odd-mode-analysis/s-parameter-of-the-general-balun.png" alt="S parameter of the general Balun"></p><p>For differential excitation at the left side, we have $a_2=-a_3, b_2=b_3=0$. It follows that</p><script type="math/tex; mode=display">0=b_2=S_{21}a_1+S_{22}a_2+S_{23}a_3=(S_{22}-S_{23})a_2</script><p>The relation between the source and the load reflection coefficients are</p><script type="math/tex; mode=display">\Gamma_S=\frac{b_2}{a_2}=\frac{S_{12}a_1}{b_1/2S_{12}}=\Gamma_Le^{-2j\theta}</script><p>If $\theta=0/\pi$, we have $Z_S=(Z_{S0}/Z_{L0})Z_L$, which features an impedance scaling balun; if $\theta=\pm\pi/2$, we have $Z_S=(Z_{L0}/Z_{S0})(1/Z_L)$, which demonstrates an impedance inverting balun.</p><h3 id="Requirement-of-Balun"><a href="#Requirement-of-Balun" class="headerlink" title="Requirement of Balun"></a>Requirement of Balun</h3><p>A variety of three-port balun, when adding an “invisible port 4,” are inherently symmetrical structures. The following structure is considered for analysis.</p><p><img src="even-odd-mode-analysis/balun-analysis-with-virtual-port-4.gif" alt="Balun analysis with virtual port 4"></p><p>When the differential and common excitation is applied.</p><p><img src="even-odd-mode-analysis/parameter-definition.png" alt="Parameter definition"></p><p>The mixed-mode S parameter can be obtained as</p><script type="math/tex; mode=display">\mathbf{S^{mm}}=\left[\begin{matrix}{\Gamma_{o1}} & {T_{o2}} & {0} & {0} \\{T_{o1}} & {\Gamma_{o2}} & {0} & {0} \\{0} & {0} & {\Gamma_{e1}} & {T_{e2}} \\{0} & {0} & {T_{e1}} & {\Gamma_{e2}}\end{matrix}\right]</script><p>It can be converted to the standard S parameter as</p><script type="math/tex; mode=display">\mathbf{S^{std}}=\frac{1}{2}\left[\begin{matrix}{\Gamma_{e1}+\Gamma_{o1}} & {\Gamma_{e1}-\Gamma_{o1}} & {T_{e2}+T_{o2}} & {T_{e2}-T_{o2}} \\{\Gamma_{e1}-\Gamma_{o1}} & {\Gamma_{e1}+\Gamma_{o1}} & {T_{e2}-T_{o2}} & {T_{e2}+T_{o2}} \\{T_{e2}+T_{o2}} & {T_{e2}-T_{o2}} & {\Gamma_{e2}+\Gamma_{o2}} & {\Gamma_{e2}-\Gamma_{o2}} \\{T_{e2}-T_{o2}} & {T_{e2}+T_{o2}} & {\Gamma_{e2}-\Gamma_{o2}} & {\Gamma_{e2}+\Gamma_{o2}}\end{matrix}\right]</script><p>Using Mason&#39;s formula, the 3-port S parameter with port 2 terminated with $\Gamma$ is</p><script type="math/tex; mode=display">S_{21,new}=S_{31}+\frac{S_{32} S_{21} \Gamma}{1-S_{22}\Gamma}\\S_{31,new}=S_{41}+\frac{S_{42} S_{21} \Gamma}{1-S_{22}\Gamma}</script><p>It must satisfy</p><script type="math/tex; mode=display">S_{21, new}=-S_{31, new}\\S_{11,new}=0</script><p>which lead us to</p><script type="math/tex; mode=display">\frac{T_{e1}(1-\Gamma_{o1}\Gamma)}{2-\Gamma(\Gamma_{e1}+\Gamma_{o1})}=0\\\frac{\Gamma_{e1}+\Gamma_{o1}-2\Gamma_{e1}\Gamma_{o1}\Gamma}{2-\Gamma(\Gamma_{e1}+\Gamma_{o1})} = 0</script><p>Using the following even and odd mode definition, we have</p><p><img src="even-odd-mode-analysis/even-mode-circuit.gif" alt="Even mode circuit"></p><p><img src="even-odd-mode-analysis/odd-mode-circuit.gif" alt="Odd mode circuit"></p><p>The reflection coefficient is</p><script type="math/tex; mode=display">\Gamma_{e1}=\frac{Z_e-Z_{in}}{Z_e+Z_{in}}=\frac{Y_{in}-Y_e}{Y_{in}+Y_e}\\\Gamma_{o1}=\frac{Z_o-Z_{in}}{Z_o+Z_{in}}=\frac{Y_{in}-Y_o}{Y_{in}+Y_o}</script><p>It can be used to solve for the requirement of balun, as</p><script type="math/tex; mode=display">\begin{aligned}T_{even}=0&\\Y_{even}+Y_{odd}=2Y_{in}&,\ \Gamma=-1\quad(\mathrm{short})\\\frac{1}{Y_{even}}+\frac{1}{Y_{odd}}=\frac{2}{Y_{in}}&,\ \Gamma=1\quad(\mathrm{open})\end{aligned}</script><h3 id="Marchand-Balun-Formulation"><a href="#Marchand-Balun-Formulation" class="headerlink" title="Marchand Balun Formulation"></a>Marchand Balun Formulation</h3><p>To prove that Marchand balun is indeed a balun</p><p><img src="even-odd-mode-analysis/proof-of-marchand-balun.png" alt="Proof of Marchand balun"></p><p>we need to add a virtual port to facilitate decomposing into even-mode and odd-mode circuits. Note that for the even-mode circuit, the coupled line with short and open termination features an all-stop filter, so that the requirement $T_e=0$ is indeed satisfied. </p><p><img src="even-odd-mode-analysis/calculation-of-the-marchand-balun-y-parameter.png" alt="Calculation of the Marchand balun Y parameter"></p><p>which leads to</p><script type="math/tex; mode=display">\left[\begin{matrix}I_{pa}\\I_a\\I_b\end{matrix}\right]=\left[\begin{matrix}{-jY_p\cot(\theta)} & {jY_m\csc(\theta)/2} & {-jY_m\csc(\theta)/2} \\{jY_m\csc(\theta)} & {-jY_p\cot(2\theta)} & {jY_p\csc(2\theta)} \\{-jY_m\csc(\theta)} & {jY_p\csc(2\theta)} & {-jY_p\cot(2\theta)} \end{matrix}\right]\left[\begin{matrix}V_{pa}\\V_a\\V_b\end{matrix}\right]</script><p>where  $Y_p=(Y_{0o}+Y_{0e})/2,Y_m=(Y_{0o}-Y_{0e})/2, Y_{0e}=1/Z_{0e}, Y_{0o}=1/Z_{0o}$.</p><p>Since $V_b=0$, the third row and the third column can be eliminated. It follows that</p><script type="math/tex; mode=display">\left[\begin{matrix}I_{pa}\\I_L\\\end{matrix}\right]=\left[\begin{matrix}{-jY_p\cot(\theta)} & {jY_m\csc(\theta)/2}  \\{jY_m\csc(\theta)} & {-jY_p\cot(2\theta)} \end{matrix}\right]\left[\begin{matrix}V_{pa}\\V_L\\\end{matrix}\right]</script><h3 id="Impedance-Inverting-Balun"><a href="#Impedance-Inverting-Balun" class="headerlink" title="Impedance Inverting Balun"></a>Impedance Inverting Balun</h3><p><img src="even-odd-mode-analysis/impedance-inverting-balun.png" alt="Impedance inverting balun"></p><p>A capacitor is therefore required to resonate out the parasitic inductance. At the PA side, a capacitor is required as</p><script type="math/tex; mode=display">Y_C=jY_p\cos(\theta)</script><p>which can absorb the parasitic capacitance of the PA output. As for the reactance at the load side</p><script type="math/tex; mode=display">Y_{C_{Shunt}/L_{Shunt}}=jY_p\cos(2\theta)</script><p>In that case, the input impedance is</p><script type="math/tex; mode=display">\left[\begin{matrix}I_{pa}\\I_L\\\end{matrix}\right]=\left[\begin{matrix}{0} & {jY_m\csc(\theta)/2}  \\{jY_m\csc(\theta)} & {0} \end{matrix}\right]\left[\begin{matrix}V_{pa}\\V_L\\\end{matrix}\right]</script><p>and the input impedance is</p><script type="math/tex; mode=display">Z_{pa}=\frac{1}{Z_L}\left(\frac{\sqrt{2}}{Y_m\csc(\theta)}\right)^2</script><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><p>Mathematica derivation of Y parameter of the Marchand balun</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* This is the Y parameter of the coupled transmission line *)</span></span><br><span class="line">Y = &#123;&#123;-I Yp <span class="keyword">Cot</span>[t], I Ym <span class="keyword">Cot</span>[t], -I Ym <span class="keyword">Csc</span>[t], </span><br><span class="line">    I Yp <span class="keyword">Csc</span>[t]&#125;, &#123;I Ym <span class="keyword">Cot</span>[t], -I Yp <span class="keyword">Cot</span>[t], </span><br><span class="line">    I Yp <span class="keyword">Csc</span>[t], -I Ym <span class="keyword">Csc</span>[t]&#125;, &#123;-I Ym <span class="keyword">Csc</span>[t], </span><br><span class="line">    I Yp <span class="keyword">Csc</span>[t], -I Yp <span class="keyword">Cot</span>[t], </span><br><span class="line">    I Ym <span class="keyword">Cot</span>[t]&#125;, &#123;I Yp <span class="keyword">Csc</span>[t], -I Ym <span class="keyword">Csc</span>[t], </span><br><span class="line">    I Ym <span class="keyword">Cot</span>[t], -I Yp <span class="keyword">Cot</span>[t]&#125;&#125;;</span><br><span class="line"><span class="comment">(* Set boundary conditions *)</span></span><br><span class="line">y1 = &#123;&#123;-Ipa&#125;, &#123;Ix&#125;, &#123;Ia&#125;, &#123;Ix1&#125;&#125;;</span><br><span class="line">x1 = &#123;&#123;-Vpa&#125;, &#123;Vx&#125;, &#123;Va&#125;, &#123;<span class="number">0</span>&#125;&#125;;</span><br><span class="line">y2 = &#123;&#123;Ipa&#125;, &#123;-Ix&#125;, &#123;Ib&#125;, &#123;Ix2&#125;&#125;;</span><br><span class="line">x2 = &#123;&#123;Vpa&#125;, &#123;Vx&#125;, &#123;Vb&#125;, &#123;<span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="comment">(* Eliminate unnecessary variables *)</span></span><br><span class="line">R = <span class="keyword">Eliminate</span>[&#123;y1 == Y.x1, y2 == Y.x2&#125;, &#123;Vx, Ix, Ix1, Ix2&#125;];</span><br><span class="line"><span class="keyword">Solve</span>[R, &#123;Ipa, Ia, Ib&#125;]</span><br></pre></td></tr></table></figure><p>Proof of the requirement of the balun</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* Conversion to the standard S parameter *)</span></span><br><span class="line">M = <span class="number">1</span>/<span class="keyword">Sqrt</span>[<span class="number">2</span>] (&#123;</span><br><span class="line">     &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">     &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;,</span><br><span class="line">     &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">     &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">Smm = (&#123;</span><br><span class="line">    &#123;Go1, To2, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;To1, Go2, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, Ge1, Te2&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, Te1, Ge2&#125;</span><br><span class="line">   &#125;);</span><br><span class="line">Snew = <span class="keyword">Simplify</span>[<span class="keyword">Inverse</span>[M].Smm.M];</span><br><span class="line"><span class="comment">(* Apply boundary conditions, and use Mason's formula to simplify it as 3-port S parameter *)</span></span><br><span class="line">S11 = Snew[[<span class="number">1</span>, <span class="number">1</span>]] + Snew[[<span class="number">1</span>, <span class="number">2</span>]] Snew[[<span class="number">2</span>, <span class="number">1</span>]] G/(<span class="number">1</span> - G Snew[[<span class="number">2</span>, <span class="number">2</span>]]);</span><br><span class="line">S21 = Snew[[<span class="number">3</span>, <span class="number">1</span>]] + Snew[[<span class="number">3</span>, <span class="number">2</span>]] Snew[[<span class="number">2</span>, <span class="number">1</span>]] G/(<span class="number">1</span> - G Snew[[<span class="number">2</span>, <span class="number">2</span>]]);</span><br><span class="line">S31 = Snew[[<span class="number">4</span>, <span class="number">1</span>]] + Snew[[<span class="number">4</span>, <span class="number">2</span>]] Snew[[<span class="number">2</span>, <span class="number">1</span>]] G/(<span class="number">1</span> - G Snew[[<span class="number">2</span>, <span class="number">2</span>]]);</span><br><span class="line"><span class="comment">(* Solve for the equivalent requirement of the balun *)</span></span><br><span class="line">R1 = <span class="keyword">Together</span>[S21 + S31];</span><br><span class="line">R2 = <span class="keyword">Together</span>[S11];</span><br><span class="line">rule = &#123;Ge1 -&gt; (Yin - Ye)/(Yin + Ye), Go1 -&gt; (Yin - Yo)/(Yin + Yo)&#125;;</span><br><span class="line"><span class="keyword">Reduce</span>[(R1 /. rule) == <span class="number">0</span> &amp;&amp; (R2 /. rule) == <span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>For the derivation of coupled transmission line, Wilkinson power divider, quadrature hybrid, and coupled line coupled, refer to</p><ul><li>D. M. Pozar, <em>Microwave Engineering</em>. NJ, Hoboken: Wiley, 1998.</li></ul><p>For the theoretical analysis of balun, refer to</p><ul><li>K. S. Ang, Y. C. Leong and C. H. Lee, &quot;Analysis and design of miniaturized lumped-distributed impedance-transforming baluns,&quot; <em>IEEE Trans. Microw. Theory Techn.</em>, vol. 51, no. 3, pp. 1009-1017, March 2003, doi: <a href="https://doi.org/10.1109/TMTT.2003.808677" target="_blank" rel="noopener">10.1109/TMTT.2003.808677</a>.</li><li>Y. C. Leong, K. S. Ang and C. H. Lee, &quot;A derivation of a class of 3-port baluns from symmetrical 4-port networks,&quot; <em>2002 IEEE MTT-S Int. Microw. Symp. Digest</em>, Seattle, WA, USA, 2002, pp. 1165-1168 vol.2, doi: <a href="https://doi.org/10.1109/MWSYM.2002.1011855" target="_blank" rel="noopener">10.1109/MWSYM.2002.1011855</a>.</li></ul><p>For the insightful analysis of coupled line balun, refer to</p><ul><li>H. T. Nguyen and H. Wang, &quot;A coupler-based differential mm-wave Doherty power amplifier with impedance inverting and scaling baluns,&quot; <em>IEEE J. Solid-State Circuits</em>, doi: <a href="https://doi.org/10.1109/JSSC.2020.2970708" target="_blank" rel="noopener">10.1109/JSSC.2020.2970708</a>.</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Network Parameters in Circuit Analysis</title>
      <link href="/archives/587faa75/network-parameter.html"/>
      <url>/archives/587faa75/network-parameter.html</url>
      
        <content type="html"><![CDATA[<p>This article presents S, Z, Y, ABCD parameters and their transformation.</p><a id="more"></a><h2 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h2><h3 id="Impedance-Parameter"><a href="#Impedance-Parameter" class="headerlink" title="Impedance Parameter"></a>Impedance Parameter</h3><script type="math/tex; mode=display">\left[\begin{matrix}V_1 \\ V_2\end{matrix}\right]=\left[\begin{matrix}Z_{11} & Z_{12} \\Z_{21} & Z_{22}\end{matrix}\right]\left[\begin{matrix}I_1 \\ I_2\end{matrix}\right]</script><h3 id="Admittance-Parameter"><a href="#Admittance-Parameter" class="headerlink" title="Admittance Parameter"></a>Admittance Parameter</h3><script type="math/tex; mode=display">\left[\begin{matrix}I_1 \\ I_2\end{matrix}\right]=\left[\begin{matrix}Y_{11} & Y_{12} \\Y_{21} & Y_{22}\end{matrix}\right]\left[\begin{matrix}V_1 \\ V_2\end{matrix}\right]</script><h3 id="ABCD-Parameter"><a href="#ABCD-Parameter" class="headerlink" title="ABCD Parameter"></a>ABCD Parameter</h3><p>Also called A Parameter or chain parameter. Note that for convenience of cascading, the definition of current at port 2 is opposite to others.</p><p><img src="network-parameter/port-definition-of-abcd-parameter.png" alt="Port definition of ABCD parameter"></p><script type="math/tex; mode=display">\left[\begin{matrix}V_1 \\ I_1\end{matrix}\right]=\left[\begin{matrix}A & B \\C & D\end{matrix}\right]\left[\begin{matrix}V_2 \\ I_2\end{matrix}\right]</script><h3 id="Hybrid-Parameter"><a href="#Hybrid-Parameter" class="headerlink" title="Hybrid Parameter"></a>Hybrid Parameter</h3><script type="math/tex; mode=display">\left[\begin{matrix}V_1 \\ I_2\end{matrix}\right]=\left[\begin{matrix}H_{11} & H_{12} \\H_{21} & H_{22}\end{matrix}\right]\left[\begin{matrix}I_1 \\ V_2\end{matrix}\right]</script><h3 id="G-Parameter"><a href="#G-Parameter" class="headerlink" title="G Parameter"></a>G Parameter</h3><script type="math/tex; mode=display">\left[\begin{matrix}I_1 \\ V_2\end{matrix}\right]=\left[\begin{matrix}G_{11} & G_{12} \\G_{21} & G_{22}\end{matrix}\right]\left[\begin{matrix}V_1 \\ I_2\end{matrix}\right]</script><h3 id="Scattering-Parameter"><a href="#Scattering-Parameter" class="headerlink" title="Scattering Parameter"></a>Scattering Parameter</h3><script type="math/tex; mode=display">\left[\begin{matrix}b_1 \\ b_2\end{matrix}\right]=\left[\begin{matrix}S_{11} & S_{12} \\S_{21} & S_{22}\end{matrix}\right]\left[\begin{matrix}a_1 \\ a_2\end{matrix}\right]</script><p>For S parameter</p><script type="math/tex; mode=display">V=V^++V^-\\I=I^+-I^-=\frac{1}{Z_0}(V^+-V^-)</script><p>Normalized incident and reflective waves are</p><script type="math/tex; mode=display">a=\frac{V^+}{\sqrt{Z_0}}=\frac{V+Z_0 I}{2\sqrt{Z_0}}\\b=\frac{V^-}{\sqrt{Z_0}}=\frac{V-Z_0 I}{2\sqrt{Z_0}}\\</script><p>Power delivered is</p><script type="math/tex; mode=display">P_L=\frac{1}{2}\mathrm{Re}[VI^*]=\frac{1}{2Z_0}(a^2-b^2)</script><p>Reflection coefficient</p><script type="math/tex; mode=display">\Gamma_{IN}=S_{11}+\frac{S_{12}S_{21}\Gamma_L}{1-S_{22}\Gamma_L}\\\Gamma_{OUT}=S_{22}+\frac{S_{12}S_{21}\Gamma_S}{1-S_{11}\Gamma_S}</script><p>Mason&#39;s rule</p><script type="math/tex; mode=display">G=\frac{y_{out}}{y_{in}}=\frac{\sum_{k=1}^NG_k\Delta_k}{\Delta}\\\Delta=1-\sum L_i+\sum L_iL_j-\sum L_iL_jL_k+...</script><p>where</p><ul><li>$\Delta$ is the determinant of the graph.</li><li>$y_{in}$ is the input-node variable.</li><li>$y_{out}$ is the output-node variable.</li><li>$G$ is the complete gain.</li><li>$N$ is the total number of forward paths between $y_{in}$ and $y_{out}$.</li><li>$G_k$ is the path gain of the k th forward path between $y_{in}$ and $y_{out}$.</li><li>$L_i$ is the loop gain of a closed loop in the system.</li><li>$L_iL_j$ is the product of the loop gains of two non-touching closed loops.</li><li>$\Delta_k$ is the cofactor value of $\Delta$ for the <em>k</em> th forward path, with the loops touching the <em>k</em> th forward path removed.</li></ul><p>It is defined that</p><ul><li>Path: a continuous set of branches traversed in the direction that they indicate.</li><li>Forward path: A path from an input node to an output node in which <strong>no node is touched more than once</strong>.</li><li>Loop: A path that originates and ends on the same node in which no node is touched more than once.</li><li>Path gain: the product of the gains of all the branches in the path.</li><li>Loop gain: the product of the gains of all the branches in the loop.</li></ul><p>To calculate the input reflection coefficient, the following signal graph is used</p><p><img src="network-parameter/input-reflection-coefficient-signal-graph.png" alt="Input reflection coefficient signal graph"></p><p>we have</p><ul><li>$G_1=S_{11}$<ul><li>$\Delta_1=1-S_{22}\Gamma_L$</li></ul></li><li>$G_2=S_{21}\Gamma_L S_{12}$<ul><li>$\Delta_2=1$, because the only loop in the graph touches $\Gamma_L$</li></ul></li><li>$\Delta=1-S_{22}\Gamma_L$</li><li>$S_{11}=\frac{G_1\Delta_1+G_2\Delta_2}{\Delta}$</li></ul><h3 id="Transfer-Scattering-Parameter"><a href="#Transfer-Scattering-Parameter" class="headerlink" title="Transfer Scattering Parameter"></a>Transfer Scattering Parameter</h3><script type="math/tex; mode=display">\left[\begin{matrix}a_1 \\ a_2\end{matrix}\right]=\left[\begin{matrix}T_{11} & T_{12} \\T_{21} & T_{22}\end{matrix}\right]\left[\begin{matrix}b_1 \\ b_2\end{matrix}\right]</script><h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><h3 id="Reciprocal-Network"><a href="#Reciprocal-Network" class="headerlink" title="Reciprocal Network"></a>Reciprocal Network</h3><p>Not containing any active devices or nonreciprocal media, such as ferrites or plasmas。</p><script type="math/tex; mode=display">\mathbf{Z}=\mathbf{Z}^T\\\mathbf{Y}=\mathbf{Y}^T\\\mathbf{S}=\mathbf{S}^T\\\mathrm{Det}[\mathbf{ABCD}]=1</script><h3 id="Lossless-Network"><a href="#Lossless-Network" class="headerlink" title="Lossless Network"></a>Lossless Network</h3><p>All the parameters of $\mathbf{Z}$ and $\mathbf{Y}$ are purely imaginary. </p><h3 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h3><h4 id="Parallel-Parallel"><a href="#Parallel-Parallel" class="headerlink" title="Parallel-Parallel"></a>Parallel-Parallel</h4><p><img src="network-parameter/parallel-parallel.png" alt="Parallel-Parallel"></p><script type="math/tex; mode=display">\mathbf{Y}=\mathbf{Y_1}+\mathbf{Y_2}</script><h4 id="Series-Series"><a href="#Series-Series" class="headerlink" title="Series-Series"></a>Series-Series</h4><p><img src="network-parameter/series-series.png" alt="Series-Series"></p><script type="math/tex; mode=display">\mathbf{Z}=\mathbf{Z_1}+\mathbf{Z_2}</script><h4 id="Series-Parallel"><a href="#Series-Parallel" class="headerlink" title="Series-Parallel"></a>Series-Parallel</h4><p><img src="network-parameter/series-parallel.png" alt="Series-Parallel"></p><script type="math/tex; mode=display">\mathbf{H}=\mathbf{H_1}+\mathbf{H_2}</script><h4 id="Parallel-Series"><a href="#Parallel-Series" class="headerlink" title="Parallel-Series"></a>Parallel-Series</h4><p><img src="network-parameter/parallel-series.png" alt="Parallel-Series"></p><script type="math/tex; mode=display">\mathbf{G}=\mathbf{G_1}+\mathbf{G_2}</script><h4 id="Cascade"><a href="#Cascade" class="headerlink" title="Cascade"></a>Cascade</h4><p><img src="network-parameter/cascade-connection.png" alt="Cascade-connection"></p><script type="math/tex; mode=display">\mathbf{A}=\mathbf{A_1}\cdot\mathbf{A_2}\\\mathbf{T}=\mathbf{T_1}\cdot\mathbf{T_2}</script><h4 id="Image-Impedance"><a href="#Image-Impedance" class="headerlink" title="Image Impedance"></a>Image Impedance</h4><p>A pair of image impedance $Z_{i1},Z_{i2}$ is defined for reciprocal network as</p><ul><li>$Z_{i1}$  is the input impedance at port 1 when port 2 is terminated with $Z_{i2}$</li><li>$Z_{i2}$ is the input impedance at port 2 when port 1 is terminated with $Z_{i1}$</li></ul><p>With ABCD parameter, the input impedance at port 1 when port 2 is terminated with $Z_{i2}$ equals to</p><script type="math/tex; mode=display">Z_{in1}=\frac{AV_2+BI_2}{CV_2+DI_2}=\frac{AZ_{i2}+B}{CZ_{i2}+D}</script><p>Similarly</p><script type="math/tex; mode=display">Z_{in2}=\frac{DV_1-BI_1}{CV_1+AI_1}=\frac{DZ_{i1}+B}{CZ_{i1}+A}</script><p>Since $Z_{in1}=Z_{i1},Z_{in2}=Z_{i2}$, the solution is</p><script type="math/tex; mode=display">Z_{i1}=\sqrt{\frac{AB}{CD}}=\sqrt{\frac{Z_{11}}{Z_{22}}\mathrm{Det[\mathbf{Z}]}}\\Z_{i2}=\sqrt{\frac{BD}{AC}}=\sqrt{\frac{Z_{22}}{Z_{11}}\mathrm{Det[\mathbf{Z}]}}\\</script><p>When terminated with image impedance $Z_{i2}$, the voltage transfer ratio is</p><script type="math/tex; mode=display">\frac{V_2}{V_1}=\sqrt{\frac{D}{A}}(\sqrt{AD}-\sqrt{BC})</script><p>For current</p><script type="math/tex; mode=display">\frac{I_2}{I_1}=\sqrt{\frac{A}{D}}(\sqrt{AD}-\sqrt{BC})</script><h4 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h4><p><img src="network-parameter/abcd.png" alt="ABCD"></p><p>For T</p><p><img src="network-parameter/t-network.png" alt="T Network"></p><script type="math/tex; mode=display">\mathbf{Z}=\left[\begin{matrix}Z_1+Z_2 & Z_2 \\Z_2 & Z_2+Z_3\end{matrix}\right]</script><p>For Pi</p><p><img src="network-parameter/pi-network.png" alt="Pi Network"></p><script type="math/tex; mode=display">\mathbf{Y}=\left[\begin{matrix}Y_1+Y_2 & -Y_2 \\-Y_2 & Y_2+Y_3\end{matrix}\right]</script><h2 id="Conversion"><a href="#Conversion" class="headerlink" title="Conversion"></a>Conversion</h2><h3 id="General"><a href="#General" class="headerlink" title="General"></a>General</h3><script type="math/tex; mode=display">\mathbf{Z}=\mathbf{Y}^{-1}\\\mathbf{Y}=\mathbf{Z}^{-1}\\\mathbf{Z}=\mathbf{G_{ref}}^{-1}\cdot(\mathbf{E}-\mathbf{S})^{-1}\cdot(\mathbf{S}+\mathbf{E})\cdot\mathbf{Z_{ref}}\cdot\mathbf{G_{ref}}\\\mathbf{Y}=\mathbf{G_{ref}}^{-1}\cdot\mathbf{Z_{ref}}^{-1}\cdot(\mathbf{S}+\mathbf{E})^{-1}\cdot(\mathbf{E}-\mathbf{S})\cdot\mathbf{G_{ref}}\\\mathbf{S}=\mathbf{G_{ref}}\cdot(\mathbf{Z}-\mathbf{Z_{ref}})\cdot(\mathbf{Z}+\mathbf{Z_{ref}})^{-1}\cdot\mathbf{G_{ref}}^{-1}\\\mathbf{S}=\mathbf{G_{ref}}\cdot(\mathbf{E}-\mathbf{Z_{ref}}\cdot\mathbf{Y})\cdot(\mathbf{E}+\mathbf{Z_{ref}}\cdot\mathbf{Y})^{-1}\cdot\mathbf{G_{ref}}^{-1}\\\mathbf{Z_{ref}}=\left[\begin{matrix}Z_{0,1} & 0 & \ldots & 0\\0 & Z_{0,2} & \ldots & 0\\\vdots & \vdots & \ddots & \vdots\\0 & 0 & \ldots & Z_{0,N}\end{matrix}\right]\\\mathbf{G_{ref}}=\left[\begin{matrix}G_{1} & 0 & \ldots & 0\\0 & G_{2} & \ldots & 0\\\vdots & \vdots & \ddots & \vdots\\0 & 0 & \ldots & G_{N}\end{matrix}\right]\\G_n=\frac{1}{\sqrt{\mathrm{Re}[Z_{0,n}]}}</script><p>where $\mathbf{E}$ is an identity matrix, $Z_{0,n}$ is the reference impedance of port n. The renormalization of S parameter is as follows.</p><script type="math/tex; mode=display">\mathbf{S'}=\mathbf{A}^{-1} \cdot (\mathbf{S}-\mathbf{R}) \cdot (\mathbf{E}-\mathbf{R} \cdot \mathbf{S})^{-1} \cdot \mathbf{A}\\\mathbf{R}=\left[\begin{matrix}r(Z_1) & 0 & \ldots & 0\\0 & r(Z_2) & \ldots & 0\\\vdots & \vdots & \ddots & \vdots\\0 & 0 & \ldots & r(Z_N)\end{matrix}\right]\\r(Z_n)=\frac{Z_n-Z_{n,before}}{Z_n+Z_{n,before}}\\\mathbf{A}=\left[\begin{matrix}A_1 & 0 & \ldots & 0\\0 & A_2 & \ldots & 0\\\vdots & \vdots & \ddots & \vdots\\0 & 0 & \ldots & A_N\end{matrix}\right]\\A_n=\sqrt{\frac{Z_n}{Z_{n,before}}}\cdot\frac{1}{Z_n+Z_{n,before}}</script><p>where $\mathbf{S}$ is the original S parameter matrix, and $\mathbf{S&#39;}$ is the recalculated scattering matrix, $Z_n$ is the reference impedance of port n after the normalizing process, and $Z_{n,before}$ is the reference impedance of port n before the normalizing process. </p><h3 id="Two-Port"><a href="#Two-Port" class="headerlink" title="Two Port"></a>Two Port</h3><p><img src="network-parameter/two-port-parameter-conversion.png" alt="Two Port Parameter Conversion"></p><p><img src="network-parameter/two-port-parameter-conversion-2.png" alt="Two Port Parameter Conversion 2"></p><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><p>Mathematica functions</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* Conversion between Z and Y parameters *)</span></span><br><span class="line">Z2Y[Y_] := <span class="keyword">Inverse</span>[Y];</span><br><span class="line">Y2Z[Z_] := <span class="keyword">Inverse</span>[Z];</span><br><span class="line"></span><br><span class="line"><span class="comment">(* Conversion between Y and S parameters *)</span></span><br><span class="line">Y2S[Y_, Zref_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[Y]];</span><br><span class="line">  G0 = <span class="keyword">DiagonalMatrix</span>[(<span class="number">1</span>/<span class="keyword">Sqrt</span>[<span class="keyword">Re</span>[#<span class="number">1</span>]]) &amp; /@ Zref];</span><br><span class="line">  Z0=<span class="keyword">DiagonalMatrix</span>[Zref];</span><br><span class="line">  G0.(E0 - Z0.Y).<span class="keyword">Inverse</span>[(E0 + Z0.Y)].<span class="keyword">Inverse</span>[G0]</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">S2Y[S_, Zref_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[S]];</span><br><span class="line">  G0 = <span class="keyword">DiagonalMatrix</span>[(<span class="number">1</span>/<span class="keyword">Sqrt</span>[<span class="keyword">Re</span>[#<span class="number">1</span>]]) &amp; /@ Zref];</span><br><span class="line">  Z0=<span class="keyword">DiagonalMatrix</span>[Zref];</span><br><span class="line">  <span class="keyword">Inverse</span>[G0].<span class="keyword">Inverse</span>[S.Z0 + Z0].(E0 - S).G0</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line"><span class="comment">(* Conversion between Z and S parameters *)</span></span><br><span class="line">Z2S[Z_, Zref_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[Z]];</span><br><span class="line">  G0 = <span class="keyword">DiagonalMatrix</span>[(<span class="number">1</span>/<span class="keyword">Sqrt</span>[<span class="keyword">Re</span>[#<span class="number">1</span>]]) &amp; /@ Zref];</span><br><span class="line">  Z0=<span class="keyword">DiagonalMatrix</span>[Zref];</span><br><span class="line">  G0.(Z - Z0).<span class="keyword">Inverse</span>[(Z + Z0)].<span class="keyword">Inverse</span>[G0]</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">S2Z[S_, Zref_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[S]];</span><br><span class="line">  G0 = <span class="keyword">DiagonalMatrix</span>[(<span class="number">1</span>/<span class="keyword">Sqrt</span>[<span class="keyword">Re</span>[#<span class="number">1</span>]]) &amp; /@ Zref];</span><br><span class="line">  Z0=<span class="keyword">DiagonalMatrix</span>[Zref];</span><br><span class="line">  <span class="keyword">Inverse</span>[G0].<span class="keyword">Inverse</span>[E0 - S].(S.Z0 + Z0).G0</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line"><span class="comment">(* Renormalization of S parameters *)</span></span><br><span class="line">S2S[S_, Zn_, Znb_] := <span class="keyword">Module</span>[&#123;R, A, E&#125;,</span><br><span class="line">R = <span class="keyword">DiagonalMatrix</span>[(Zn-Znb)/(Zn+Znb)];</span><br><span class="line">A = <span class="keyword">DiagonalMatrix</span>[<span class="keyword">Sqrt</span>[Zn/Znb]/(Zn+Znb)];</span><br><span class="line">E = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[S]];</span><br><span class="line"><span class="keyword">Inverse</span>[A].(S-R).<span class="keyword">Inverse</span>[E-R.S].A</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>Examples</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Y2S[(&#123;</span><br><span class="line">    &#123;<span class="number">0.2</span>, <span class="number">0.8</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0.8</span>, <span class="number">0.2</span>&#125;</span><br><span class="line">   &#125;), &#123;<span class="number">50</span>, <span class="number">50</span>&#125;] // N</span><br></pre></td></tr></table></figure><p>Another way of stating the Mason&#39;s rule</p><script type="math/tex; mode=display">T=\frac{P_1[1-\sum L(1)^{(1)}+\sum L(2)^{(1)}\ldots]+\\P_2[1-\sum L(1)^{(2)}+\sum L(2)^{(2)}\ldots]\ldots}{1-\sum L(1)+\sum L(2)-\sum L(3)+\ldots}</script><p>where</p><ul><li>$P_n$ is a path that connects the beginning and the ending. And node can be in the path only once.</li><li>$L(1)$ is the first-order loop. It is a closed loop made of branches in the same direction.</li><li>$L(n)$ is the product of $n$ separate $L(1)$.</li><li>$L(n)^{(m)}$ is the n th order loop that is not in contact with path $P_m$.</li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>For the basic concepts of Z, Y, S, ABCD parameters, refer to</p><ul><li>D. M. Pozar, <em>Microwave Engineering</em>. NJ, Hoboken: Wiley, 1998.</li></ul><p>For a detailed conversion process of different parameters, refer to</p><ul><li>S. Jahn, M. Margraf, V. Habchi and R. Jacob, <em>Qucs Technical Papers</em>, available at <a href="http://qucs.sourceforge.net/tech/technical.html" target="_blank" rel="noopener">http://qucs.sourceforge.net/tech/technical.html</a>.</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Coupled Transmission Line and Its Applications</title>
      <link href="/archives/865ebedb/coupled-transmission-line.html"/>
      <url>/archives/865ebedb/coupled-transmission-line.html</url>
      
        <content type="html"><![CDATA[<p>This article will cover </p><ul><li>Calculation of Z and Y parameters of coupled transmission line.</li><li>Different configuration of the coupled transmission line used as two-port network.</li><li>Conversion between the standard S parameter and the mixed-mode S parameter.</li></ul><a id="more"></a><h2 id="Coupled-Transmission-Line-Formulation"><a href="#Coupled-Transmission-Line-Formulation" class="headerlink" title="Coupled Transmission Line Formulation"></a>Coupled Transmission Line Formulation</h2><p>The Z parameter of a lossless transmission line is:</p><script type="math/tex; mode=display">\mathbf{Z}=\left[\begin{matrix}-jZ_0\cot\theta & -jZ_0\csc\theta\\-jZ_0\csc\theta & -jZ_0\cot\theta \\\end{matrix}\right]</script><p>where $\theta=\beta l$ and $Z_0$ is the characteristic impedance.</p><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h3><p>The schematic used for analysis is</p><p><img src="coupled-transmission-line/coupled-transmission-line.png" alt="Coupled Transmission Line"></p><script type="math/tex; mode=display">v_a^1(0)=(-jZ_{0e}\cot\theta)i_1\\v_a^3(0)=(-jZ_{0e}\csc\theta)i_3\\v_a^2(0)=(-jZ_{0o}\cot\theta)i_2\\v_a^4(0)=(-jZ_{0o}\csc\theta)i_4\\V_1=v_a^1(0)+v_a^2(0)+v_a^3(0)+v_a^4(0)</script><p>where $v_a^1(0)$ represent the voltage induced by current $i_1$ at position 0 of conductor a. The current relation between the normal and the mixed-mode is:</p><script type="math/tex; mode=display">\begin{align}i_1 &= \frac{1}{2} (I_1 + I_2) \\i_2 &= \frac{1}{2} (I_1 - I_2) \\i_3 &= \frac{1}{2} (I_3 + I_4) \\i_4 &= \frac{1}{2} (I_4 - I_3)\end{align}</script><p>Combine two equations, we have</p><script type="math/tex; mode=display">\begin{align}V_1 &= \frac{-j}{2}(Z_{0e}I_1+Z_{0e}I_2+Z_{0o}I_1-Z_{0o}I_2)\cot\theta\\&= \frac{-j}{2}(Z_{0e}I_3+Z_{0e}I_4+Z_{0o}I_3-Z_{0o}I_4)\csc\theta\end{align}</script><p>Symmetry can be used to derive other parameters.</p><h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h3><p>The mixed-mode S parameter of the coupled transmission line can be written as:</p><script type="math/tex; mode=display">\mathbf{Z^{mm}}=\left[\begin{matrix}-j2Z_{0o}\cot\theta & -j2Z_{0o}\csc\theta & {0} & {0} \\-j2Z_{0o}\csc\theta & -j2Z_{0o}\cot\theta & {0} & {0} \\{0} & {0} & \frac{-jZ_{0e}\cot\theta}{2} & \frac{-jZ_{0e}\csc\theta}{2} \\{0} & {0} & \frac{-jZ_{0e}\cot\theta}{2} & \frac{-jZ_{0e}\csc\theta}{2}\end{matrix}\right]</script><p>Because the line is TEM, the propagation constant and phase velocity are the same for both of these modes $v_p=\omega/\beta=1/\sqrt{L_eC_e}=1/\sqrt{L_oC_o}$.</p><p>With the conversion formula listed in Appendix, we may write the standard S parameter as:</p><script type="math/tex; mode=display">\mathbf{Z^{std}}=-j\left[\begin{matrix}Z_p\cot\theta & Z_m\cot\theta & Z_m\csc\theta & Z_p\csc\theta \\Z_m\cot\theta & Z_p\cot\theta & Z_p\csc\theta & Z_m\csc\theta \\Z_m\csc\theta & Z_p\csc\theta & Z_p\cot\theta & Z_m\cot\theta \\Z_p\csc\theta & Z_m\csc\theta & Z_m\cot\theta & Z_p\cot\theta\end{matrix}\right]</script><p>where $Z_p=(Z_{0e}+Z_{0o})/2,Z_m=(Z_{0e}-Z_{0o})/2$. Note that the port definition of port 3 and port 4 are opposite in Appendix and the aforementioned analysis. To make the conclusion compatible, the transformation is modified as</p><script type="math/tex; mode=display">\mathbf{Z^{std}}=\mathbf{T}\mathbf{M}^{H}\mathbf{Z^{mm}}\mathbf{M}\mathbf{T}\\\mathbf{T}=\left[\begin{matrix}{1} & {0} & {0} & {0} \\{0} & {1} & {0} & {0} \\{0} & {0} & {0} & {1} \\{0} & {0} & {1} & {0}\end{matrix}\right]</script><p>The additional matrix $\mathbf{T}$ is used to swap port sequence.</p><p>The Y parameter can be expressed as</p><script type="math/tex; mode=display">\mathbf{Y}=-j\left[\begin{matrix}{Y_p\cot\theta} & {-Y_m\cot\theta} & {Y_m\csc\theta} & {-Y_p\csc\theta} \\{-Y_m\cot\theta} & {Y_p\cot\theta} & {-Y_p\csc\theta} & {Y_m\csc\theta} \\{Y_m\csc\theta} & {-Y_p\csc\theta} & {Y_p\cot\theta} & {-Y_m\cot\theta} \\{-Y_p\csc\theta} & {Y_m\csc\theta} & {-Y_m\cot\theta} & {Y_p\cot\theta}\end{matrix}\right]</script><p>where $Y_p=(Y_{0o}+Y_{0e})/2,Y_m=(Y_{0o}-Y_{0e})/2$.</p><h2 id="Two-Port-Configuration"><a href="#Two-Port-Configuration" class="headerlink" title="Two-Port Configuration"></a>Two-Port Configuration</h2><p><img src="coupled-transmission-line/two-port-configuration.png" alt="Two-Port Configuration"></p><h3 id="Type-3"><a href="#Type-3" class="headerlink" title="Type 3"></a>Type 3</h3><p>Port 2 open</p><p>Port 4 open</p><script type="math/tex; mode=display">\mathbf{Z}=\left[\begin{matrix}-\frac{j}{2}(Z_{0e}+Z_{0o})\cot\theta & -\frac{j}{2}(Z_{0e}-Z_{0o})\csc\theta\\-\frac{j}{2}(Z_{0e}-Z_{0o})\csc\theta & -\frac{j}{2}(Z_{0e}+Z_{0o})\cot\theta \\\end{matrix}\right]</script><h3 id="Type-5"><a href="#Type-5" class="headerlink" title="Type 5"></a>Type 5</h3><p>Port 2 open</p><p>Port 3 open</p><script type="math/tex; mode=display">\mathbf{Z}=\frac{Z_{0e}+Z_{0o}}{2}\left[\begin{matrix}-j\cot\theta & -j\csc\theta\\-j\csc\theta & -j\cot\theta \\\end{matrix}\right]</script><h3 id="Type-6"><a href="#Type-6" class="headerlink" title="Type 6"></a>Type 6</h3><p>Port 2 short</p><p>Port 3 short</p><script type="math/tex; mode=display">\mathbf{Z}=\frac{2Z_{0e}Z_{0o}}{Z_{0e}+Z_{0o}}\left[\begin{matrix}-j\cot\theta & -j\csc\theta\\-j\csc\theta & -j\cot\theta \\\end{matrix}\right]</script><h3 id="Type-7"><a href="#Type-7" class="headerlink" title="Type 7"></a>Type 7</h3><p>Port 2-3 connected</p><script type="math/tex; mode=display">\mathbf{Z}=-\frac{j}{2}\csc\theta \sec\theta\left[\begin{matrix}Z_p\cos 2\theta +Z_m & Z_m\cos 2\theta +Z_p \\Z_m\cos 2\theta +Z_p & Z_p\cos 2\theta +Z_m \\\end{matrix}\right]</script><h3 id="Type-8"><a href="#Type-8" class="headerlink" title="Type 8"></a>Type 8</h3><p>Port 2 short</p><p>Port 4 open</p><script type="math/tex; mode=display">\mathbf{Z}=\left[\begin{matrix}-2j\frac{Z_{0e}Z_{0o}\cot\theta}{Z_{0e}+Z_{0o}} & 0\\0 & \frac{j}{2}(Z_{0e}+Z_{0o})\tan\theta \\\end{matrix}\right]</script><p>It is an all-stop filter. An intuitive understanding is that when applied at the input, the signal is divided to the through and coupled ports, got reflected at these ports with open/short terminations, and out-of-phase combined at the isolation port, resulting in zero transmissions at all frequencies.</p><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><h3 id="Conversion-Between-the-Standard-S-Parameter-and-Mixed-Mode-S-Parameter"><a href="#Conversion-Between-the-Standard-S-Parameter-and-Mixed-Mode-S-Parameter" class="headerlink" title="Conversion Between the Standard S Parameter and Mixed-Mode S Parameter"></a>Conversion Between the Standard S Parameter and Mixed-Mode S Parameter</h3><p>Numbering of the ports is as follows:</p><p><img src="coupled-transmission-line/4-port-s-parameter.png" alt="4 port S parameter"></p><p>The standard S parameter ($\mathbf{S^{std}}$) is</p><script type="math/tex; mode=display">\left[\begin{matrix}{b_{1}} \\ {b_{2}} \\ {b_{3}} \\ {b_{4}}\end{matrix}\right]=\left[\begin{matrix}{S_{11}} & {S_{12}} & {S_{13}} & {S_{14}} \\{S_{21}} & {S_{22}} & {S_{23}} & {S_{24}} \\{S_{31}} & {S_{32}} & {S_{33}} & {S_{34}} \\{S_{41}} & {S_{42}} & {S_{43}} & {S_{44}}\end{matrix}\right]\left[\begin{matrix}{a_{1}} \\ {a_{2}} \\ {a_{3}} \\ {a_{4}}\end{matrix}\right]</script><p>The mixed-mode S parameter ($\mathbf{S^{mm}}$) is:</p><script type="math/tex; mode=display">\begin{aligned}\left[\begin{matrix}{b_{d1}} \\ {b_{d2}} \\ {b_{c1}} \\ {b_{c2}}\end{matrix}\right]&=\left[\begin{matrix}\mathbf{S_{dd}} & \mathbf{S_{dc}} \\\mathbf{S_{cd}} & \mathbf{S_{cc}}\end{matrix}\right]\left[\begin{matrix}{a_{d1}} \\ {a_{d2}} \\ {a_{c1}} \\ {a_{c2}}\end{matrix}\right]\\&=\left[\begin{matrix}{S_{dd11}} & {S_{dd12}} & {S_{dc11}} & {S_{dc12}} \\{S_{dd21}} & {S_{dd22}} & {S_{dc21}} & {S_{dc22}} \\{S_{cd11}} & {S_{cd12}} & {S_{cc11}} & {S_{cc12}} \\{S_{cd21}} & {S_{cd22}} & {S_{cc21}} & {S_{cc22}}\end{matrix}\right]\left[\begin{matrix}{a_{d1}} \\ {a_{d2}} \\ {a_{c1}} \\ {a_{c2}}\end{matrix}\right]\end{aligned}</script><p>The relationship between the two is:</p><script type="math/tex; mode=display">\mathbf{S^{mm}}=\mathbf{M}\mathbf{S^{std}}\mathbf{M}^{H}\\\mathbf{M}=\frac{1}{\sqrt{2}}\left[\begin{matrix}{1} & {-1} & {0} & {0} \\{0} & {0} & {1} & {-1} \\{1} & {1} & {0} & {0} \\{0} & {0} & {1} & {1}\end{matrix}\right]\\\mathbf{M}\mathbf{M}^{H}=\mathbf{I}</script><h3 id="Conversion-Between-the-Standard-Z-Parameter-and-Mixed-Mode-Z-Parameter"><a href="#Conversion-Between-the-Standard-Z-Parameter-and-Mixed-Mode-Z-Parameter" class="headerlink" title="Conversion Between the Standard Z Parameter and Mixed-Mode Z Parameter"></a>Conversion Between the Standard Z Parameter and Mixed-Mode Z Parameter</h3><p>For the full circuit, we may write</p><script type="math/tex; mode=display">v_d=v_1-v_2\\i_d=\frac{1}{2}(i_1-i_2)\\v_c=\frac{1}{2}(v_1+v_2)\\i_c=i_1+i_2</script><p>This is different from the half circuit analysis. The above equations can be put into matrix form.</p><script type="math/tex; mode=display">\left[\begin{matrix}{I_{d1}} \\ {I_{d2}} \\ {I_{c1}} \\ {I_{c2}}\end{matrix}\right]=\left[\begin{matrix}{1/2} & {-1/2} & {0} & {0} \\{0} & {0} & {1/2} & {-1/2}\\{1} & {1} & {0} & {0} \\{0} & {0} & {1} & {1} \end{matrix}\right]\left[\begin{matrix}{I_{1}} \\ {I_{2}} \\ {I_{3}} \\ {I_{4}}\end{matrix}\right]\\\left[\begin{matrix}{U_{d1}} \\ {U_{d2}} \\ {U_{c1}} \\ {U_{c2}}\end{matrix}\right]=\left[\begin{matrix}{1} & {-1} & {0} & {0} \\{0} & {0} & {1} & {-1}\\{1/2} & {1/2} & {0} & {0} \\{0} & {0} & {1/2} & {1/2} \end{matrix}\right]\left[\begin{matrix}{U_{1}} \\ {U_{2}} \\ {U_{3}} \\ {U_{4}}\end{matrix}\right]</script><p>which leads to</p><script type="math/tex; mode=display">\mathbf{Z^{std}}=\mathbf{M}^{H}\mathbf{Z^{mm}}\mathbf{M}\\\mathbf{M}=\left[\begin{matrix}{1/2} & {-1/2} & {0} & {0} \\{0} & {0} & {1/2} & {-1/2}\\{1} & {1} & {0} & {0} \\{0} & {0} & {1} & {1} \end{matrix}\right]</script><p>Instead if half circuit is used, we have</p><script type="math/tex; mode=display">v_o=\frac{1}{2}(v_1-v_2)\\i_o=\frac{1}{2}(i_1-i_2)\\v_e=\frac{1}{2}(v_1+v_2)\\i_e=\frac{1}{2}(i_1+i_2)</script><p>The result is modified to be the same as the S parameter.</p><h3 id="Mathematica-Derivation"><a href="#Mathematica-Derivation" class="headerlink" title="Mathematica Derivation"></a>Mathematica Derivation</h3><p>Calculation of standard S parameter</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Zmm = ( &#123;</span><br><span class="line">    &#123;<span class="number">-2</span> I Zo <span class="keyword">Cot</span>[t], <span class="number">-2</span> I Zo <span class="keyword">Csc</span>[t], <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">-2</span> I Zo <span class="keyword">Csc</span>[t], <span class="number">-2</span> I Zo <span class="keyword">Cot</span>[t], <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, -I/<span class="number">2</span> Ze <span class="keyword">Cot</span>[t], -I/<span class="number">2</span> Ze <span class="keyword">Csc</span>[t]&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, -I/<span class="number">2</span> Ze <span class="keyword">Csc</span>[t], -I/<span class="number">2</span> Ze <span class="keyword">Cot</span>[t]&#125;</span><br><span class="line">   &#125; );</span><br><span class="line">M = (&#123;</span><br><span class="line">    &#123;<span class="number">1</span>/<span class="number">2</span>, <span class="number">-1</span>/<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>/<span class="number">2</span>, <span class="number">-1</span>/<span class="number">2</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>&#125;</span><br><span class="line">   &#125;);</span><br><span class="line">T = ( &#123;</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;</span><br><span class="line">   &#125; );</span><br><span class="line">Zstd = T.<span class="keyword">Transpose</span>[M].Zmm.M.T // <span class="keyword">MatrixForm</span></span><br></pre></td></tr></table></figure><p>Derivation of type 6</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">St = ( &#123;</span><br><span class="line">   &#123;a, d, b, c&#125;,</span><br><span class="line">   &#123;d, a, c, b&#125;,</span><br><span class="line">   &#123;b, c, a, d&#125;,</span><br><span class="line">   &#123;c, b, d, a&#125;</span><br><span class="line">  &#125; ); y = ( &#123;</span><br><span class="line">   &#123;V1&#125;,</span><br><span class="line">   &#123;V2&#125;,</span><br><span class="line">   &#123;V3&#125;,</span><br><span class="line">   &#123;V4&#125;</span><br><span class="line">  &#125; ); x = ( &#123;</span><br><span class="line">   &#123;I1&#125;,</span><br><span class="line">   &#123;I2&#125;,</span><br><span class="line">   &#123;I3&#125;,</span><br><span class="line">   &#123;I4&#125;</span><br><span class="line">  &#125; );</span><br><span class="line">result = <span class="keyword">Solve</span>[(y /. &#123;V2 -&gt; <span class="number">0</span>, V3 -&gt; <span class="number">0</span>&#125;) == St.x, &#123;V1, I2, I3, V4&#125;][[<span class="number">1</span>]];</span><br><span class="line">Y = <span class="keyword">Simplify</span>[( &#123;</span><br><span class="line">      &#123;<span class="keyword">Coefficient</span>[V1 /. result, I1], <span class="keyword">Coefficient</span>[V1 /. result, I4]&#125;,</span><br><span class="line">      &#123;<span class="keyword">Coefficient</span>[V4 /. result, I1], <span class="keyword">Coefficient</span>[V4 /. result, I4]&#125;</span><br><span class="line">     &#125; ) /. &#123;a -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Cot</span>[t] - <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Cot</span>[t], </span><br><span class="line">     b -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Csc</span>[t] + <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Csc</span>[t], </span><br><span class="line">     c -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Csc</span>[t] - <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Csc</span>[t], </span><br><span class="line">     d -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Cot</span>[t] + <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Cot</span>[t]&#125;];</span><br></pre></td></tr></table></figure><p>Derivation of type 7</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">St = ( &#123;</span><br><span class="line">   &#123;a, d, b, c&#125;,</span><br><span class="line">   &#123;d, a, c, b&#125;,</span><br><span class="line">   &#123;b, c, a, d&#125;,</span><br><span class="line">   &#123;c, b, d, a&#125;</span><br><span class="line">  &#125; ); y = ( &#123;</span><br><span class="line">   &#123;V1&#125;,</span><br><span class="line">   &#123;V2&#125;,</span><br><span class="line">   &#123;V3&#125;,</span><br><span class="line">   &#123;V4&#125;</span><br><span class="line">  &#125; ); x = ( &#123;</span><br><span class="line">   &#123;I1&#125;,</span><br><span class="line">   &#123;I2&#125;,</span><br><span class="line">   &#123;I3&#125;,</span><br><span class="line">   &#123;I4&#125;</span><br><span class="line">  &#125; );</span><br><span class="line">result = <span class="keyword">Solve</span>[(y /. &#123;V4 -&gt; V3&#125;) == (St.x /. I4 -&gt; -I3), &#123;V1, V2, I3, </span><br><span class="line">   V3&#125;];</span><br><span class="line">Y = <span class="keyword">Simplify</span>[( &#123;</span><br><span class="line">      &#123;<span class="keyword">Coefficient</span>[(V1 /. result)[[<span class="number">1</span>]], I1], </span><br><span class="line">       <span class="keyword">Coefficient</span>[(V1 /. result)[[<span class="number">1</span>]], I2]&#125;,</span><br><span class="line">      &#123;<span class="keyword">Coefficient</span>[(V2 /. result)[[<span class="number">1</span>]], I1], </span><br><span class="line">       <span class="keyword">Coefficient</span>[(V2 /. result)[[<span class="number">1</span>]], I2]&#125;</span><br><span class="line">     &#125; ) /. &#123;a -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Cot</span>[t] - <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Cot</span>[t], </span><br><span class="line">     b -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Csc</span>[t] + <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Csc</span>[t], </span><br><span class="line">     c -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Csc</span>[t] - <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Csc</span>[t], </span><br><span class="line">     d -&gt; -(<span class="number">1</span>/<span class="number">2</span>) I Ze <span class="keyword">Cot</span>[t] + <span class="number">1</span>/<span class="number">2</span> I Zo <span class="keyword">Cot</span>[t]&#125;] ;</span><br><span class="line">Y // <span class="keyword">MatrixForm</span></span><br></pre></td></tr></table></figure><h3 id="Parameter-Extraction-of-the-Coupled-Transmission-Line"><a href="#Parameter-Extraction-of-the-Coupled-Transmission-Line" class="headerlink" title="Parameter Extraction of the Coupled Transmission Line"></a>Parameter Extraction of the Coupled Transmission Line</h3><h4 id="Method-1-1"><a href="#Method-1-1" class="headerlink" title="Method 1"></a>Method 1</h4><p>When configured in a way like this</p><p><img src="coupled-transmission-line/image-20200313152331269.png" alt="image-20200313152331269"></p><p>The S parameter of it should appear like</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">S = [a, b, c, d</span><br><span class="line">    b, a, d, c</span><br><span class="line">    c, d, a, b</span><br><span class="line">    d, c, b, a];</span><br></pre></td></tr></table></figure><p>It is then converted using Matlab, as</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">polar2complex = @(mag, pha) mag .* <span class="built_in">exp</span>(<span class="number">1</span><span class="built_in">i</span>*pha*<span class="built_in">pi</span>/<span class="number">180</span>);</span><br><span class="line">a = polar2complex(<span class="number">0.141</span>, <span class="number">68.196</span>);</span><br><span class="line">b = polar2complex(<span class="number">0.171</span>, <span class="number">66.122</span>);</span><br><span class="line">c = polar2complex(<span class="number">0.951</span>, <span class="number">-20.174</span>);</span><br><span class="line">d = polar2complex(<span class="number">0.083</span>, <span class="number">-128.593</span>);</span><br><span class="line"></span><br><span class="line">S = [a, b, c, d</span><br><span class="line">    b, a, d, c</span><br><span class="line">    c, d, a, b</span><br><span class="line">    d, c, b, a];</span><br><span class="line"></span><br><span class="line"><span class="comment">% convert to mixed-mode S parameter</span></span><br><span class="line">M = <span class="number">1</span>/<span class="built_in">sqrt</span>(<span class="number">2</span>)*[<span class="number">1</span> <span class="number">-1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">-1</span></span><br><span class="line">    <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span>];</span><br><span class="line">Smm=M*S*M';</span><br><span class="line"></span><br><span class="line"><span class="built_in">length</span> = <span class="number">200e-6</span>;<span class="comment">% length of transmission line</span></span><br><span class="line">freq = <span class="number">30e9</span>;<span class="comment">% frequency of simulation</span></span><br><span class="line">Z0 = <span class="number">50</span>;<span class="comment">% characteristic impedance of the ports</span></span><br><span class="line">C = <span class="number">3e8</span>;<span class="comment">% speed of light in free space</span></span><br><span class="line"></span><br><span class="line">differential = s2rlgc(Smm(<span class="number">1</span>:<span class="number">2</span>,<span class="number">1</span>:<span class="number">2</span>), <span class="built_in">length</span>, freq, Z0)</span><br><span class="line">Zo = <span class="built_in">real</span>(differential.Zc)</span><br><span class="line">Ao = differential.alpha*<span class="number">8.686</span></span><br><span class="line">Ko = (C*differential.<span class="built_in">beta</span>/<span class="number">2</span>/<span class="built_in">pi</span>/freq)^<span class="number">2</span></span><br><span class="line">common = s2rlgc(Smm(<span class="number">3</span>:<span class="number">4</span>,<span class="number">3</span>:<span class="number">4</span>), <span class="built_in">length</span>, freq, Z0)</span><br><span class="line">Ze = <span class="built_in">real</span>(common.Zc)</span><br><span class="line">Ae = common.alpha*<span class="number">8.686</span></span><br><span class="line">Ke = (C*common.<span class="built_in">beta</span>/<span class="number">2</span>/<span class="built_in">pi</span>/freq)^<span class="number">2</span></span><br></pre></td></tr></table></figure><h4 id="Method-2-1"><a href="#Method-2-1" class="headerlink" title="Method 2"></a>Method 2</h4><p>Alternatively, the mixed-mode parameter can be obtained from direct simulation. For the even/common mode</p><p><img src="coupled-transmission-line/image-20200313153401014.png" alt="image-20200313153401014"></p><p>For the odd/differential mode</p><p><img src="coupled-transmission-line/image-20200313153444639.png" alt="image-20200313153444639"></p><p>Note that the port impedance is changed accordingly.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>For the derivation of coupled transmission line, Wilkinson power divider, quadrature hybrid, refer to</p><ul><li>D. M. Pozar, <em>Microwave Engineering</em>. NJ, Hoboken: Wiley, 1998.</li></ul><p>For the conversion between the standard S parameter and mixed-mode S parameter, refer to</p><ul><li>W. R. Eisenstadt, B. Stengel and B. M. Thompson, <em>Microwave Differential Circuit Design Using Mixed-Mode S-Parameters</em>. Norwood: Artech House, 2006</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Math Typesetting in Latex</title>
      <link href="/archives/706864ae/math-typesetting-in-latex.html"/>
      <url>/archives/706864ae/math-typesetting-in-latex.html</url>
      
        <content type="html"><![CDATA[<p>This article is about the math typesetting using Latex.</p><a id="more"></a><h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><p>Act only on the next character. Use curly braces {...} to affect several characters.</p><h3 id="Special-Characters"><a href="#Special-Characters" class="headerlink" title="Special Characters"></a>Special Characters</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\# \$ \% \&#123; \&#125; \_ \\</span><br><span class="line">\backslash</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\# \$ \% \{ \} \_ \\\backslash</script><h3 id="Short-Ones"><a href="#Short-Ones" class="headerlink" title="Short Ones"></a>Short Ones</h3><ul><li>$a^2$    <code>a^2</code></li><li>$a_2$    <code>a_2</code></li><li>$\sqrt{a}$    <code>\sqrt{a}</code></li><li>$\sqrt[n]{a}$    <code>\sqrt[n]{a}</code></li><li>$\vec{a}$    <code>\vec{a}</code></li><li>$37^\circ$    <code>37^\circ</code></li><li>$\overrightarrow{AB}$    <code>\overrightarrow{AB}</code></li><li>$\mathrm{d}x$    <code>\mathrm{d}x</code></li><li>$\mathbf{\mu,M}$    <code>\mathbf{\mu,M}</code></li><li>$\boldsymbol{\mu,M}$    <code>\boldsymbol{\mu,M}</code></li></ul><h3 id="Large-Ones"><a href="#Large-Ones" class="headerlink" title="Large Ones"></a>Large Ones</h3><p>Sum, integral and product operator</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\sum_&#123;i=1&#125;^n \qquad</span><br><span class="line">\int_&#123;-\infty&#125;^\infty \qquad</span><br><span class="line">\prod \qquad</span><br><span class="line">\iint \qquad</span><br><span class="line">\oint \qquad</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\sum_{i=1}^n \qquad\int_{-\infty}^\infty \qquad\prod \qquad\iint \qquad\oint \qquad</script><p>Delimiter of auto size, use a pair of <code>\left</code> and <code>\right</code>. If the right is not necessary, use <code>\right.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\left( \frac&#123;1&#125;&#123;1+x&#125; \right) \qquad</span><br><span class="line">\left\&#123; \frac&#123;x&#125;&#123;y&#125; \right.</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\left( \frac{1}{1+x} \right) \qquad\left\{ \frac{x}{y} \right.</script><p>To specify the size manually, use</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\big|</span><br><span class="line">\Big|</span><br><span class="line">\bigg|</span><br><span class="line">\Bigg|</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\big|\Big|\bigg|\Bigg|</script><p>To group multiple equations, use <code>align</code> environment</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\left\&#123;</span><br><span class="line">\begin&#123;align&#125;</span><br><span class="line">a+b &amp;= x\\</span><br><span class="line">c+d &amp;= y</span><br><span class="line">\end&#123;align&#125;</span><br><span class="line">\right.</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\left\{\begin{align}a+b &= x\\c+d &= y\end{align}\right.</script><p>To add a matrix, we may use environment <code>array</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\mathbf&#123;X&#125; =</span><br><span class="line">\left[</span><br><span class="line">\begin&#123;array&#125;&#123;ccc&#125;</span><br><span class="line">x_&#123;11&#125; &amp; x_&#123;12&#125; &amp; \ldots \\</span><br><span class="line">x_&#123;21&#125; &amp; x_&#123;22&#125; &amp; \ldots \\</span><br><span class="line">\vdots &amp; \vdots &amp; \ddots</span><br><span class="line">\end&#123;array&#125;</span><br><span class="line">\right]</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\mathbf{X} =\left[    \begin{array}{ccc}        x_{11} & x_{12} & \ldots \\        x_{21} & x_{22} & \ldots \\        \vdots & \vdots & \ddots    \end{array}\right]</script><p>or we may use environment <code>matrix</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\mathbf&#123;X&#125; =</span><br><span class="line">\left[</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">x_&#123;11&#125; &amp; x_&#123;12&#125; &amp; \ldots \\</span><br><span class="line">x_&#123;21&#125; &amp; x_&#123;22&#125; &amp; \ldots \\</span><br><span class="line">\vdots &amp; \vdots &amp; \ddots</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right]</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\mathbf{X} =\left[    \begin{matrix}        x_{11} & x_{12} & \ldots \\        x_{21} & x_{22} & \ldots \\        \vdots & \vdots & \ddots    \end{matrix}\right]</script><p>we can draw a table as</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\begin&#123;array&#125;&#123;c|cc&#125;</span><br><span class="line">    n &amp; x &amp; y \\</span><br><span class="line">    \hline</span><br><span class="line">    1 &amp; a &amp; b \\</span><br><span class="line">    2 &amp; c &amp; d</span><br><span class="line">\end&#123;array&#125;</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">\begin{array}{c|cc}    n & x & y \\    \hline    1 & a & b \\    2 & c & d\end{array}</script><p>Space</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a \, b \\</span><br><span class="line">a \; b \\</span><br><span class="line">a \  b \\ % the same as \;</span><br><span class="line">a \quad b \\</span><br><span class="line">a \qquad b</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">a \, b \\a \; b \\a \  b \\a \quad b \\a \qquad b</script><h2 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h2><h3 id="Math-Mode-Accents"><a href="#Math-Mode-Accents" class="headerlink" title="Math Mode Accents"></a>Math Mode Accents</h3><p><img src="math-typesetting-in-latex/math-mode-accents.png" alt="Math Mode Accents"></p><h3 id="Greeks-Letters"><a href="#Greeks-Letters" class="headerlink" title="Greeks Letters"></a>Greeks Letters</h3><p><img src="math-typesetting-in-latex/greeks-letters.png" alt="Greeks Letters"></p><h3 id="Binary-Relations"><a href="#Binary-Relations" class="headerlink" title="Binary Relations"></a>Binary Relations</h3><p><img src="math-typesetting-in-latex/binary-relations.png" alt="Binary Relations"></p><h3 id="Binary-Operators"><a href="#Binary-Operators" class="headerlink" title="Binary Operators"></a>Binary Operators</h3><p><img src="math-typesetting-in-latex/binary-operators.png" alt="Binary Operators"></p><h3 id="Big-Operators"><a href="#Big-Operators" class="headerlink" title="Big Operators"></a>Big Operators</h3><p><img src="math-typesetting-in-latex/big-operators.png" alt="Big Operators"></p><h3 id="Arrows"><a href="#Arrows" class="headerlink" title="Arrows"></a>Arrows</h3><p><img src="math-typesetting-in-latex/arrows.png" alt="Arrows"></p><h3 id="Arrows-as-Accents"><a href="#Arrows-as-Accents" class="headerlink" title="Arrows as Accents"></a>Arrows as Accents</h3><p><img src="math-typesetting-in-latex/arrows-as-accents.png" alt="Arrows as Accents"></p><h3 id="Delimiters"><a href="#Delimiters" class="headerlink" title="Delimiters"></a>Delimiters</h3><p><img src="math-typesetting-in-latex/delimiters-1.png" alt="Delimiters 1"></p><p><img src="math-typesetting-in-latex/delimiters-2.png" alt="Delimiters 2"></p><h3 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h3><p><img src="math-typesetting-in-latex/others.png" alt="Others"></p><h2 id="Fonts"><a href="#Fonts" class="headerlink" title="Fonts"></a>Fonts</h2><p><img src="math-typesetting-in-latex/fonts.png" alt="Fonts"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>Tobias Oetiker. <em>A short introduction to LATEX 2e</em>. Available at: <a href="https://www.ctan.org/tex-archive/info/lshort" target="_blank" rel="noopener">https://www.ctan.org/tex-archive/info/lshort</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
            <tag> Math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Useful Mathematical Formulas</title>
      <link href="/archives/ffa08d7c/useful-mathematical-formulas.html"/>
      <url>/archives/ffa08d7c/useful-mathematical-formulas.html</url>
      
        <content type="html"><![CDATA[<p>This article will present:</p><ul><li>Identities</li><li>Derivative formulas</li><li>Integral formulas</li><li>Taylor series</li><li>Fourier transformation (include DTFT and DFT)</li><li>Laplace transformation</li><li>Z transformation</li></ul><a id="more"></a><h2 id="Identities"><a href="#Identities" class="headerlink" title="Identities"></a>Identities</h2><script type="math/tex; mode=display">\begin{aligned}\csc x &= \frac{1}{\sin x}\\\sec x &= \frac{1}{\cos x}\\\cot x &= \frac{1}{\tan x}\\e^{jx} &= \cos x+j\sin x\\\cos x &= \frac{e^{jx}+e^{-jx}}{2}=\cosh jx\\\sin x &= \frac{e^{jx}-e^{-jx}}{2j}=\frac{1}{j}\sinh jx\\\tan x &= \frac{1}{j}\frac{e^{jx}-e^{-jx}}{e^{jx}+e^{-jx}}=\frac{1}{j}\tanh jx\\e^{x} &= \cosh x+\sinh x\\\cosh x &= \frac{e^{x}+e^{-x}}{2}=\cos\frac{x}{j}\\\sinh x &= \frac{e^{x}-e^{-x}}{2}=j\sin\frac{x}{j}\\\tanh x &= \frac{e^{x}-e^{-x}}{e^{x}+e^{-x}}=j\tan\frac{x}{j}\end{aligned}</script><h3 id="Trigonometric-Function"><a href="#Trigonometric-Function" class="headerlink" title="Trigonometric Function"></a>Trigonometric Function</h3><script type="math/tex; mode=display">\begin{aligned}1 &= \sin^2\alpha+\cos^2\alpha\\  &= \sec^2\alpha-\tan^2\alpha\\  &= \csc^2\alpha-\cot^2\alpha\\\sin 2\alpha &= 2\sin \alpha \cos \alpha\\\cos 2\alpha &= \cos^2 \alpha - \sin^2 \alpha\\            &= 2\cos^2 \alpha - 1\\            &= 1 - 2\sin^2 \alpha\\\tan 2\alpha &= \frac{2\tan \alpha}{1-\tan^2\alpha}\\\sin(\alpha\pm\beta) &=\sin\alpha\cos\beta\pm\cos\alpha\sin\beta\\\cos(\alpha\pm\beta) &=\cos\alpha\cos\beta\mp\sin\alpha\sin\beta\\\tan(\alpha\pm\beta) &=\frac{\tan\alpha\pm\tan\beta}{1\mp\tan\alpha\tan\beta}\\\\1 &= \cosh^2\alpha-\sinh^2\alpha\\\sinh 2\alpha &= 2\sinh \alpha \cosh \alpha\\\cosh 2\alpha &= \cosh^2 \alpha + \sinh^2 \alpha\\            &= 2\cosh^2 \alpha - 1\\            &= 1 + 2\sinh^2 \alpha\\\sinh(\alpha\pm\beta) &=\sinh\alpha\cosh\beta\pm\cosh\alpha\sinh\beta\\\cosh(\alpha\pm\beta) &=\cosh\alpha\cosh\beta\pm\sinh\alpha\sinh\beta\\\tanh(\alpha\pm\beta) &=\frac{\tanh\alpha\pm\tanh\beta}{1\pm\tanh\alpha\tanh\beta}\\\end{aligned}</script><p>Sum-product conversion</p><script type="math/tex; mode=display">\begin{aligned}\sin\alpha\sin\beta&=\frac{\cos(\alpha-\beta)-\cos(\alpha+\beta)}{2}\\\cos\alpha\cos\beta&=\frac{\cos(\alpha-\beta)+\cos(\alpha+\beta)}{2}\\\sin\alpha\cos\beta&=\frac{\sin(\alpha+\beta)+\sin(\alpha-\beta)}{2}\\\cos\alpha\sin\beta&=\frac{\sin(\alpha+\beta)-\sin(\alpha-\beta)}{2}\\\sin\alpha+\sin\beta&=2\sin\frac{\alpha+\beta}{2}\cos\frac{\alpha-\beta}{2}\\\sin\alpha-\sin\beta&=2\cos\frac{\alpha+\beta}{2}\sin\frac{\alpha-\beta}{2}\\\cos\alpha+\cos\beta&=2\cos\frac{\alpha+\beta}{2}\cos\frac{\alpha-\beta}{2}\\\cos\alpha-\cos\beta&=-2\sin\frac{\alpha+\beta}{2}\sin\frac{\alpha-\beta}{2}\\\tan\alpha+\tan\beta&=\frac{\sin\alpha+\sin\beta}{\cos\alpha\cos\beta}\\\end{aligned}</script><h3 id="Limits"><a href="#Limits" class="headerlink" title="Limits"></a>Limits</h3><script type="math/tex; mode=display">\begin{aligned}\lim_{n\to\infty}\left(1+\frac{1}{n}\right)^n &= e\end{aligned}</script><h2 id="Derivative-Formulas"><a href="#Derivative-Formulas" class="headerlink" title="Derivative Formulas"></a>Derivative Formulas</h2><h3 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h3><script type="math/tex; mode=display">\begin{aligned}(uv)' &= u'v+uv'\\\left(\frac{u}{v}\right)' &= \frac{u'v-uv'}{v^2}\\\frac{dy}{dx} &= \frac{dy}{du}\cdot\frac{du}{dx}\\\end{aligned}</script><h3 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h3><script type="math/tex; mode=display">\begin{aligned}(x^n)' &= nx^{n-1}\\(\ln x)' &= \frac{1}{x}\\(e^x)' &= e^x\\(a^x)' &= a^x\ln a\\\end{aligned}</script><h3 id="Trigonometric-Function-1"><a href="#Trigonometric-Function-1" class="headerlink" title="Trigonometric Function"></a>Trigonometric Function</h3><script type="math/tex; mode=display">\begin{aligned}(\sin x)' &= \cos x\\(\cos x)' &= -\sin x\\(\tan x)' &= \sec^2x\\(\sec x)' &= \sec x \tan x\\(\csc x)' &= -\csc x \cot x\\(\cot x)' &= -\csc^2x\\(\arcsin x)' &= \frac{1}{\sqrt{1-x^2}}\\(\arccos x)' &= -\frac{1}{\sqrt{1-x^2}}\\(\arctan x)' &= \frac{1}{1+x^2}\\\\(\sinh x)' &= \cosh x\\(\cosh x)' &= \sinh x\\(\tanh x)' &= 1-\tanh^2x\\\end{aligned}</script><h2 id="Integral-Formulas"><a href="#Integral-Formulas" class="headerlink" title="Integral Formulas"></a>Integral Formulas</h2><h3 id="Theory-1"><a href="#Theory-1" class="headerlink" title="Theory"></a>Theory</h3><p>Integration by substitution</p><script type="math/tex; mode=display">\begin{aligned}\int f(x)dx &= \int g(\varphi(x))\varphi'(x)dx\\&= \int g(u)du &\varphi(x)\to u\\&=G(u)+C\\&=G(\varphi(x))+C\end{aligned}</script><p>or</p><script type="math/tex; mode=display">\begin{aligned}\int g(u)du &= \int g(\varphi(x))\varphi'(x)dx & u\to\varphi(x)\\&= f(x)dx & g(\varphi(x))\varphi'(x)\to f(x)\\&=F(x)+C\\&=F(\varphi^{-1}(u))+C\end{aligned}</script><p>For finite integral</p><script type="math/tex; mode=display">\int_a^bg(u)du=\int_\alpha^\beta g(\varphi(x))\varphi'(x)dx</script><p>when $a=\varphi(\alpha), b=\varphi(\beta)$</p><p>Integration by parts</p><script type="math/tex; mode=display">\int u\ dv=uv-\int v\ du</script><h3 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h3><script type="math/tex; mode=display">\begin{aligned}\int_0^\infty e^{-x^2}dx=\frac{\sqrt{\pi}}{2}\end{aligned}</script><h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><p>Arithmetic series</p><script type="math/tex; mode=display">\begin{aligned}a_n &= a_1+(n-1)d\\\sum_{k=1}^n a_k &= \frac{n(a_1+a_n)}{2}\\&= \frac{n[2a_1+(n-1)d]}{2}\end{aligned}</script><p>Geometric series</p><script type="math/tex; mode=display">\begin{aligned}b_n &= b_1 r^{n-1}\\\sum_{k=1}^n b_k &= \frac{b_1-b_{n+1}}{1-r}\\&= \frac{b_1(1-r^n)}{1-r}\\\end{aligned}</script><p>Others</p><script type="math/tex; mode=display">\begin{aligned}\sum_{k=1}^n \frac{1}{k(k+1)} &= \frac{n}{n+1}\\\sum_{k=1}^n k(k+1) &= \frac{n(n+1)(n+2)}{3}\\\sum_{k=1}^n k^2 &= \frac{n(n+1)(2n+1)}{6}\\\end{aligned}</script><h3 id="Taylor-Expansion"><a href="#Taylor-Expansion" class="headerlink" title="Taylor Expansion"></a>Taylor Expansion</h3><h4 id="Theory-2"><a href="#Theory-2" class="headerlink" title="Theory"></a>Theory</h4><script type="math/tex; mode=display">\begin{aligned}f(x) &= f(x_0)+\sum_{k=1}^\infty\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+R_n(x)\\\end{aligned}</script><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><script type="math/tex; mode=display">\begin{aligned}e^x &= \sum_{k=0}^\infty \frac{x^k}{k!}\\    &= 1+\frac{1}{1!}x+\frac{1}{2!}x^2+o(x^2)\\\frac{1}{1-x} &= \sum_{k=0}^\infty x^k\\    &= 1+x+x^2+o(x^2)\\(1+x)^a &= \sum_{k=0}^\infty \frac{a!}{k!(a-k)!}x^k\\    &= 1+\frac{a}{1!}x+\frac{a(a-1)}{2!}x^2+o(x^2)\\\ln(1+x) &= \sum_{k=1}^\infty (-1)^{k+1}\frac{x^k}{k}\\    &= x-\frac{1}{2}x^2+\frac{1}{3}x^3+o(x^3)\\\sin(x) &= \sum_{k=1}^\infty (-1)^{k+1}\frac{x^{2k-1}}{(2k-1)!}\\    &= x-\frac{1}{3!}x^3+\frac{1}{5!}x^5+o(x^5)\\\cos(x) &= 1+\sum_{k=1}^\infty (-1)^{k}\frac{x^{2k}}{(2k)!}\\    &= 1-\frac{1}{2!}x^2+\frac{1}{4!}x^4+o(x^4)\\e^{jx} &= \cos x+j\sin x\\\end{aligned}</script><h3 id="Fourier-Series"><a href="#Fourier-Series" class="headerlink" title="Fourier Series"></a>Fourier Series</h3><h4 id="Theory-3"><a href="#Theory-3" class="headerlink" title="Theory"></a>Theory</h4><p>Convolution</p><script type="math/tex; mode=display">x(t)*y(t)=\int_{-\infty}^{\infty}y(\tau)x(t-\tau)d\tau</script><p>Complex exponentials as eigenfunctions (A signal for which the output of the system is a constant times the input)</p><script type="math/tex; mode=display">\begin{aligned}y(t)&=\int_{-\infty}^{\infty}h(\tau)x(t-\tau)d\tau\\&=\int_{-\infty}^{\infty}h(\tau)e^{s(t-\tau)}d\tau &x(t)=e^{st}\\&=e^{st}\int_{-\infty}^{\infty}h(\tau)e^{-s\tau}d\tau\end{aligned}</script><p>Thus, we may express</p><script type="math/tex; mode=display">x(t)=\sum_k a_ke^{s_kt}</script><p>If the signal is periodic for T</p><script type="math/tex; mode=display">x(t+T)=x(t)\quad \text{for all }t.</script><p><strong>Complex</strong></p><p>when $T=2\pi/\omega_0$</p><script type="math/tex; mode=display">x(t)=\sum_{k=-\infty}^{+\infty}a_ke^{jk\omega_0t}</script><p>where</p><script type="math/tex; mode=display">a_k=\frac{1}{T}\int_Tx(t)e^{-jk\omega_0t}dt</script><p><strong>Traditional</strong></p><p>when $T=2\pi/\omega_0$</p><script type="math/tex; mode=display">x(t)=\frac{a_0}{2}+\sum_{k=1}^\infty a_k\cos(k\omega_0t)+\sum_{k=1}^\infty b_k\sin(k\omega_0t)</script><p>where</p><script type="math/tex; mode=display">a_k=\frac{2}{T}\int_Tx(t)\cos(k\omega_0t)dt\quad{k=0,1,...}\\b_k=\frac{2}{T}\int_Tx(t)\sin(k\omega_0t)dt\quad{k=1,2,...}</script><h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><p><strong>Periodic square wave</strong></p><p><img src="useful-mathematical-formulas/image-20200207220749852.png" alt="Periodic square wave"></p><script type="math/tex; mode=display">x(t)=\begin{cases}1& kT-\tau/2<t<kT+\tau/2, k=0, \pm1, ...\\0& \text{else}\end{cases}</script><p>we have</p><script type="math/tex; mode=display">a_k=\frac{\tau}{T}\mathrm{Sa}(\frac{k\omega_0\tau}{2})\\\mathrm{Sa}(x)=\frac{\sin x}{x}</script><h3 id="Fourier-Transformation"><a href="#Fourier-Transformation" class="headerlink" title="Fourier Transformation"></a>Fourier Transformation</h3><h4 id="Theory-4"><a href="#Theory-4" class="headerlink" title="Theory"></a>Theory</h4><script type="math/tex; mode=display">X(j\omega)=\int_{-\infty}^\infty x(t)e^{-j\omega t}dt\\x(t)=\int_{-\infty}^\infty X(j\omega)e^{j\omega t}d\omega\\</script><p>Properties</p><ol><li><p>Linearity</p><script type="math/tex; mode=display">ax(t)+by(t)\stackrel{\mathcal{F}}{\longleftrightarrow} aX(j\omega)+bY(j\omega)</script></li><li><p>Time &amp; frequency shifting</p><script type="math/tex; mode=display">x(t-t_0)\stackrel{\mathcal{F}}{\longleftrightarrow} e^{-j\omega t_0}X(j\omega)\\e^{j\omega_0 t}x(t-t_0)\stackrel{\mathcal{F}}{\longleftrightarrow} X(j(\omega-\omega_0))</script></li><li><p>Conjugate symmetry</p><script type="math/tex; mode=display">x^*(t)\stackrel{\mathcal{F}}{\longleftrightarrow} X^*(-j\omega)\\X(-j\omega)=X^*(j\omega)\quad\text{for real }x(t)</script></li><li><p>Differentiation &amp; integration</p><script type="math/tex; mode=display">\frac{dx(t)}{dt}\stackrel{\mathcal{F}}{\longleftrightarrow}j\omega X(j\omega)\\\int_{-\infty}^t x(\tau)d\tau\stackrel{\mathcal{F}}{\longleftrightarrow}\frac{1}{j\omega}X(j\omega)+\pi X(0)\delta(0)</script></li><li><p>Time &amp; frequency scaling</p><script type="math/tex; mode=display">x(at)\stackrel{\mathcal{F}}{\longleftrightarrow} \frac{1}{|a|}X\left(\frac{j\omega}{a}\right)</script></li><li><p>Duality</p><script type="math/tex; mode=display">X(jt)\stackrel{\mathcal{F}}{\longleftrightarrow} 2\pi x(-\omega)</script></li><li><p>Parseval&#39;s relation</p><script type="math/tex; mode=display">\int_{-\infty}^{+\infty}|x(t)|^2dt=\frac{1}{2\pi}|X(j\omega)|^2d\omega</script></li><li><p>Convolution</p><script type="math/tex; mode=display">h(t)*x(t)\stackrel{\mathcal{F}}{\longleftrightarrow}H(j\omega)X(j\omega)\\h(t)x(t)\stackrel{\mathcal{F}}{\longleftrightarrow}\frac{1}{2\pi}H(j\omega)*X(j\omega)</script></li></ol><p><img src="useful-mathematical-formulas/image-20200207224219335.png" alt="Fourier Transformation Properties"></p><h4 id="Fourier-Transformation-for-Periodical-Signals"><a href="#Fourier-Transformation-for-Periodical-Signals" class="headerlink" title="Fourier Transformation for Periodical Signals"></a>Fourier Transformation for Periodical Signals</h4><p>A periodical signal can be expressed in terms of Fourier series as</p><script type="math/tex; mode=display">x(t)=\sum_{k=-\infty}^{+\infty}a_ke^{jk\omega_0t}</script><p>If Fourier transformation is applied to both sides</p><script type="math/tex; mode=display">\begin{aligned}X(j\omega)&=\sum_{k=-\infty}^{+\infty}a_k \mathcal{F}(e^{jk\omega_0t})\\&=2\pi\sum_{k=-\infty}^{+\infty}a_k\delta(\omega-k\omega_0)\end{aligned}</script><p>As a example, we may calculate the Fourier transformation of a periodical pulse signal $\delta_T(t)=\sum_{k=-\infty}^{\infty}\delta(t-kT)$</p><script type="math/tex; mode=display">\mathcal{F}[\delta_T(t)]=\omega_0\sum_{k=-\infty}^{+\infty}\delta(\omega-k\omega_0)</script><h4 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h4><p><strong>Square pulse</strong></p><p><img src="useful-mathematical-formulas/image-20200207221533179.png" alt="Square pulse"></p><script type="math/tex; mode=display">x(t)=\begin{cases}1& -\tau/2<t<\tau/2\\0& \text{else}\end{cases}\\X(j\omega)=\tau\mathrm{Sa}(\frac{\omega\tau}{2})</script><p>we may conclude by comparing with previous example that Fourier series coefficient can be drawn by Fourier transformation with</p><script type="math/tex; mode=display">a_k=\frac{1}{T}X(jk\omega_0)</script><p><img src="useful-mathematical-formulas/image-20200207224359387.png" alt="image-20200207224359387"></p><h3 id="Discrete-Time-Fourier-Transformation"><a href="#Discrete-Time-Fourier-Transformation" class="headerlink" title="Discrete Time Fourier Transformation"></a>Discrete Time Fourier Transformation</h3><script type="math/tex; mode=display">x[n]=\frac{1}{2\pi}\int_{2\pi}X(e^{j\omega})e^{j\omega n}d\omega\\X(e^{j\omega})=\sum_{k=-\infty}^{+\infty}x[n]e^{-j\omega n}</script><p><img src="useful-mathematical-formulas/image-20200208113034426.png" alt="DTFT Properties"></p><p><img src="useful-mathematical-formulas/image-20200208113227348.png" alt="DTFT Examples"></p><h3 id="Laplace-Transformation"><a href="#Laplace-Transformation" class="headerlink" title="Laplace Transformation"></a>Laplace Transformation</h3><script type="math/tex; mode=display">X(s)=\int_{-\infty}^{\infty} x(t)e^{-st}dt\\x(t)=\frac{1}{2\pi j}\int_{\sigma-j\infty}^{\sigma+j\infty} X(s)e^{st}ds</script><p>Region of convergence (ROC) </p><ul><li>The ROC of X(s) consists of <strong>strips parallel</strong> to the $j\omega$-axis in the s-plane.</li><li>For rational Laplace transforms, the ROC does not contain any poles.</li><li>If x(t) is of finite duration and is absolutely integrable, then the ROC is the entire s-plane.</li><li>If x(t) is right sided, and if the line $\mathcal{Re}\{s\}=\sigma_0$ is in the ROC, then all values of s for which $\mathcal{Re}\{s\}&gt;\sigma_0$ will also be in the ROC.</li><li>If x(t) is left sided, and if the line $\mathcal{Re}\{s\}=\sigma_0$ is in the ROC, then all values of s for which $\mathcal{Re}\{s\}&lt;\sigma_0$ will also be in the ROC.</li><li>If x(t) is two sided, and if the line $\mathcal{Re}\{s\}=\sigma_0$ is in the ROC, then the ROC will consist of a strip in the s-plane that includes the line $\mathcal{Re}\{s\}=\sigma_0$.</li><li>If the Laplace transform X(s) of x(t) is rational, then its ROC is bounded by poles or extends to infinity. In addition, no poles of X(s) are contained in the ROC.</li><li>If the Laplace transform X(s) of x(t) is rational, then:<ul><li>If x(t) is <strong>right sided</strong>, the ROC is the region in the s-plane <strong>to the right of the rightmost pole</strong>. </li><li>If x(t) is <strong>left sided</strong>, the ROC is the region in the s-plane <strong>to the left of the leftmost pole</strong>.</li></ul></li></ul><p>Note on expansion, for</p><script type="math/tex; mode=display">F(s)=\frac{B(s)}{A(s)}=\frac{b_n s^n+...+b_1s+b_0}{a_ms^m+...+a_1s+a_0}</script><p>we need to solve the roots of $A(s)=0$</p><ul><li><p>For single root</p><script type="math/tex; mode=display">F(s)=\sum_{i=1}^{n} \frac{K_i}{s-s_i}</script><p>where</p><script type="math/tex; mode=display">K_i=\lim_{s\to s_i}(s-s_i)\frac{B(s)}{A(s)}\\=\frac{B(s_i)}{A'(s_i)}</script></li><li><p>For conjugate roots</p><script type="math/tex; mode=display">\begin{aligned}F(s)&=\frac{B(s)}{(s-s_1)(s-s_1^*)A(s)}\\&=\frac{K_1}{s-s_1}+\frac{K_2}{s-s_1^*}+\frac{B_2(s)}{A_2(s)}\end{aligned}</script><p>where</p><script type="math/tex; mode=display">K_1=K_2^*</script></li><li><p>For multiple roots</p><script type="math/tex; mode=display">\begin{aligned}F(s)&=\frac{B(s)}{(s-s_1)^rA(s)}\\&=\frac{K_{11}}{(s-s_1)^r}+...+\frac{K_{1r}}{s-s_1}+\frac{B_2(s)}{A_2(s)}\end{aligned}</script><p>where</p><script type="math/tex; mode=display">K_{1i}=\frac{1}{(i-1)!}\frac{d^{i-1}}{ds^{i-1}}[(s-s_i)^rF(s)]\bigg|_{s=s_i}</script></li></ul><p><img src="useful-mathematical-formulas/image-20200208121007641.png" alt="Laplace Transformation Properties"></p><p><img src="useful-mathematical-formulas/image-20200208121115660.png" alt="Laplace Transformation Examples"></p><h3 id="Z-Transformation"><a href="#Z-Transformation" class="headerlink" title="Z Transformation"></a>Z Transformation</h3><script type="math/tex; mode=display">X(z)=\sum_{k=-\infty}^{+\infty} x[n]z^{-n}\\x[n]=\frac{1}{2\pi j}\oint X(z)z^{n-1}dz</script><p>ROC</p><ul><li>The ROC of X(z) consists of a <strong>ring</strong> in the z-plane centered about the origin.</li><li>The ROC does not contain any poles.</li><li>If $x[n]$ is of finite duration, then the ROC is the entire z-plane, except possibly $z=0 $ and/or $z=\infty$.</li><li>If $x[n]$ is a right-sided sequence, and if the circle $|z|=r_0$ is in the ROC, then all finite values of z for which $|z|&gt;r_0$ will also be in the ROC.</li><li>If $x[n]$ is a left-sided sequence, and if the circle $|z|=r_0$ is in the ROC, then all finite values of z for which $|z|&lt;r_0$ will also be in the ROC.</li><li>If $x[n]$ is two sided, and if the circle $|z|=r_0$ is in the ROC, then the ROC will consist of a ring in the z-plane that includes the circle $|z|=r_0$.</li><li>If the z-transform $X(z)$ of $x[n]$ is rational, then its ROC is bounded by poles or extends to infinity.</li><li>If the z-transform $X(z)$ of $x[n]$ is rational,<ul><li>If $x[n]$ is <strong>right sided</strong>, then the ROC is the region in the z-plane <strong>outside the outermost pole</strong>. Furthermore, if $x[n]$ is causal, then the ROC also includes $z=\infty$.</li><li>If $x[n]$ is <strong>left sided</strong>, then the ROC is the region in the z-plane <strong>inside the innermost nonzero pole</strong>. Furthermore, if $x[n]$ is anti-causal, then the ROC also includes $z=0$.</li></ul></li></ul><p><img src="useful-mathematical-formulas/image-20200208154800565.png" alt="Z-Transform Properties"></p><p><img src="useful-mathematical-formulas/image-20200208154652115.png" alt="Z-Transform Examples"></p><h3 id="Discrete-Fourier-Transformation"><a href="#Discrete-Fourier-Transformation" class="headerlink" title="Discrete Fourier Transformation"></a>Discrete Fourier Transformation</h3><script type="math/tex; mode=display">X(k)=\sum_{n=0}^{N-1} x(n)e^{-j2\pi kn/N}\\x(n)=\frac{1}{N}\sum_{k=0}^{N-1} X(k)e^{j2\pi kn/N}</script><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>管致中, et al. <em>信号与线性系统，第五版</em>.</li><li>Alan V. Oppenheim, et al. <em>Signals and Systems, Second Edition</em>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Current Mirror and Bandgap</title>
      <link href="/archives/eff29f15/current-mirror-and-bandgap.html"/>
      <url>/archives/eff29f15/current-mirror-and-bandgap.html</url>
      
        <content type="html"><![CDATA[<p>This article intends to introduce the basic concepts of current mirrors and the bandgap reference.</p><a id="more"></a><h2 id="Basic-Current-Mirrors"><a href="#Basic-Current-Mirrors" class="headerlink" title="Basic Current Mirrors"></a>Basic Current Mirrors</h2><p>Shortcomings of voltage biasing:</p><ul><li>Sensitive to threshold voltage variation</li><li>Temperature dependence</li><li>Rely on the precision of $V_{DD}$</li></ul><p>Use of current for biasing may eliminate those problems. Use of identical MOS operating in saturation may suffice.</p><p><img src="current-mirror-and-bandgap/image-20200206172547720.png" alt="Basic Current Source"></p><p>Here we have</p><script type="math/tex; mode=display">I_{REF}=\frac{1}{2}\mu_nC_{ox}\left(\frac{W}{L}\right)_1(V_{GS}-V_{TH})^2\\I_{out}=\frac{1}{2}\mu_nC_{ox}\left(\frac{W}{L}\right)_2(V_{GS}-V_{TH})^2</script><p>and thus</p><script type="math/tex; mode=display">I_{out}=\frac{(W/L)_2}{(W/L)_1}I_{REF}</script><p>The transistor on the left generate $V_{GS}$ from $I_{REF}$ when and only when it is configured as a diode.</p><p>Note that:</p><ul><li>Mirror transistor should have the <strong>same length</strong> as the operating transistor to minimize mismatch.</li><li>Mirror transistor should have the <strong>same width</strong> as the operating transistor to reduce errors caused by the poorly defined gate sides (Number of fingers and devices may be changed).</li></ul><p>We can connect current mirrors in series as to modify the equivalent length of the transistor as follows:</p><p><img src="current-mirror-and-bandgap/image-20200206174112332.png" alt="Current Mirror in Series"></p><h2 id="Cascaded-Current-Mirror"><a href="#Cascaded-Current-Mirror" class="headerlink" title="Cascaded Current Mirror"></a>Cascaded Current Mirror</h2><p>If we consider channel-length modulation, the equations may be rewritten as</p><script type="math/tex; mode=display">I_{REF}=\frac{1}{2}\mu_nC_{ox}\left(\frac{W}{L}\right)_1(V_{GS}-V_{TH})^2(1+\lambda V_{DS1})\\I_{out}=\frac{1}{2}\mu_nC_{ox}\left(\frac{W}{L}\right)_2(V_{GS}-V_{TH})^2(1+\lambda V_{DS2})</script><p>and thus</p><script type="math/tex; mode=display">I_{out}=\frac{(W/L)_2}{(W/L)_1}\cdot \frac{1+\lambda V_{DS2}}{1+\lambda V_{DS1}}I_{REF}</script><p>while $V_{DS1}=V_{GS1}=V_{GS2}$, $V_{DS1}$ may not equal to $V_{DS2}$. We may introduce the Cascode structure to shield the variation at node Y from that at node P</p><h3 id="Approach-1"><a href="#Approach-1" class="headerlink" title="Approach 1"></a>Approach 1</h3><p><img src="current-mirror-and-bandgap/image-20200206174745873.png" alt="Cascode Current Source"></p><p>We need</p><script type="math/tex; mode=display">V_{DS2}=V_{GS2}</script><p>and thus</p><script type="math/tex; mode=display">V_b=V_{GS3}+V_{DS2}=V_{GS3}+V_{GS2}=V_{GS3}+V_{GS1}</script><p>We surmise that $V_b$ can be achieved by cascading two current sources, as in (c), as long as</p><script type="math/tex; mode=display">V_{GS0}+V_{GS1}=V_{GS3}+V_{GS1}</script><p>or</p><script type="math/tex; mode=display">V_{GS0}=V_{GS3}</script><p>Generally, we have</p><ul><li>$L_0=L_3$ to the lowest possible value to save area</li><li>$W_3/W_0=W_2/W_1$ for $V_{GS0}=V_{GS3}$</li><li>$L_1=L_2$ may be longer to reduce channel-length modulation and the flicker noise</li></ul><p>The minimal allowable voltage at Node P is two overdrive voltage plus one threshold voltage.</p><h3 id="Approach-2"><a href="#Approach-2" class="headerlink" title="Approach 2"></a>Approach 2</h3><p><img src="current-mirror-and-bandgap/image-20200206205631025.png" alt="IR Drop"></p><p>In order to save voltage headroom, we may set $V_b$ to a lower value of</p><script type="math/tex; mode=display">V_b=V_{DS2}+V_{GS3}=V_{GS2}-V_{TH1}+V_{GS1}</script><p>And therefore, we need to reduce $V_{DS1}$ to the value of $V_{DS2}$. A resistor is added to cause such a voltage drop</p><script type="math/tex; mode=display">V_{TH}=I_{REF}R_1</script><p>Definition of $V_b$ may be realized as in figure (c), where </p><script type="math/tex; mode=display">\begin{aligned}V_{GS5}=V_{GS3}&\\V_{GS6}-R_6I_6&=V_{GS1}-V_{TH1}\\&=V_{GS1}-R_1I_{IREF}\end{aligned}</script><p>A further modification can be made to address the PVT problem</p><p><img src="current-mirror-and-bandgap/image-20200206210959043.png" alt="Modification of Cascode Mirror"></p><p>Here, $V_b$ can be chosen to place M1 at the edge of saturation. Note that if $V_{GS0}=V_{GS3}$, then $V_{DS2}$ is forced to be equal to $V_{DS1}$. The range of $V_b$ can be determined as</p><script type="math/tex; mode=display">V_{GS1}-V_{TH1}\le V_b-V_{GS0}\\V_{b}-V_{TH0}\le V_{GS1}</script><p>Hence $V_{GS0}-V_{TH0}&lt;V_{TH1}$, and M0 should be large enough. Two methods can be used to generate $V_b$</p><p><img src="current-mirror-and-bandgap/image-20200206212746379.png" alt="Generation of Vb"></p><h2 id="Active-Current-Mirror"><a href="#Active-Current-Mirror" class="headerlink" title="Active Current Mirror"></a>Active Current Mirror</h2><p><img src="current-mirror-and-bandgap/image-20200206221309473.png" alt="Active Current Mirror"></p><p><img src="current-mirror-and-bandgap/image-20200206221502249.png" alt="Active Current Mirror, Rout"></p><p>We have</p><script type="math/tex; mode=display">\begin{aligned}G_m&=-g_{m1}r_{o1}\frac{g_{m4}r_d+1}{r_d+2r_{o1}}\\&\approx g_m\\R_{out}&=\frac{(1+g_{m4}r_d)r_{o4}+2r_{o1}+r_d}{(2r_{o1}+r_d)r_{o4}}\\&\approx r_{o2}||r_{o4}\\\\r_d&=r_{o3}||(1/g_{m3})\end{aligned}</script><h2 id="Supply-Independent-Biasing"><a href="#Supply-Independent-Biasing" class="headerlink" title="Supply-Independent Biasing"></a>Supply-Independent Biasing</h2><p><img src="current-mirror-and-bandgap/image-20200207103827505.png" alt="Supply-Independent Biasing"></p><p>For (a)</p><script type="math/tex; mode=display">\begin{aligned}&\sqrt{\frac{2I_{out}}{\mu_nC_{ox}(W/L)_N}}+V_{TH1}\\=&\sqrt{\frac{2I_{out}}{\mu_nC_{ox}K(W/L)_N}}+V_{TH2}+I_{out}R_s\end{aligned}</script><p>and hence</p><script type="math/tex; mode=display">I_{out}=\frac{2}{\mu_nC_{ox}(W/L)_N}\cdot\frac{1}{R_S^2}\left(1-\frac{1}{\sqrt{K}}\right)^2</script><p>Relatively long channels are used for all of the transistors in the circuit to avoid channel-length modulation. Another issue is the existence of &quot;degenerate&quot; bias point, where all transistors carry zero current.</p><p><img src="current-mirror-and-bandgap/image-20200207105425058.png" alt="Solution of the Start-Up Problem"></p><p>The “start-up” problem can be resolved by adding a mechanism that drives the circuit out of the degenerate bias point when the supply is turned on. Diode M3, M5, and M1 in series from VDD to GND could effectively prevent off states.</p><h2 id="Temperature-Independent-References"><a href="#Temperature-Independent-References" class="headerlink" title="Temperature-Independent References"></a>Temperature-Independent References</h2><h3 id="Negative-TC-Voltage"><a href="#Negative-TC-Voltage" class="headerlink" title="Negative-TC Voltage"></a>Negative-TC Voltage</h3><p>For a bipolar device</p><script type="math/tex; mode=display">\begin{aligned}I_C&=I_S\exp(\frac{V_{BE}}{V_T})\\V_{BE}&=V_T\ln\frac{I_C}{I_S}\\V_T&=\frac{kT}{q} &\text{Thermal Voltage}\\I_S&\propto\mu kTn_i^2 &\text{Saturation Current}\\\mu&\propto\mu_0T^m &\text{Minor Carrier Mobility}\\n_i^2&\propto T^3\exp(-\frac{E_g}{kT}) &\text{Intrinsic Carrier Concentration}\\E_g&\approx 1.12\text{eV} &\text{Bandgap Energy}\end{aligned}</script><p>We may derive (assume for now that $I_C$ is held constant)</p><script type="math/tex; mode=display">\begin{aligned}\frac{\partial V_{BE}}{\partial T}&=\frac{\partial V_T}{\partial T}\ln\frac{I_C}{I_S}-\frac{V_T}{I_S}\frac{\partial I_S}{\partial T}\\&=\frac{V_{BE}-(4+m)V_T-E_g/q}{T}\end{aligned}</script><p>Temperature coefficient of $V_{BE}$ itself depends on the temperature, creating error in constant reference generation if the positive-TC quantity exhibits a constant temperature coefficient.</p><h3 id="Positive-TC-Voltage"><a href="#Positive-TC-Voltage" class="headerlink" title="Positive-TC Voltage"></a>Positive-TC Voltage</h3><p>If two bipolar transistors operate at unequal current densities, then the difference between their base-emitter voltages is directly proportional to the absolute temperature.</p><p><img src="current-mirror-and-bandgap/image-20200207113011408.png" alt="PTAT"></p><script type="math/tex; mode=display">\begin{aligned}\Delta V_{BE}&=V_{BE1}-V_{BE2}\\&=V_T\ln\frac{nI_0}{I_{S1}}-V_T\ln\frac{I_0}{I_{S2}}\\&=V_T\ln n\\\frac{\partial \Delta V_{BE}}{\partial T}&=\frac{k}{q}\ln n\end{aligned}</script><h3 id="Bandgap-Reference"><a href="#Bandgap-Reference" class="headerlink" title="Bandgap Reference"></a>Bandgap Reference</h3><p>Since at room temperature, $\partial V_{BE}/\partial T\approx−1.5\text{ mV/K}$ whereas $\partial V_{T}/\partial T\approx+0.087\text{ mV/K}$, hence $V_{REF}\approx V_{BE}+17.2V_T\approx1.25\text{ V}$.we can add the two as follows</p><p><img src="current-mirror-and-bandgap/image-20200207113934386.png" alt="image-20200207113934386"></p><p>If we guarantee that $V_{O1}=V_{O2}$, then $RI=V_{BE1}-V_{BE2}=V_T\ln n$, and then $V_{O2}=V_{BE2}+V_T\ln n$. Yet, since $V_{O2}=V_{O1}\approx800\text{ mV}&lt;1.25\text{ V}$, it cannot work as expected.</p><p><img src="current-mirror-and-bandgap/image-20200207114827889.png" alt="Actual Bandgap"></p><script type="math/tex; mode=display">V_{out}=V_{BE2}+\frac{V_T\ln n}{R_3}(R_3+R_2)</script><ol><li>The op-amp ensures that $V_X=V_Y$</li><li>$R_1=R_2$ and $V_X=V_Y$ ensures that $I_1=I_2$</li><li>$V_Y$ is amplified before being added to $V_{BE2}$, hence voltage difference of $V_Y$ and $V_{O2}$ can be small</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Feedback System Analysis</title>
      <link href="/archives/b4b2824b/feedback-system-analysis.html"/>
      <url>/archives/b4b2824b/feedback-system-analysis.html</url>
      
        <content type="html"><![CDATA[<p>This article intends to deal with the analysis of feedback systems.</p><a id="more"></a><h2 id="General-Consideration"><a href="#General-Consideration" class="headerlink" title="General Consideration"></a>General Consideration</h2><p>A negative feedback system is as follows</p><p><img src="feedback-system-analysis/image-20200202104911089.png" alt="Feedback System Diagram"></p><script type="math/tex; mode=display">Y(s)=H(s)[X(s)-G(s)Y(s)]</script><p>Reorganize the items, we have</p><script type="math/tex; mode=display">\frac{Y(s)}{X(s)}=\frac{H(s)}{1+G(s)H(s)}</script><p>$H(s)$ is called the open-loop gain, while $H(s)G(s)$ is called the loop gain, and $Y(s)/X(s)$ is called the closed-loop transfer function. The loop gain can be obtained by</p><ol><li>Set the main input to zero</li><li>Break the loop at some point</li><li>Inject a test signal in the correct direction</li><li>Follow the loop and obtain the value that returns to the break point</li><li>The negative of the transfer function is the loop gain</li></ol><p>Assume $H(s)=A, G(s)=\beta$, we have</p><script type="math/tex; mode=display">\frac{Y}{X}=\frac{A}{1+\beta A}\approx\frac{1}{\beta}\left(1-\frac{1}{\beta A}\right)</script><p>Thus, for negative-feedback system, as long as $\beta A$ is large enough, the closed loop gain is determined by the feedback coefficient. </p><ol><li>Bandwidth: for one pole gain $A(s)=\frac{A_0}{1+s/\omega_0}$, the transfer function is $Y(s)/X(s)=\frac{A_0/(1+\beta A_0)}{1+s/[(1+\beta A_0)\omega_0]}$, and thus the bandwidth is extended by the loop gain, leaving the GBW unchanged.</li><li>Nonlinearity: reduced</li></ol><h3 id="Types-of-Amplifiers"><a href="#Types-of-Amplifiers" class="headerlink" title="Types of Amplifiers"></a>Types of Amplifiers</h3><p><img src="feedback-system-analysis/image-20200202151953719.png" alt="Different Types of Amplifiers"></p><p>Corresponding implementation</p><p><img src="feedback-system-analysis/image-20200202152019116.png" alt="Amplifier Implementation"></p><h3 id="Sensing-and-Return-Mechanism"><a href="#Sensing-and-Return-Mechanism" class="headerlink" title="Sensing and Return Mechanism"></a>Sensing and Return Mechanism</h3><p><img src="feedback-system-analysis/image-20200202152331664.png" alt="Sensing and Return Mechanism"></p><h2 id="Input-and-Output-Impedance"><a href="#Input-and-Output-Impedance" class="headerlink" title="Input and Output Impedance"></a>Input and Output Impedance</h2><h3 id="Voltage-Voltage-Feedback"><a href="#Voltage-Voltage-Feedback" class="headerlink" title="Voltage-Voltage Feedback"></a>Voltage-Voltage Feedback</h3><p><img src="feedback-system-analysis/image-20200202155744999.png" alt="Voltage-Voltage Feedback"></p><p>For the output impedance</p><p><img src="feedback-system-analysis/image-20200202153458328.png" alt="Voltage-Voltage Feedback, Output Impedance"></p><p>Assume that feedback network draws no current</p><script type="math/tex; mode=display">Z_{out}=\frac{R_{out}}{1+\beta A_0}</script><p>For the input impedance</p><p><img src="feedback-system-analysis/image-20200202155154340.png" alt="Voltage-Voltage Feedback, Input Impedance"></p><script type="math/tex; mode=display">Z_{in}=R_{in}(1+\beta A_0)</script><h3 id="Current-Voltage-Feedback"><a href="#Current-Voltage-Feedback" class="headerlink" title="Current-Voltage Feedback"></a>Current-Voltage Feedback</h3><p><img src="feedback-system-analysis/image-20200202155838010.png" alt="Current-Voltage Feedback"></p><script type="math/tex; mode=display">\frac{I_{out}}{V_{in}}=\frac{G_m}{1+G_mR_F}</script><p>For the output impedance</p><p><img src="feedback-system-analysis/image-20200202160503455.png" alt="Current-Voltage Feedback, Output Impedance"></p><script type="math/tex; mode=display">Z_{out}=R_{out}(1+G_mR_F)</script><p>For the input impedance</p><p><img src="feedback-system-analysis/image-20200202160735839.png" alt="Current-Voltage Feedback, Input Impedance"></p><script type="math/tex; mode=display">Z_{in}=R_{in}(1+G_mR_F)</script><h3 id="Voltage-Current-Feedback"><a href="#Voltage-Current-Feedback" class="headerlink" title="Voltage-Current Feedback"></a>Voltage-Current Feedback</h3><p><img src="feedback-system-analysis/image-20200202160851320.png" alt="Voltage-Current Feedback"></p><script type="math/tex; mode=display">\frac{V_{out}}{I_{in}}=\frac{R_0}{1+g_{mF}R_0}</script><p><img src="feedback-system-analysis/image-20200202161308382.png" alt="Voltage-Current Feedback, Impedance Calculation"></p><p>For the output impedance</p><script type="math/tex; mode=display">Z_{out}=\frac{R_{out}}{1+g_{mF}R_0}</script><p>For the input impedance</p><script type="math/tex; mode=display">Z_{in}=\frac{R_{in}}{1+g_{mF}R_0}</script><p>This topology has application in fiber optic receivers, where light is converted to electrical current through a reverse-biased diode. A transimpedance amplifier (TIA) is adopted to convert this current signal into voltage signal.</p><h3 id="Current-Current-Feedback"><a href="#Current-Current-Feedback" class="headerlink" title="Current-Current Feedback"></a>Current-Current Feedback</h3><p><img src="feedback-system-analysis/image-20200202162606653.png" alt="Current-Current Feedback"></p><script type="math/tex; mode=display">\frac{I_{out}}{I_{in}}=\frac{A_I}{1+\beta A_I}</script><p>For the output impedance</p><script type="math/tex; mode=display">Z_{out}=R_{out}(1+\beta A_I)</script><p>For the input impedance</p><script type="math/tex; mode=display">Z_{in}=\frac{R_{in}}{1+\beta A_I}</script><h2 id="Limitations-of-the-Simple-Analysis"><a href="#Limitations-of-the-Simple-Analysis" class="headerlink" title="Limitations of the Simple Analysis"></a>Limitations of the Simple Analysis</h2><p>What is loading effect?</p><p>The non-ideal input and output impedance of the feedback network could degrade the open-loop gain.</p><p><img src="feedback-system-analysis/image-20200202163838861.png" alt="Feedback Analysis Difficulties"></p><p>Possible methods</p><p><img src="feedback-system-analysis/image-20200202163927564.png" alt="Possible Analysis Methods"></p><h2 id="Two-Port-Models"><a href="#Two-Port-Models" class="headerlink" title="Two Port Models"></a>Two Port Models</h2><p><img src="feedback-system-analysis/image-20200202164746413.png" alt="Z, Y, H, and G Models"></p><p>Z</p><script type="math/tex; mode=display">\left\{\begin{aligned}V_1=Z_{11}I_1+Z_{12}I_2\\V_2=Z_{21}I_1+Z_{22}I_2\end{aligned}\right.</script><p>Y</p><script type="math/tex; mode=display">\left\{\begin{aligned}I_1=Y_{11}V_1+Y_{12}V_2\\I_2=Y_{21}V_1+Y_{22}V_2\end{aligned}\right.</script><p>H</p><script type="math/tex; mode=display">\left\{\begin{aligned}V_1=H_{11}I_1+H_{12}V_2\\I_2=H_{21}I_1+H_{22}V_2\end{aligned}\right.</script><p>G</p><script type="math/tex; mode=display">\left\{\begin{aligned}I_1=G_{11}V_1+G_{12}I_2\\V_2=G_{21}V_1+G_{22}I_2\end{aligned}\right.</script><h3 id="Voltage-Voltage-Feedback-1"><a href="#Voltage-Voltage-Feedback-1" class="headerlink" title="Voltage-Voltage Feedback"></a>Voltage-Voltage Feedback</h3><p><img src="feedback-system-analysis/image-20200202170352273.png" alt="Voltage-Voltage Feedback, using G Model"></p><p>We have</p><script type="math/tex; mode=display">\begin{aligned}\frac{V_{out}}{V_{in}}&=\frac{A_0}{(1+\frac{g_{22}}{Z_{in}})(1+g_{11}Z_{out})+g_{21}A_0}\\&=\frac{A_{v,open}}{1+g_{21}A_{v,open}}\end{aligned}\\A_{v,open}=\frac{A_0}{(1+\frac{g_{22}}{Z_{in}})(1+g_{11}Z_{out})}\\g_{11}=\frac{I_1}{V_1}\bigg|_{I2=0}\\g_{22}=\frac{V_1}{I_1}\bigg|_{V1=0}</script><p>For that matter, the $A_{v,open}$ should be calculated using the configuration</p><p><img src="feedback-system-analysis/image-20200202221535275.png" alt="Voltage-Voltage Feedback, Open-Loop Gain Calculation"></p><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>To calculate the gain with the loading effect, the procedure is as follows:</p><ol><li>Open the loop with proper loading and calculate the open-loop gain $A_{OL}$</li><li>Determine the feedback ratio $\beta$</li><li>Calculate the closed-loop gain with $A_{OL}/(1+\beta A_{OL})$</li></ol><p><img src="feedback-system-analysis/image-20200202222500796.png" alt="Summary of Open-Loop Gain Calculation"></p><h2 id="Bode-39-s-Analysis"><a href="#Bode-39-s-Analysis" class="headerlink" title="Bode&#39;s Analysis"></a>Bode&#39;s Analysis</h2><p><img src="feedback-system-analysis/image-20200202225215467.png" alt="Bode&#39;s Analysis"></p><script type="math/tex; mode=display">\left\{\begin{aligned}V_{out}&=AV_{in}+BI_1\\V_1&=CV_{in}+DI_1\end{aligned}\right.</script><p>Assume $I_1=g_mV_1$, we have</p><script type="math/tex; mode=display">\frac{V_{out}}{V_{in}}=A+\frac{g_mBC}{1-g_mD}</script><p>The return ratio (RR) is defined as $-g_mD$.</p><p>The procedure</p><ol><li>Disable the transistor and by setting $g_m=0$ and obtain A and C</li><li>Set input to zero and calculate B and D</li><li>Solve the $A_v$ with above equations</li></ol><h3 id="Blackman-39-s-Theorem"><a href="#Blackman-39-s-Theorem" class="headerlink" title="Blackman&#39;s Theorem"></a>Blackman&#39;s Theorem</h3><p><img src="feedback-system-analysis/image-20200202230918390.png" alt="Blackman&#39;s Theorem"></p><script type="math/tex; mode=display">\left\{\begin{aligned}V_{in}&=AI_{in}+BI_1\\V_1&=CI_{in}+DI_1\end{aligned}\right.</script><p>It follows that</p><script type="math/tex; mode=display">\frac{V_{out}}{I_{in}}=A+\frac{g_mBC}{1-g_mD}</script><p>If we define two quantities</p><script type="math/tex; mode=display">T_{oc}=-g_m\frac{V_1}{I_1}\bigg|_{I_{in}=0}=-g_mD\\T_{sc}=-g_m\frac{V_1}{I_1}\bigg|_{V_{in}=0}=-g_m\frac{AD-BC}{A}</script><p>And therefore</p><script type="math/tex; mode=display">Z_{in}=\frac{V_{out}}{I_{in}}=A\frac{1+T_{sc}}{1+T_{oc}}</script><h2 id="Stability-Consideration"><a href="#Stability-Consideration" class="headerlink" title="Stability Consideration"></a>Stability Consideration</h2><p>Consider again the closed-loop transfer function</p><script type="math/tex; mode=display">\frac{Y(s)}{X(s)}=\frac{H(s)}{1+G(s)H(s)}</script><p>If $G(s)H(s)=-1$, the gain goes to infinity. This is the condition of instability, which can be equivalently expressed as</p><script type="math/tex; mode=display">|\beta H(j\omega_1)|=1\\\angle\beta H(j\omega_1)=-180^\circ</script><p>which are called “Barkhausen’s Criteria.” We introduce several notions:</p><ul><li>Gain Crossover Frequency: The frequency when open-loop gain reduces to 1 (0 dB), denoted as <strong>GX</strong>.</li><li>Phase Crossover Frequency: The frequency when the phase of open-loop gain reduces to $-180^\circ$, denoted as <strong>PX</strong>.</li><li>Phase Margin: Defined as $180^\circ+\angle\beta H (f=GX)$, denoted as <strong>PM</strong>.</li></ul><p>If $\text{PM}=60^\circ$, we have</p><script type="math/tex; mode=display">\left|\frac{Y(s)}{X(s)}\right|=\frac{H(s)}{\left|1+\exp(-j\frac{2\pi}{3})\right|}=H(s)=\frac{1}{G(s)}</script><p>There will be negligible frequency peaking.</p>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用Linux命令</title>
      <link href="/archives/c49a4fe0/Linux-command.html"/>
      <url>/archives/c49a4fe0/Linux-command.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了常用的Linux命令<br><a id="more"></a></p><h2 id="查找帮助"><a href="#查找帮助" class="headerlink" title="查找帮助"></a>查找帮助</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看说明man（Manual）</span></span><br><span class="line">man ls</span><br><span class="line"><span class="comment"># 查看详解info（Information）</span></span><br><span class="line">info ls</span><br><span class="line"><span class="comment"># --help 选项，提供简短介绍</span></span><br><span class="line">ls --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><h2 id="文件和文件夹管理"><a href="#文件和文件夹管理" class="headerlink" title="文件和文件夹管理"></a>文件和文件夹管理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pwd（Print Working Directory）显示当前工作目录</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cd（Change Directory）进入指定目录</span></span><br><span class="line"><span class="built_in">cd</span> newFolder</span><br><span class="line"></span><br><span class="line"><span class="comment"># mv（Move）</span></span><br><span class="line"><span class="comment"># -f 如果目标文件已经存在，不会询问而直接覆盖（force）</span></span><br><span class="line"><span class="comment"># -i 若目标文件已经存在时，会询问是否覆盖</span></span><br><span class="line"><span class="comment"># -u 若目标文件已经存在，源文件比较新，才会覆盖（update）</span></span><br><span class="line">mv -i sourceFile destFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># cp（Copy）</span></span><br><span class="line"><span class="comment"># -i 若目标档已经存在时，在覆盖时会先询问</span></span><br><span class="line"><span class="comment"># -r 递归持续复制，用于目录的复制</span></span><br><span class="line"><span class="comment"># -u 若目标文件已经存在，源文件比较新，才会覆盖（update）</span></span><br><span class="line">cp -i sourceFile destFile</span><br><span class="line">cp -ir sourceDir destDir</span><br><span class="line"></span><br><span class="line"><span class="comment"># rm（Remove）</span></span><br><span class="line"><span class="comment"># -i 操作前会先询问</span></span><br><span class="line"><span class="comment"># -r 递归持续删除</span></span><br><span class="line">rm tmpFile</span><br><span class="line">rm -r tmpDir</span><br><span class="line"></span><br><span class="line"><span class="comment"># mkdir（Make Directory）创建目录</span></span><br><span class="line"><span class="comment"># -p 递归创建目录</span></span><br><span class="line">mkdir newFolder</span><br><span class="line">mkdir -p newFolder/newFolder2</span><br><span class="line"></span><br><span class="line"><span class="comment"># rmdir（Remove Directory）删除目录</span></span><br><span class="line"><span class="comment"># 必须目录为空</span></span><br><span class="line"><span class="comment"># -p 递归删除目录</span></span><br><span class="line">rmdir newFolder</span><br><span class="line">rmdir -p newFolder/newFolder2</span><br><span class="line"></span><br><span class="line"><span class="comment"># ls（List）查看当前目录下的文件和目录</span></span><br><span class="line"><span class="comment"># -l 使用长列表模式，列出更多细节</span></span><br><span class="line"><span class="comment"># -a 查看所有文件，包括以.开头的隐藏文件</span></span><br><span class="line">ls -la</span><br><span class="line"></span><br><span class="line"><span class="comment"># echo（Echo）</span></span><br><span class="line"><span class="built_in">echo</span> hello world</span><br><span class="line"></span><br><span class="line"><span class="comment"># stat（Status）查看文件或者文件系统的状态</span></span><br><span class="line"><span class="built_in">stat</span> tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># touch（Touch）修改文件或目录的时间</span></span><br><span class="line"><span class="comment"># -a 仅更改读取时间</span></span><br><span class="line"><span class="comment"># -m 仅更改修改时间</span></span><br><span class="line"><span class="comment"># -d 使用指定的日期更改，而非当前时间</span></span><br><span class="line"><span class="comment"># 修改"所有时间属性"为当前系统时间</span></span><br><span class="line">touch tmpFile</span><br><span class="line"><span class="comment"># 修改"读取时间"为当前系统时间</span></span><br><span class="line">touch -a tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># ln（Link）创建连接</span></span><br><span class="line"><span class="comment"># 硬链接，多个文件名指向同一索引节点(Inode)，只能针对文件，可以防止误删（只要有一个索引，文件就不会被删除）</span></span><br><span class="line">ln destFile sourceFile</span><br><span class="line"><span class="comment"># 软链接，是普通文件，数据块中存放的内容是另一文件的路径名的指向</span></span><br><span class="line">ln -s destFile sourceFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># cat（concatenate）由第一行开始显示文件内容</span></span><br><span class="line"><span class="comment"># -n 列印出行号，连同空白行也会有行号</span></span><br><span class="line">cat tmpFile</span><br><span class="line">cat sourceFile1 sourceFile2 &gt; destFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># tac 从最后一行开始显示文件内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># head 取出文件前面几行</span></span><br><span class="line">head -n 5 tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># tail 取出文件后面几行</span></span><br><span class="line">tail -n 5 tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># find</span></span><br><span class="line"><span class="comment"># 将目前目录及其子目录下名称为tmpFile的文件列出来。</span></span><br><span class="line">find . -name tmpFile</span><br></pre></td></tr></table></figure><h2 id="高级文本处理"><a href="#高级文本处理" class="headerlink" title="高级文本处理"></a>高级文本处理</h2><h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><div class="table-container"><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>^</td><td>匹配字符串开头</td></tr><tr><td>$</td><td>匹配字符串结尾</td></tr><tr><td>.</td><td>匹配除了换行符的任意字符</td></tr><tr><td>[...]</td><td>匹配[]中的任意一个字符，例如[a-zA-Z]</td></tr><tr><td><sup><a href="#fn_..." id="reffn_...">...</a></sup></td><td>匹配不在[]中的任意一个字符，例如</td></tr><tr><td>re*</td><td>匹配0个或多个表达式</td></tr><tr><td>re+</td><td>匹配1个或多个表达式</td></tr><tr><td>re?</td><td>匹配0个或1个表达式</td></tr><tr><td>re{n}</td><td>精确匹配n个前面表达式</td></tr><tr><td>re{n,}</td><td>匹配前面表达式至少n个</td></tr><tr><td>re{m, n}</td><td>匹配m到n个前面表达式</td></tr><tr><td>a&#124;b</td><td>匹配a或者b</td></tr><tr><td>(re)</td><td>分组</td></tr></tbody></table></div><p>需要转义的字符有<code>$ ( ) * . [ ] ? { } ^ |</code> </p><h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># grep (Globally search a Regular Expression and Print)</span></span><br><span class="line"><span class="comment"># 用于匹配、查找</span></span><br><span class="line"><span class="comment"># -E 开启扩展（Extend）的正则表达式,&#123;&#125;和？等不需要转义</span></span><br><span class="line"><span class="comment"># -n 显示行号</span></span><br><span class="line"><span class="comment"># -v 只打印没有匹配的，而匹配的反而不打印(invert)</span></span><br><span class="line"><span class="comment"># -o 只显示被模式匹配到的字符串</span></span><br><span class="line">grep <span class="string">"hello"</span> tmpFile</span><br><span class="line">ifconfig | grep -E <span class="string">"[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;"</span></span><br></pre></td></tr></table></figure><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># awk (Aho Weiberger and Kernighan)</span></span><br><span class="line"><span class="comment"># 输出第1、4列</span></span><br><span class="line">awk <span class="string">'&#123;print $1,$4&#125;'</span> log.txt</span><br></pre></td></tr></table></figure><h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sed (Stream Editor)</span></span><br><span class="line"><span class="comment"># sed是行处理工具，一次处理一行并且不改变文本内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数</span></span><br><span class="line"><span class="comment"># -i 直接修改</span></span><br><span class="line"><span class="comment"># -n 仅显示处理后的结果</span></span><br><span class="line"><span class="comment"># -e 以选项中指定的script来处理输入的文本文件（可不写）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令</span></span><br><span class="line"><span class="comment"># d 删除行（delete）</span></span><br><span class="line"><span class="comment"># p 打印行（print）</span></span><br><span class="line"><span class="comment"># a 新增 （add），在后</span></span><br><span class="line"><span class="comment"># i 插入（insert），在前</span></span><br><span class="line"><span class="comment"># c 取代一行</span></span><br><span class="line"><span class="comment"># s 取代</span></span><br><span class="line"><span class="comment"># q 推出（quit）</span></span><br><span class="line"><span class="comment"># = 打印匹配行号</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二行后新增一行</span></span><br><span class="line">sed <span class="string">'2a\newLine'</span> tmpFile</span><br><span class="line">sed <span class="string">'2a newLine'</span> tmpFile</span><br><span class="line"><span class="comment"># 删除第二行</span></span><br><span class="line">sed <span class="string">'2d'</span> tmpFile</span><br><span class="line"><span class="comment"># 删除第二到最后行</span></span><br><span class="line">sed <span class="string">'2,$d'</span> tmpFile</span><br><span class="line"><span class="comment"># 定位第二行</span></span><br><span class="line">sed -n <span class="string">'2p'</span> tmpFile</span><br><span class="line"><span class="comment"># 定位第二到第五行</span></span><br><span class="line">sed -n <span class="string">'2,5p'</span> tmpFile</span><br><span class="line"><span class="comment"># 搜索一行</span></span><br><span class="line">sed -n <span class="string">'/SCL/p'</span> tmpFile</span><br><span class="line"><span class="comment"># 替换一行</span></span><br><span class="line">sed -n <span class="string">'/SCL/&#123;s/SCL/SCL2/;p;q&#125;'</span> tmpFile</span><br></pre></td></tr></table></figure><h2 id="归档、压缩和加密"><a href="#归档、压缩和加密" class="headerlink" title="归档、压缩和加密"></a>归档、压缩和加密</h2><h3 id="计算MD5值md5sum"><a href="#计算MD5值md5sum" class="headerlink" title="计算MD5值md5sum"></a>计算MD5值md5sum</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 校验单个文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"123"</span> &gt; tmpFile</span><br><span class="line">md5sum tmpFile &gt; tmpFile.md5</span><br><span class="line">md5sum -c tmpFile.md5</span><br><span class="line"><span class="comment"># 检验多个文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"1234"</span> &gt; tmpFile2</span><br><span class="line">md5sum tmpFile tmpFile2 &gt; multipleFile.md5</span><br><span class="line">md5sum -c multipleFile.md5</span><br></pre></td></tr></table></figure><h3 id="打包和压缩tar"><a href="#打包和压缩tar" class="headerlink" title="打包和压缩tar"></a>打包和压缩tar</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -z 使用gzip算法压缩或者解压</span></span><br><span class="line"><span class="comment"># -j 使用bzip2算法压缩或者解压</span></span><br><span class="line"><span class="comment"># -c 创建包（Create）</span></span><br><span class="line"><span class="comment"># -t 查看（Tap）</span></span><br><span class="line"><span class="comment"># -x 解包（Extract）</span></span><br><span class="line"><span class="comment"># -v 显示详情（verbose）</span></span><br><span class="line"><span class="comment"># -f 指定文件（File）</span></span><br><span class="line"><span class="comment"># 以gzip格式压缩</span></span><br><span class="line">tar -czvf tmpFile.tar.gz tmpFile</span><br><span class="line"><span class="comment"># 查看gzip格式压缩文件内容</span></span><br><span class="line">tar -tzvf tmpFile.tar.gz</span><br><span class="line"><span class="comment"># 解压缩gzip格式压缩文件</span></span><br><span class="line">tar -xzvf tmpFile.tar.gz</span><br><span class="line"><span class="comment"># 批量解压缩</span></span><br><span class="line">ls *.tar.gz | xargs -n1 tar xzvf</span><br></pre></td></tr></table></figure><h3 id="压缩zip"><a href="#压缩zip" class="headerlink" title="压缩zip"></a>压缩zip</h3><p>可能需要安装zip和unzip工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 压缩</span></span><br><span class="line">zip tmpFile.zip tmpFile</span><br><span class="line"><span class="comment"># 解压缩</span></span><br><span class="line">unzip tmpFile.zip</span><br></pre></td></tr></table></figure><h3 id="加密和密钥管理GPG"><a href="#加密和密钥管理GPG" class="headerlink" title="加密和密钥管理GPG"></a>加密和密钥管理GPG</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成密钥</span></span><br><span class="line">gpg --full-generate-key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看密钥</span></span><br><span class="line">gpg --list-keys</span><br><span class="line">gpg -k</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导出密钥</span></span><br><span class="line"><span class="comment"># --armor或者-a 代表创建ASCII格式的文件</span></span><br><span class="line"><span class="comment"># --export-key，导出公钥</span></span><br><span class="line">--<span class="built_in">export</span>-secret-keys，导出私钥</span><br><span class="line"><span class="comment"># xxx代表uid或者密钥指纹</span></span><br><span class="line">gpg --armor --<span class="built_in">export</span> xxx &gt; xxx.key</span><br><span class="line">gpg --armor --<span class="built_in">export</span>-secret-key xxx &gt; xxx.key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入密钥</span></span><br><span class="line">gpg --import xxx.key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除密钥</span></span><br><span class="line">gpg　--delete-keys xxx</span><br><span class="line">gpg　--delete-secret-keys xxx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="comment"># --recipient或者-r 指定接收者密钥</span></span><br><span class="line">gpg --recipient xxx --output tmpFile.gpg --encrypt tmpFile</span><br><span class="line">gpg -r xxx -o tmpFile.gpg -e tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">gpg --output tmpFile --decrypt tmpFile.gpg</span><br><span class="line">gpg -o tmpFile -d tmpFile.gpg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 签名</span></span><br><span class="line"><span class="comment"># --sign 生成既含原文又含签名的二进制文件（取出时同解密）</span></span><br><span class="line">gpg --sign tmpFile</span><br><span class="line"><span class="comment"># --clear-sign 生成适合阅读的既含原文又含签名的文件</span></span><br><span class="line">gpg --clear-sign tmpFile</span><br><span class="line"><span class="comment"># --detach-sign 只生成签名文件</span></span><br><span class="line">gpg --armor --detach-sign tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证</span></span><br><span class="line">gpg --verify tmpFile.asc tmpFile</span><br></pre></td></tr></table></figure><h3 id="加密和密钥管理openSSL"><a href="#加密和密钥管理openSSL" class="headerlink" title="加密和密钥管理openSSL"></a>加密和密钥管理openSSL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机数</span></span><br><span class="line">openssl rand -base64 16</span><br><span class="line"><span class="comment"># 随机密码</span></span><br><span class="line">openssl rand -base64 32 | tr -d +/ | cut -c 1-16</span><br><span class="line"></span><br><span class="line"><span class="comment"># 摘要</span></span><br><span class="line"><span class="comment"># 可选方法有[-md5|-sha256...]</span></span><br><span class="line">openssl dgst -md5 tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对称加密</span></span><br><span class="line"><span class="comment"># -des DES算法</span></span><br><span class="line"><span class="comment"># -e 加密</span></span><br><span class="line"><span class="comment"># -a ASCII编码，否则为二进制编码</span></span><br><span class="line">openssl enc -des -e -<span class="keyword">in</span> tmpFile -out tmpFile.des</span><br><span class="line">openssl enc -des -e -a -<span class="keyword">in</span> tmpFile -out tmpFile.des</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对称解密</span></span><br><span class="line"><span class="comment"># -d 解密</span></span><br><span class="line">openssl enc -des -d -a -<span class="keyword">in</span> tmpFile.des -out tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥生成</span></span><br><span class="line">openssl genrsa -out private.pem 1024</span><br><span class="line">openssl rsa -<span class="keyword">in</span> private.pem -pubout -out public.pem</span><br><span class="line"></span><br><span class="line"><span class="comment"># 公钥加密</span></span><br><span class="line">openssl rsautl -encrypt -<span class="keyword">in</span> tmpFile -inkey public.pem -pubin -out tmpFile.rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 私钥解密</span></span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> tmpFile.rsa -inkey private.pem -out tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 私钥签名</span></span><br><span class="line">openssl dgst -sign private.pem -sha256 -<span class="keyword">in</span> tmpFile -out sign.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 公钥验证</span></span><br><span class="line">openssl dgst -verify public.pem -sha256 -signature sign.txt tmpFile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 私钥验证</span></span><br><span class="line">openssl dgst -prverify private.pem -sha256 -signature sign.txt tmpFile</span><br></pre></td></tr></table></figure><h2 id="系统管理"><a href="#系统管理" class="headerlink" title="系统管理"></a>系统管理</h2><h3 id="Top"><a href="#Top" class="headerlink" title="Top"></a>Top</h3><p>无需其他参数，通常输出为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">top - 21:11:38 up 7 min,  2 users,  load average: 0.15, 0.29, 0.20</span><br><span class="line">Tasks: 192 total,   2 running, 190 sleeping,   0 stopped,   0 zombie</span><br><span class="line">Cpu(s):  0.2%us,  0.2%sy,  0.0%ni, 99.7%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line">Mem:   6109668k total,   630520k used,  5479148k free,    33388k buffers</span><br><span class="line">Swap:        0k total,        0k used,        0k free,   200328k cached</span><br><span class="line"></span><br><span class="line">   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND           </span><br><span class="line">  2342 root      20   0  255m 8780 5152 S  0.3  0.1   0:01.11 vmtoolsd</span><br></pre></td></tr></table></figure><p>抬头部分</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 第一行 任务队列信息</span><br><span class="line">当前时间、运行时间、当前用户、平均负载（三个数字分别是1分钟、5分钟和15分钟的平均负载）</span><br><span class="line"></span><br><span class="line"># 第二行 任务</span><br><span class="line">总进程数、运行进程数、休眠进程数、停止进程数、僵尸进程数</span><br><span class="line"></span><br><span class="line"># 第三行 cpu状态</span><br><span class="line">用户空间cpu占比us、内核空间cpu占比sy、改变过优先级的进程cpu占比ni、空闲cpu占比id、IO等待cpu占比wa、硬件中断cpu占比hi、软件中断cpu占比si</span><br><span class="line"></span><br><span class="line"># 第四行 物理内存</span><br><span class="line">物理内存总量、使用的内存、空闲的内存、缓存的内存</span><br><span class="line"></span><br><span class="line"># 第五行 交换分区</span><br><span class="line">交换区总量、使用的交换区、空闲的交换区、缓存的交换区</span><br></pre></td></tr></table></figure><p>正文部分：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PID: 进程ID</span><br><span class="line">USER: 进程所有者</span><br><span class="line">PR: 进程的优先级，实时进程为RT，其他为(优先级-100)</span><br><span class="line">NI: NICE值，取-20至19的整数，越小优先级越高</span><br><span class="line">VIRT: 虚拟内存用量，单位kB，为SWAP+RES</span><br><span class="line">RES: 进程使用的（未被交换的）物理内存用量，单位kB</span><br><span class="line">SHR: 共享内存大小，单位kB</span><br><span class="line">S: 进程状态，D=不可中断的睡眠，R=运行，S=睡眠，T=跟踪，Z=僵尸</span><br><span class="line">%CPU: cpu时间占比</span><br><span class="line">%MEM: 物理内存占比</span><br><span class="line">TIME+: cpu时间总计</span><br><span class="line">COMMAND: 进程名称</span><br></pre></td></tr></table></figure><h3 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># df 检查文件系统的磁盘空间占用</span></span><br><span class="line"><span class="comment"># -a 列出所有的文件系统</span></span><br><span class="line"><span class="comment"># -h 以较易阅读的 GBytes, MBytes, KBytes 等格式显示</span></span><br><span class="line"><span class="comment"># -k 以 KBytes 的容量显示各文件系统</span></span><br><span class="line"><span class="comment"># -m 以 MBytes 的容量显示各文件系统</span></span><br><span class="line">df -h</span><br><span class="line"></span><br><span class="line"><span class="comment"># du 检查文件和目录磁盘使用的空间</span></span><br><span class="line"><span class="comment"># -a 列出所有的文件与目录容量</span></span><br><span class="line"><span class="comment"># -h 以较易阅读的 GBytes, MBytes, KBytes 等格式显示</span></span><br><span class="line"><span class="comment"># -k 以 KBytes 的容量显示各文件系统</span></span><br><span class="line"><span class="comment"># -m 以 MBytes 的容量显示各文件系统</span></span><br><span class="line">du -ah ~/Desktop</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>老马的春天. <a href="https://www.jianshu.com/p/268064e67719" target="_blank" rel="noopener">GPG入门指南（加密/签名）</a>. </li><li>明翼. <a href="https://www.jianshu.com/p/fb2ae3dc7986" target="_blank" rel="noopener">OpenSSL 介绍和使用</a>. </li><li>牛奔. <a href="https://www.cnblogs.com/niuben/p/12017242.html" target="_blank" rel="noopener">Linux top命令详解</a>. </li><li>菜鸟教程. <a href="https://www.runoob.com/linux/linux-command-manual.html" target="_blank" rel="noopener">Linux 命令大全</a>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MOS Amplifier Structures</title>
      <link href="/archives/2e70db9d/transistor-amplifier.html"/>
      <url>/archives/2e70db9d/transistor-amplifier.html</url>
      
        <content type="html"><![CDATA[<p>This article details the structures of basic mos amplifiers.<br><a id="more"></a></p><h2 id="Common-Source"><a href="#Common-Source" class="headerlink" title="Common Source"></a>Common Source</h2><h3 id="CS-with-Resistor-Load"><a href="#CS-with-Resistor-Load" class="headerlink" title="CS with Resistor Load"></a>CS with Resistor Load</h3><p><img src="transistor-amplifier/image-20200126194424008.png" alt="Common Source Amplifier" style="zoom:50%;"></p><p>In saturation mode, the voltage gain is</p><script type="math/tex; mode=display">\begin{aligned}A_v&=-R_D\mu_nC_{ox}\frac{W}{L}(V_{in}-V_{TH})\\&=-g_mR_D\end{aligned}</script><p>In triode mode, the voltage gain is </p><script type="math/tex; mode=display">\begin{aligned}A_v&=\frac{-\mu_nC_{ox}(W/L)R_DV_{out}}{1+\mu_nC_{ox}(W/L)R_D(V_{in}-V_{TH}-V_{out})}\end{aligned}</script><p>which reaches maximal when $V_{out}=V_{in}-V_{TH}$.</p><h3 id="CS-with-Diode-Load-Cascode"><a href="#CS-with-Diode-Load-Cascode" class="headerlink" title="CS with Diode Load (Cascode)"></a>CS with Diode Load (Cascode)</h3><p>A diode can be realized by connecting the gate and drain of a transistor</p><p><img src="transistor-amplifier\image-20200126202213384.png" alt="MOS as Diode"></p><p>In that case, the equivalent output resistance is</p><script type="math/tex; mode=display">r_{eq}=\frac{1}{g_m+g_{mb}}||r_o</script><p>From a large-signal perspective, a diode act like a &quot;square root&quot; operator.</p><p><img src="transistor-amplifier\image-20200126203017127.png" alt="CS with Diode Load"></p><p>The voltage gain of a CS stage with diode load is</p><script type="math/tex; mode=display">\begin{aligned}A_v&=-g_{m1}\left(\frac{1}{g_{m2}+g_{mb2}}||r_{o1}||r_{o2}\right)\\&\approx-\sqrt{\frac{(W/L)_1}{(W/L)_2}}\frac{1}{1+\eta}\end{aligned}</script><p>where $\eta=g_{mb2}/g_{m2}$</p><p>The working state of this configuration is</p><ol><li>$V_{in}&lt;V_{TH1}, V_{out}\approx V_{dd}-V_{TH2}$, M1 off, M2 near cut-off</li><li>$V_{TH1}&lt;V_{in}&lt;V_{out}+V_{TH1}$, M1 saturation, M2 saturation, linear</li><li>$V_{out}+V_{TH1}&lt;V_{in}$, M1 diode, M2 saturation</li></ol><p>Strong input device and weak load device can lead to high gain, yet the voltage swing is severely limited.</p><h3 id="CS-with-Current-Source-Load"><a href="#CS-with-Current-Source-Load" class="headerlink" title="CS with Current-Source Load"></a>CS with Current-Source Load</h3><p>Assume that M2 is operating in saturation region.</p><p><img src="transistor-amplifier\image-20200126231209175.png" alt="CS with Current Source Load"></p><p>The voltage gain is</p><script type="math/tex; mode=display">A_v=-g_{m1}(r_{o1}||r_{o2})</script><h3 id="CS-with-Active-Load"><a href="#CS-with-Active-Load" class="headerlink" title="CS with Active Load"></a>CS with Active Load</h3><p><img src="transistor-amplifier\image-20200127194136167.png" alt="CS with Active Load"></p><p>The voltage gain is</p><script type="math/tex; mode=display">A_v=-(g_{m1}+g_{m2})(r_{o1}||r_{o2})</script><p>This topology is sensitive to PVT variation due to $V_{GS1}+V_{GS2}=V_{DD}$. Still, it would amplify supply noise, the gain is</p><script type="math/tex; mode=display">\frac{V_{out}}{V_{DD}}=\left(g_{m2}+\frac{1}{r_{o2}}\right)(r_{o1}||r_{o2})</script><h3 id="CS-with-Triode-Load"><a href="#CS-with-Triode-Load" class="headerlink" title="CS with Triode Load"></a>CS with Triode Load</h3><p>Assume that M2 is operating in deep triode region and behaves as a resistor ($V_b$ is very close to $V_{DD}$).</p><p><img src="transistor-amplifier\image-20200127195446658.png" alt="CS with Triode Load"></p><p>The voltage gain is</p><script type="math/tex; mode=display">A_v=-g_{m1}(r_{o1}||R_{on2})\\R_{on2}=\frac{1}{\mu_pC_{ox}\frac{W}{L}(V_{DD}-V_{b}-|V_{THP}|)}</script><p>This circuit is difficult to provide bias with consideration to PVT variation. However, as compared to diode counterpart, it has no output voltage headroom (i.e. $V_{out,max}=V_{DD}$)</p><h3 id="CS-with-Source-Degeneration"><a href="#CS-with-Source-Degeneration" class="headerlink" title="CS with Source Degeneration"></a>CS with Source Degeneration</h3><p>Like diode load, source degeneration can be employed to enhance the linearity.</p><p><img src="transistor-amplifier\image-20200127200332588.png" alt="CS with Source Degeneration"></p><script type="math/tex; mode=display">\begin{aligned}A_{v}&=\frac{-g_mR_D}{1+g_mR_S}\\&=-\frac{R_D}{\frac{1}{g_m}+R_S}\end{aligned}</script><p>This can be explained as &quot;the resistance seen at the drain&quot; divided by &quot;the total resistance in the source path&quot;.</p><p><img src="transistor-amplifier\image-20200127201302537.png" alt="CS with Source Degeneration, Small Signal"></p><script type="math/tex; mode=display">G_m=\frac{g_mr_o}{R_S+[1+(g_m+g_{mb})R_S]r_o}</script><ul><li>When $V_{in}$ is low, $1/g_m\gg R_s, G_m\approx g_m$</li><li>For large $V_{in}$, $1/g_m\ll R_s, G_m\approx 1/R_s$</li></ul><p><img src="transistor-amplifier\image-20200127202233541.png" alt="CS with Source Degeneration, Large Signal"></p><p>As depicted from the figure, the large signal gain is relatively smooth with source degeneration.</p><p>The output impedance is</p><script type="math/tex; mode=display">R_{out}=[1+(g_m+g_{mb})R_S]r_O+R_S</script><p><img src="transistor-amplifier\image-20200127205355566.png" alt="CS with Source Degeneration, Small Signal, Detailed"></p><p>The gain can be written as </p><script type="math/tex; mode=display">\begin{aligned}A_v&=\frac{-g_mr_OR_D}{R_D+R_S+r_O+(g_m+g_{mb})R_Sr_O}\\&=G_m\cdot(R_{out}||R_D)\end{aligned}</script><p><img src="transistor-amplifier\image-20200127210029545.png" alt="Lemma for Calculating Gm"></p><h2 id="Source-Follower"><a href="#Source-Follower" class="headerlink" title="Source Follower"></a>Source Follower</h2><p><img src="transistor-amplifier\image-20200127211148004.png" alt="Source Follower"></p><p>Source follower can act like a buffer. It offers high input resistance and low output resistance.</p><script type="math/tex; mode=display">\begin{aligned}A_v&=\frac{g_mR_S}{1+(g_m+g_{mb})R_S}\\&=\frac{(\frac{1}{g_{mb}}||R_S)}{\frac{1}{g_m}+(\frac{1}{g_{mb}}||R_S)}\\&=\frac{R_{eq}}{\frac{1}{g_m}+R_{eq}}\end{aligned}</script><p>With a current source rather than a resistor as load, the linearity can be improved because $V_{GS}$ will be fixed for a fixed $I_d$.</p><p><img src="transistor-amplifier\image-20200127211858893.png" alt="Source Follower with Current Source"></p><script type="math/tex; mode=display">R_{out}=\frac{1}{g_m+g_{mb}}</script><h2 id="Common-Gate"><a href="#Common-Gate" class="headerlink" title="Common Gate"></a>Common Gate</h2><p><img src="transistor-amplifier\image-20200127215157365.png" alt="Common Gate"></p><p><img src="transistor-amplifier\image-20200127215215285.png" alt="Common Gate, Large Signal"></p><script type="math/tex; mode=display">A_v=(g_m+g_{mb})R_D\\R_{in}=\frac{1}{g_m+g_{mb}}</script><p>A more detailed calculation of Av reveals</p><p><img src="transistor-amplifier\image-20200127221538415.png" alt="Common Gate, Small Signal"></p><script type="math/tex; mode=display">A_v=\frac{(g_m+g_{mb})r_o+1}{r_o+(g_m+g_{mb})r_oR_S+R_S+R_D}R_D</script><p>For a more detailed calculation of Rin</p><p><img src="transistor-amplifier\image-20200127221247153.png" alt="Common Gate, Input Impedance"></p><script type="math/tex; mode=display">R_{in}=\frac{R_D+r_o}{1+(g_m+g_{mb})r_o}\\R_{out}=\{[1+(g_m+g_{mb})r_o]R_s+r_o\}||R_D</script><p>The MOS can transform impedance <em>up</em> from source to drain, or <em>down</em> from drain to source.</p><p><img src="transistor-amplifier\image-20200127222015493.png" alt="Common Gate, Impedance Transformation"></p><h2 id="Cascode"><a href="#Cascode" class="headerlink" title="Cascode"></a>Cascode</h2><p>For both MOS to be in saturation</p><script type="math/tex; mode=display">V_{out} \ge (V_{GS1}-V_{TH1})+(V_{GS2}-V_{TH2})</script><p>The large signal operating mode is as follows:</p><ul><li>For $V_{in}&lt;V_{TH1}$, M1 off, M2 off, $V_{out}=V_{DD}$</li><li>For $V_{in}&gt;V_{TH1}$, M1 saturation, M2 saturation</li><li>For sufficiently large $V_{in}$, two occasions can occur<ul><li>M1 enter triode region first</li><li>M2 enter triode region first</li></ul></li></ul><p>Neglecting channel length modulation effect, Cascode amplifier has gain of </p><script type="math/tex; mode=display">A_v=-G_{m}R_{out}\\R_{out}=[1+(g_{m2}+g_{mb2})r_{o2}]r_{o1}+r_{o2}</script><p>Cascode can reduce mismatch because</p><p><img src="transistor-amplifier\image-20200128104210895.png" alt="Cascode, Sensitivity to VDD Noise"></p><p>In the first case</p><script type="math/tex; mode=display">\Delta I_D=\frac{1}{2}\mu_nC_{ox}\frac{W}{L}(V_b-V_{TH})^2(\lambda\Delta V)</script><p>Instead, in the second case</p><script type="math/tex; mode=display">V_{PQ}=\Delta V\frac{r_{o1}||\frac{1}{g_{m3}+g_{mb3}}}{r_{o3}+(r_{o1}||\frac{1}{g_{m3}+g_{mb3}})}\\\Delta I_D=\frac{1}{2}\mu_nC_{ox}\frac{W}{L}(V_b-V_{TH})^2\frac{\lambda\Delta V}{(g_{m3}+g_{mb3})r_{o3}}</script><p>Folded Cascode is as follows:</p><p><img src="transistor-amplifier\image-20200128110418704.png" alt="Folded Cascode"></p><ul><li>Higher DC consumption for comparable performance</li></ul><h2 id="Miller-Effect"><a href="#Miller-Effect" class="headerlink" title="Miller Effect"></a>Miller Effect</h2><p><img src="transistor-amplifier\image-20200201103952034.png" alt="Miller Effect Illustration"></p><p>The current flowing from X to Y is</p><script type="math/tex; mode=display">\frac{V_X-V_Y}{Z}=\frac{V_X}{Z_1}</script><p>Therefore</p><script type="math/tex; mode=display">Z_1=\frac{Z}{1-\frac{V_Y}{V_x}}=\frac{Z}{1-A_v}</script><p>Similarly</p><script type="math/tex; mode=display">Z_2=\frac{Z}{1-\frac{V_Y}{V_X}}=\frac{Z}{1-1/A_v}</script><p><strong>Attention:</strong></p><ul><li>Only actual $A_v$ at the frequency of interest may be used to accurately predict the input impedance, but low-frequency $A_v$ is useful for approximation (it may eliminate zeros and predict additional poles).</li><li>Since the reverse gain is not necessarily $1/A_v$ (as in the case of CG), it cannot be used to calculate the output impedance directly. Instead, a voltage source should be connected at the output node to test the reverse gain, and  that result be used to calculate the impedance.</li><li>Trans-impedance Z must present in the process of calculating $A_v$.</li></ul><h2 id="Frequency-Response"><a href="#Frequency-Response" class="headerlink" title="Frequency Response"></a>Frequency Response</h2><h3 id="Association-of-Poles-with-Nodes"><a href="#Association-of-Poles-with-Nodes" class="headerlink" title="Association of Poles with Nodes"></a>Association of Poles with Nodes</h3><p>We can associate each pole with one node of the circuit. It is not always true, but affords an intuitive approach to the estimation of the transfer function.</p><p>General Formula</p><script type="math/tex; mode=display">A_v(s)=A_v(0)\frac{1}{(1+sR_1C_1)(1+sR_2C_2)...}</script><h3 id="Common-Source-1"><a href="#Common-Source-1" class="headerlink" title="Common Source"></a>Common Source</h3><p><img src="transistor-amplifier/image-20200201151018992.png" alt="Common Source, Frequency Response"></p><p>Poles can be estimated as</p><script type="math/tex; mode=display">\omega_{in}=\frac{1}{R_S[C_{GS}+(1+g_mR_D)C_{GD}]}\\\omega_{out}=\frac{1}{R_D(C_{DB}+C_{GD})}</script><p>and the gain is</p><script type="math/tex; mode=display">A_v(s)=\frac{-g_mR_D}{\left(1+\frac{s}{\omega_{in}}\right)\left(1+\frac{s}{\omega_{out}}\right)}</script><p>A direct analysis shows</p><script type="math/tex; mode=display">A_v(s)=\frac{R_D(sC_{GD}-g_m)}{\xi s^2+\varepsilon s+1}\\\xi=R_sR_D(C_{GS}C_{GD}+C_{GS}C_{DB}+C_{GD}C_{DB})\\\varepsilon=R_S(1+g_mR_D)C_{GD}+R_SC_{GS}+R_D(C_{GD}+C_{DB})</script><p>The denominator can be written as</p><script type="math/tex; mode=display">\begin{aligned}D&=\left(\frac{s}{\omega_{p1}}+1\right)\left(\frac{s}{\omega_{p2}}+1\right)\\&=\frac{s^2}{\omega_{p1}\omega_{p2}}+\left(\frac{1}{\omega_{p1}}+\frac{1}{\omega_{p2}}\right)s+1\end{aligned}</script><p>Further assume that $1/\omega_{p2}\ll1/\omega_{p1}$, we have</p><script type="math/tex; mode=display">\omega_{p1}=\frac{1}{\varepsilon}\approx\omega_{in}\\\omega_{p2}=\frac{1}{\omega_{p1}\xi}</script><p>A zero exists as</p><script type="math/tex; mode=display">\omega_z=\frac{g_m}{C_{GD}}>\frac{g_m}{C_{GS}}=f_T</script><p>Signal cancellation model is as follows:</p><p><img src="transistor-amplifier\image-20200201154607068.png" alt="Signal Cancellation"></p><h3 id="Source-Follower-1"><a href="#Source-Follower-1" class="headerlink" title="Source Follower"></a>Source Follower</h3><p><img src="transistor-amplifier/image-20200201155439190.png" alt="Source Follower, Frequency Response"></p><p>Strong interaction through $C_{GS}$ makes it difficult to associate a pole with each node in the circuit. Calculation shows</p><script type="math/tex; mode=display">A_v(s)=\frac{g_m+C_{GS}s}{\xi s^2+\varepsilon s+g_m}\\\xi=R_s(C_{GS}C_{L}+C_{GS}C_{GD}+C_{GD}C_{L})\\\varepsilon=g_mR_SC_{GD}+C_{L}+C_{GS}</script><p>Therefore</p><script type="math/tex; mode=display">\omega_{p1}\approx\frac{g_m}{\varepsilon}</script><p>Note if $C_L=0$, the previous formula reduces to</p><script type="math/tex; mode=display">A_v(s)=\frac{1}{1+R_SC_{GD}s}</script><p>In this case, only one pole at the input presents. We say $C_{GS}$ is bootstrapped by the source follower.</p><p>Neglecting channel length modulation, the input impedance is</p><script type="math/tex; mode=display">\begin{aligned}Z_{in}&=\frac{1}{C_{GS}s}+\frac{1}{C_{GD}s}+\left(1+\frac{g_m}{C_{GS}s}\right)\frac{1}{g_{mb}+C_Ls}\\&\approx\frac{1}{C_{GD}s}+\frac{1}{C_{GS}s}\left(1+\frac{g_m}{g_{mb}}\right)+\frac{1}{g_{mb}} &\text{low}\ f\\&\approx\frac{1}{C_{GD}s}+\frac{1}{C_{GS}s}+\frac{1}{C_{L}s}+\frac{g_m}{C_{GS}C_{L}s^2} &\text{high}\ f\end{aligned}</script><p>It presents negative real input impedance at high frequency, thus is possibly unstable.</p><p>Output impedance is</p><p><img src="transistor-amplifier\image-20200201162743936.png" alt="Source Follower, Frequency Response, Zout"></p><script type="math/tex; mode=display">\begin{aligned}Z_{out}&=\frac{R_SC_{GS}s+1}{g_m+C_{GS}s}\\&\approx 1/g_m &\text{low}\ f\\&\approx R_s &\text{high}\ f\\\end{aligned}</script><p>Figure (c) is more common, as when operated as buffer, $Z_{out}&lt;Z_{in}$. It can be modelled as</p><p><img src="transistor-amplifier/image-20200201163246921.png" alt="Source Follower, Output Impedance Model"></p><script type="math/tex; mode=display">R_2=1/g_m\\R_1=R_S-1/g_m\\L=\frac{C_{GS}}{g_m}\left(R_S-\frac{1}{g_m}\right)</script><p>Thus, source follower can be used to realize inductors.</p><h3 id="Common-Gate-1"><a href="#Common-Gate-1" class="headerlink" title="Common Gate"></a>Common Gate</h3><p><img src="transistor-amplifier/image-20200201165625279.png" alt="Common Gate, Frequency Response"></p><p>We have</p><script type="math/tex; mode=display">\omega_{in}=\frac{1}{(C_{GS}+C_{SB})(R_S||\frac{1}{g_m+g_{mb}})}\\\omega_{out}=\frac{1}{(C_{GD}+C_{DB})R_D}\\A_v(s)=\frac{(g_m+g_{mb})R_D}{1+(g_m+g_{mb})R_S}\cdot\frac{1}{\left(1+\frac{s}{\omega_{in}}\right)\left(1+\frac{s}{\omega_{out}}\right)}</script><p>It has no Miller multiplication of capacitances, thus have wider bandwidth.</p><h3 id="Cascode-1"><a href="#Cascode-1" class="headerlink" title="Cascode"></a>Cascode</h3><p><img src="transistor-amplifier\image-20200201171030851.png" alt="Cascode, Frequency Response"></p><p>The pole associated with node A is</p><script type="math/tex; mode=display">\omega_{p,A}=\frac{1}{R_S\left[C_{GS1}+\left(1+\frac{g_{m1}}{g_{m2}+g_{mb2}}\right)C_{GD1}\right]}</script><p>The pole associated with node X is</p><script type="math/tex; mode=display">\omega_{p,X}=\frac{g_{m2}+g_{mb2}}{\left(1+\frac{g_{m2}+g_{mb2}}{g_{m1}}\right)C_{GD1}+C_{DB1}+C_{SB2}+C_{GS2}}</script><p>The pole associated with node Y is</p><script type="math/tex; mode=display">\omega_{p,Y}=\frac{1}{R_D(C_{DB2}+C_{L}+C_{GD2})}</script><h3 id="Extra-Element-Theorem"><a href="#Extra-Element-Theorem" class="headerlink" title="Extra Element Theorem"></a>Extra Element Theorem</h3><p><img src="transistor-amplifier\image-20200201172947070.png" alt="Extra Element Theorem"></p><h3 id="Zero-Value-Time-Constant-Method"><a href="#Zero-Value-Time-Constant-Method" class="headerlink" title="Zero Value Time Constant Method"></a>Zero Value Time Constant Method</h3><p>The dominant pole of a circuit equals to the sum of all zero value time constants, each of which is obtained by setting input voltage and other capacitance to zero and computing the product of the capacitance of interest and its corresponding equivalent resistance. </p><p><em>Proof</em></p><ol><li><p>The dominant pole is the coefficient of $s$ in the denominator.</p><p>Denominator can be written as</p><script type="math/tex; mode=display">D(s)=\left(1+\frac{s}{\omega_{p1}}\right)\left(1+\frac{s}{\omega_{p2}}\right)...\left(1+\frac{s}{\omega_{pn}}\right)</script><p>Therefore, the coefficient of $s$ is $\omega_{p1}^{-1}+\omega_{p2}^{-1}+...+\omega_{pn}^{-1}$, which reduce to $\omega_{p1}^{-1}$ with dominant pole assumption.</p></li><li><p>The coefficient of $s$ in the denominator equals to the sum of all zero-value time constants.</p><p>Since the coefficient of $s$ has a time dimension, we can write it as $B_s=R_1C_1+R_2C_2+...+R_nC_n$, where $C_1-C_n$ denote real capacitors, and $R_1-R_n$ are unknown. With $C_2-C_n$ set to 0, the order of the system reduces to 1, and therefore $R_1$ is the resistance seen by $C_1$.</p></li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>Behzad Razavi. <em>Design of analog CMOS integrated circuits</em>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Basic Theory of MOSFETs</title>
      <link href="/archives/6eefa2f5/mosfet.html"/>
      <url>/archives/6eefa2f5/mosfet.html</url>
      
        <content type="html"><![CDATA[<p>This article presents the formulas and theories regarding the basic MOSFETs.</p><a id="more"></a><h2 id="I-V-Characteristic"><a href="#I-V-Characteristic" class="headerlink" title="I-V Characteristic"></a>I-V Characteristic</h2><ol><li>Turn-off region ($V_{GS}&lt;V_{TH}$)</li><li><p>Triode region/ Linear region ($V_{GS}&gt;V_{TH}, V_{DS}&lt;V_{GS}-V_{TH}$)</p><script type="math/tex; mode=display"> I_d=\mu_nC_{ox}\frac{W}{L}\left[(V_{GS}-V_{TH})V_{DS}-\frac{1}{2}V_{DS}^2\right]</script></li><li><p>Saturation region/ Square law ($V_{GS}&gt;V_{TH}, V_{DS}&gt;V_{GS}-V_{TH}$)</p><script type="math/tex; mode=display"> I_d=\frac{1}{2}\mu_nC_{ox}\frac{W}{L'}\left(V_{GS}-V_{TH}\right)^2</script></li></ol><h2 id="Calculation-of-Gm"><a href="#Calculation-of-Gm" class="headerlink" title="Calculation of Gm"></a>Calculation of Gm</h2><p>In saturation region</p><script type="math/tex; mode=display">\begin{aligned}g_m&=\mu_nC_{ox}\frac{W}{L}(V_{GS}-V_{TH})\\&=\sqrt{2\mu_nC_{ox}\frac{W}{L}I_D}\\&=\frac{2I_D}{V_{GS}-V_{TH}}\end{aligned}</script><h2 id="Second-Order-Effects"><a href="#Second-Order-Effects" class="headerlink" title="Second-Order Effects"></a>Second-Order Effects</h2><h3 id="Body-Effect"><a href="#Body-Effect" class="headerlink" title="Body Effect"></a>Body Effect</h3><script type="math/tex; mode=display">V_{TH}=V_{TH0}+\gamma\left(\sqrt{2\Phi_F+V_{SB}}-\sqrt{|2\Phi_F|}\right)</script><p>and</p><script type="math/tex; mode=display">\gamma=\frac{\sqrt{2q\epsilon_{si}N_{sub}}}{C_{ox}}\\V_{TH0}=\Phi_{MS}+2\Phi_{F}+\frac{Q_dep}{C_ox}\\Q_{dep}=\sqrt{4q\epsilon_{si}|\Phi_F|N_{sub}}\\\Phi_F=\frac{kT}{q}\ln{\frac{N_{sub}}{n_i}}</script><p>Thus, body effect can be utilized to modify the threshold voltage.</p><h3 id="Channel-Length-Modulation"><a href="#Channel-Length-Modulation" class="headerlink" title="Channel Length Modulation"></a>Channel Length Modulation</h3><script type="math/tex; mode=display">I_d=\frac{1}{2}\mu_nC_{ox}\frac{W}{L'}\left(V_{GS}-V_{TH}\right)^2(1+\lambda V_{DS})</script><p>and</p><script type="math/tex; mode=display">\lambda\propto\frac{1}{L}</script><p>Thus, long-channel MOSFET exhibits less channel modulation effect.</p><h3 id="Subthreshold-Conduction"><a href="#Subthreshold-Conduction" class="headerlink" title="Subthreshold Conduction"></a>Subthreshold Conduction</h3><p>Or called weak inversion region.</p><script type="math/tex; mode=display">I_D=I_0\exp\frac{V_{GS}}{\xi V_{T}}</script><p>and</p><script type="math/tex; mode=display">V_{T}=\frac{kT}{q}</script><p>MOSFETS operating in subthreshold region have higher gain, but generally, MOSFETs are inferior to bipolar transistors in terms of gm.</p><h2 id="Parasitic"><a href="#Parasitic" class="headerlink" title="Parasitic"></a>Parasitic</h2><h3 id="Capacitance"><a href="#Capacitance" class="headerlink" title="Capacitance"></a>Capacitance</h3><p><img src="mosfet/parasitic-capacitance-layout.png" alt="parasitic-capacitance-layout"></p><script type="math/tex; mode=display">C_1=WLC_{ox}\\C_2=WL\sqrt{q\epsilon_{si}N_{sub}/(4\Phi_F)}\\C_{5/6}=C_j+C_{jsw}C_j=C_{j0}/[1+V_R/\Phi_B]^m</script><p><img src="mosfet/parasitic-capacitance-plot.png" alt="parasitic-capacitance-plot"></p><ol><li><p>Off region</p><script type="math/tex; mode=display">C_{GS}=C_{GD}=C_{3/4}=WC_{ov}\\C_{GB}=\frac{C_1C_2}{C_1+C_2}</script></li><li><p>Triode region</p><p>Gate-channel capacitance is evenly split between the source and the drain</p><script type="math/tex; mode=display">C_{GS}=C_{GD}=\frac{C_{1}}{2}+C_{3/4}</script></li><li><p>Saturation region</p><script type="math/tex; mode=display">C_{GD}=C_{3/4}=WC_{ov}\\\\C_{GS}=\frac{2}{3}C_1+C_{3/4}</script></li></ol><h3 id="Resistance"><a href="#Resistance" class="headerlink" title="Resistance"></a>Resistance</h3><p>In saturation region</p><script type="math/tex; mode=display">\begin{aligned}r_o&=\frac{\partial V_{DS}}{\partial I_{D}}\\&=\frac{1}{\frac{1}{2}\mu_nC_{ox}\frac{W}{L}(V_{GS}-V_{TH})^2\cdot\lambda}\\&\approx\frac{1}{\lambda I_D}\end{aligned}</script><p>In triode region</p><script type="math/tex; mode=display">r_{ds}=\frac{1}{\mu_nC_{ox}\frac{W}{L}(V_{GS}-V_{TH})}</script><h3 id="MOSFET-as-Capacitor"><a href="#MOSFET-as-Capacitor" class="headerlink" title="MOSFET as Capacitor"></a>MOSFET as Capacitor</h3><p>The source, drain and the bulk are connected together as a terminal, while the gate is treated as another terminal.</p><ol><li>Negative potential on gate -&gt; attract holes -&gt; accumulation region -&gt; high capacitance</li><li>Rise potential on gate -&gt; expel both holes and electrons -&gt; depletion region/ weak inversion region -&gt; low capacitance</li><li>Gate potential exceed $V_{TH}$ -&gt; attract electrons -&gt; strong inversion region -&gt; high capacitance</li></ol><p><img src="mosfet/Cgs.png" alt="Cgs"></p><h2 id="Short-Channel-Device"><a href="#Short-Channel-Device" class="headerlink" title="Short-Channel Device"></a>Short-Channel Device</h2><h3 id="Velocity-Saturation-Lateral"><a href="#Velocity-Saturation-Lateral" class="headerlink" title="Velocity Saturation (Lateral)"></a>Velocity Saturation (Lateral)</h3><p>Previously, it is assumed that $v=\mu E$, but that is not true for short-channel devices, as shown in the figure<br><img src="mosfet/image-20200203223737905.png" alt="Velocity Saturation"></p><p>Consider a extreme case that the velocity is fixed to a maximal value, we have</p><script type="math/tex; mode=display">I_D=WC_{ox}(V_{GS}-V_{TH})v_{sat}</script><p>The drain current is, therefore, irrelevant to the channel length and directly proportional to the overdrive voltage.</p><p> Another consequence is the early saturation of Id</p><p><img src="mosfet/image-20200203224346282.png" alt="Early Saturation of Id"></p><p>Furthermore, $g_m$ would be less sensitive to $I_d$ or $V_{GS}$.</p><h3 id="Mobility-Degradation-Vertical"><a href="#Mobility-Degradation-Vertical" class="headerlink" title="Mobility Degradation (Vertical)"></a>Mobility Degradation (Vertical)</h3><p>The mobility of the charge carriers in the channel also declines as the gate-source voltage and the vertical field increase.</p><p><img src="mosfet/image-20200203224830841.png" alt="Mobility Degradation"></p><p>For this reason, we may expect $g_m=\mu C_{ox}(W/L)(V_{GS}-V_{TH})$ would not strictly follow the linear relationship.</p><p><img src="mosfet/image-20200203225022517.png" alt="Transconductance Saturation"></p><h3 id="Hot-Carrier-Effects"><a href="#Hot-Carrier-Effects" class="headerlink" title="Hot Carrier Effects"></a>Hot Carrier Effects</h3><p>While the average velocity of carriers saturates at <strong>high fields</strong>, the <strong>instantaneous velocity</strong> and hence the kinetic energy of the carriers continue to increase, especially as they accelerate toward the drain. These are called “hot” carriers.</p><p>In the vicinity of the drain region, hot carriers may <strong>“hit” the silicon atoms</strong> at high speeds, thereby<br>creating <strong>impact ionization</strong>. As a result, new electrons and holes are generated, with the electrons absorbed by the drain and the holes by the substrate. Thus, a finite <strong>drain-substrate current</strong> appears. Also, if the carriers acquire a very high energy, they may be injected into the gate oxide and even flow out the gate terminal, introducing a <strong>gate current</strong>. The substrate and gate currents are often measured to study hot carrier effects.</p><h2 id="Layout-Considerations"><a href="#Layout-Considerations" class="headerlink" title="Layout Considerations"></a>Layout Considerations</h2><h3 id="Well-Proximity-Effect-WPE"><a href="#Well-Proximity-Effect-WPE" class="headerlink" title="Well Proximity Effect (WPE)"></a>Well Proximity Effect (WPE)</h3><p>Due to the reflection of the dope implants, the border areas of the n-well receive a different doping density from those in the middle of the n-well.</p><p><img src="mosfet/image-20200204171429371.png" alt="WPE Illustration"></p><p>This problem can be alleviated by drawing a large n-well beyond the devices.</p><h3 id="Length-of-Diffusion-LOD"><a href="#Length-of-Diffusion-LOD" class="headerlink" title="Length of Diffusion (LOD)"></a>Length of Diffusion (LOD)</h3><p>Modern MOS devices are surrounded by a shallow “trench” so as to avoid the formation of a channel between adjacent transistors, called &quot;Shallow Trench Isolation&quot; (STI). STI material has different thermal coefficient to the surrounding silicon, generating stress and altering electrical properties.</p><p><img src="mosfet/20190617153235935.png" alt="STI Illustration"></p><p>To alleviate the problem, dummy fingers could be inserted on the sides of the main device to minimize the propagation of the stress.</p><p><img src="mosfet/image-20200204171347882.png" alt="LOD Alleviation"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>Behzad Razavi. <em>Design of analog CMOS integrated circuits</em>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mathematica的常用操作和常用函数</title>
      <link href="/archives/bf359c5c/mathematica-tutorial.html"/>
      <url>/archives/bf359c5c/mathematica-tutorial.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了Mathematica的常用操作和常用函数。</p><a id="more"></a><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><ul><li><p>运行代码            <code>Shift+Enter</code></p></li><li><p>中止运行            <code>Alt+.</code></p></li><li><p>输入下标            <code>Ctrl+_</code></p></li><li><p>输入上标            <code>Ctrl+^</code></p></li><li><p>插入根式            <code>Ctrl+2</code></p></li><li><p>插入分数            <code>Ctrl+/</code></p></li><li><p>输入特殊字符    <code>Esc</code></p></li></ul><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* 使用最近的输出 *)</span></span><br><span class="line">%<span class="comment">(* 使用上次计算结果 *)</span></span><br><span class="line">%%<span class="comment">(* 使用上上次计算结果 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 定义变量 *)</span></span><br><span class="line">element = <span class="number">1</span>; position = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 创建列表 *)</span></span><br><span class="line">list = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 访问列表元素，从1开始 *)</span></span><br><span class="line">list[[<span class="number">1</span>]]<span class="comment">(* 第一个 *)</span></span><br><span class="line">list[[<span class="number">-1</span>]]<span class="comment">(* 最后一个 *)</span></span><br><span class="line">list[[<span class="number">2</span>;;<span class="number">3</span>]]<span class="comment">(* 切片，第二至三个 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 修改表元素，不直接修改，返回修改后的表 *)</span></span><br><span class="line"><span class="keyword">Length</span>[list]<span class="comment">(* 返回第一层长度 *)</span></span><br><span class="line"><span class="keyword">Append</span>[list, element]<span class="comment">(* 在最后插入 *)</span></span><br><span class="line"><span class="keyword">Prepend</span>[list, element]<span class="comment">(* 在最前插入 *)</span></span><br><span class="line"><span class="keyword">Delete</span>[list, position]<span class="comment">(* 删除第position个元素 *)</span></span><br><span class="line"><span class="keyword">Insert</span>[list, element, position]<span class="comment">(* 在第position个元素前插入element *)</span></span><br><span class="line"><span class="keyword">Union</span>[list, list]<span class="comment">(* 并集，删除重复元素 *)</span></span><br><span class="line"><span class="keyword">Join</span>[list, list]<span class="comment">(* 连接，不删除重复元素 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 关联 *)</span></span><br><span class="line">association = &lt;|<span class="string">"a"</span>-&gt;<span class="number">1</span>, <span class="string">"b"</span>-&gt;<span class="number">2</span>|&gt;</span><br><span class="line">association = <span class="keyword">Association</span>[&#123;<span class="string">"a"</span>-&gt;<span class="number">1</span>, <span class="string">"b"</span>-&gt;<span class="number">2</span>&#125;]</span><br><span class="line">association[<span class="string">"a"</span>]</span><br><span class="line"><span class="keyword">Keys</span>[association]</span><br><span class="line"><span class="keyword">Values</span>[association]</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 迭代器形式 *)</span></span><br><span class="line"><span class="keyword">Table</span>[x, &#123;x, <span class="number">5</span>&#125;]<span class="comment">(* 变量名，最大值 *)</span></span><br><span class="line"><span class="keyword">Table</span>[x, &#123;x, <span class="number">1</span>, <span class="number">5</span>&#125;]<span class="comment">(* 变量名，最小值，最大值 *)</span></span><br><span class="line"><span class="keyword">Table</span>[x, &#123;x, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>&#125;]<span class="comment">(* 变量名，最小值，最大值，步长 *)</span></span><br><span class="line"><span class="keyword">Table</span>[x, &#123;x, &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>&#125;&#125;]<span class="comment">(* 变量名，值的列表 *)</span></span><br><span class="line"><span class="keyword">Table</span>[&#123;x,y&#125;, &#123;x,<span class="number">1</span>,<span class="number">3</span>&#125;, &#123;y,<span class="number">5</span>,<span class="number">7</span>&#125;]<span class="comment">(* 嵌套，第一个是外索引 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 赋值和延迟赋值 *)</span></span><br><span class="line">a = <span class="keyword">RandomReal</span>[]<span class="comment">(* 立即赋值，每次访问a的值相同 *)</span></span><br><span class="line">b := <span class="keyword">RandomReal</span>[]<span class="comment">(* 延迟赋值，每次访问b时才计算，不同 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 创建规则，用a替换b *)</span></span><br><span class="line">rule = a-&gt;b</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 应用规则（替换） *)</span></span><br><span class="line"><span class="number">3</span> b /. rule</span><br><span class="line">x + y /. &#123;x-&gt;<span class="number">1</span>, y-&gt;<span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 定义函数，下划线表示接受任意类型，输出最后一个值 *)</span></span><br><span class="line">add[x_, y_] := (c = x + <span class="number">2</span>; d = y + <span class="number">2</span>; c + d)</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 定义分段函数 *)</span></span><br><span class="line">f[x_] := x /; x&gt;<span class="number">0</span></span><br><span class="line">f[x_] := -x /; x&lt;=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 纯函数 *)</span></span><br><span class="line">(#+<span class="number">1</span>)&amp;<span class="comment">(* 只有一个变量，使用时可为(#+1)&amp;[5] *)</span></span><br><span class="line">(#<span class="number">1</span>+#<span class="number">2</span>)&amp;<span class="comment">(* 多个变量，使用时可为(#1+#2)&amp;[5,6] *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 应用函数 *)</span></span><br><span class="line">f@x<span class="comment">(* 普通函数应用，等价于f[x] *)</span></span><br><span class="line">x//f<span class="comment">(* 普通函数应用，等价于f[x] *)</span></span><br><span class="line">f@&#123;&#123;a,b&#125;, &#123;c,d&#125;&#125;<span class="comment">(* 普通应用，等价于f[&#123;&#123;a,b&#125;,&#123;c,d&#125;&#125;] *)</span></span><br><span class="line"></span><br><span class="line">f@@&#123;&#123;a,b&#125;, &#123;c,d&#125;&#125;<span class="comment">(* 去括号（1）的应用，等价于f[&#123;a,b&#125;,&#123;c,d&#125;] *)</span></span><br><span class="line"><span class="keyword">Apply</span>[f,&#123;&#123;a,b&#125;, &#123;c,d&#125;&#125;]<span class="comment">(* 去括号（1）的应用，等价于f[&#123;a,b&#125;,&#123;c,d&#125;]，不直接修改原列表，而是返回新列表 *)</span></span><br><span class="line"></span><br><span class="line">f/@&#123;&#123;a,b&#125;, &#123;c,d&#125;&#125;<span class="comment">(* 在括号（1）应用，等价于&#123;f[&#123;a,b&#125;],f[&#123;c,d&#125;]&#125; *)</span></span><br><span class="line"><span class="keyword">Map</span>[f,&#123;&#123;a,b&#125;, &#123;c,d&#125;&#125;]<span class="comment">(* 在括号（1）应用，等价于&#123;f[&#123;a,b&#125;],f[&#123;c,d&#125;]&#125; *)</span></span><br><span class="line"></span><br><span class="line">f@@@&#123;&#123;a,b&#125;, &#123;c,d&#125;&#125;<span class="comment">(* 在括号（1）内去括号（2）应用，等价于&#123;f[a,b],f[c,d]&#125; *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 函数操作 *)</span></span><br><span class="line"><span class="keyword">Select</span>[&#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">2</span>, <span class="number">-2</span>, <span class="number">3</span>&#125;, # &gt; <span class="number">0</span> &amp;]</span><br><span class="line"><span class="keyword">Cases</span>[&#123;<span class="number">1</span>, <span class="number">1</span>, f[a], <span class="number">2</span>, <span class="number">3</span>, y, f[<span class="number">8</span>], <span class="number">9</span>, f[<span class="number">10</span>]&#125;, _Integer]</span><br><span class="line"><span class="keyword">Cases</span>[&#123;<span class="number">1</span>, <span class="number">1</span>, f[a], <span class="number">2</span>, <span class="number">3</span>, y, f[<span class="number">8</span>], <span class="number">9</span>, f[<span class="number">10</span>]&#125;, <span class="keyword">Except</span>[_Integer]]</span><br><span class="line"><span class="keyword">Cases</span>[&#123;<span class="number">1</span>, <span class="number">1</span>, f[a], <span class="number">2</span>, <span class="number">3</span>, y, f[<span class="number">8</span>], <span class="number">9</span>, f[<span class="number">10</span>]&#125;, f[x_] -&gt; x]</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 过程式编程 *)</span></span><br><span class="line"><span class="keyword">Module</span>[&#123;x, y&#125;, x=<span class="number">2</span>; y=<span class="number">3</span>; x+y]<span class="comment">(* 定义和使用局部变量 *)</span></span><br><span class="line">x=<span class="number">1</span>; <span class="keyword">If</span>[x!=<span class="number">0</span>, <span class="keyword">Print</span>[<span class="string">"Not zero"</span>], <span class="keyword">Print</span>[<span class="string">"Zero"</span>]]<span class="comment">(* 使用if *)</span></span><br><span class="line"><span class="keyword">For</span>[k = <span class="number">0</span>, k &lt; <span class="number">5</span>, k++, <span class="keyword">Print</span>[k]]<span class="comment">(* 使用for循环，有多条循环体语句时，使用;分隔 *)</span></span><br><span class="line">n = <span class="number">17</span>; <span class="keyword">While</span>[n++ &lt; <span class="number">20</span>, <span class="keyword">Print</span>[n]]<span class="comment">(* 使用while循环 *)</span></span><br><span class="line"><span class="keyword">Do</span>[<span class="keyword">Print</span>[&#123;i, j&#125;], &#123;i, <span class="number">4</span>&#125;, &#123;j, i - <span class="number">1</span>&#125;]<span class="comment">(* 使用do循环 *)</span></span><br><span class="line"><span class="keyword">Break</span>[]<span class="comment">(* 退出最接近的内循环 *)</span></span><br><span class="line"><span class="keyword">Continue</span>[]<span class="comment">(* 进行本循环的下一步 *)</span></span><br><span class="line"><span class="keyword">Return</span>[expr]<span class="comment">(* 返回函数中的值expr *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 查看选项 *)</span></span><br><span class="line"><span class="keyword">Options</span>[<span class="keyword">Plot</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">(* 清除变量 *)</span></span><br><span class="line"><span class="keyword">Clear</span>[list, association]<span class="comment">(* 清除指定变量 *)</span></span><br><span class="line"><span class="keyword">Clear</span>[<span class="string">"Global`*"</span>]<span class="comment">(* 清除所有变量 *)</span></span><br></pre></td></tr></table></figure><h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I<span class="comment">(* 单位虚数 *)</span></span><br><span class="line"><span class="keyword">Pi</span><span class="comment">(* 圆周率 *)</span></span><br><span class="line">E<span class="comment">(* 自然常数 *)</span></span><br></pre></td></tr></table></figure><h2 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">order = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 复数 *)</span></span><br><span class="line"><span class="keyword">Re</span>[<span class="number">1</span>+<span class="number">2</span> I]<span class="comment">(* 取实部 *)</span></span><br><span class="line"><span class="keyword">Im</span>[<span class="number">1</span>+<span class="number">2</span> I]<span class="comment">(* 取虚部 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 方程求解 *)</span></span><br><span class="line"><span class="keyword">Solve</span>[a+b==<span class="number">2</span> &amp;&amp; a-b==<span class="number">0</span>, &#123;a, b&#125;]<span class="comment">(* 求解方程组 *)</span></span><br><span class="line"><span class="keyword">Solve</span>[&#123;a+b==<span class="number">2</span>, a-b==<span class="number">0</span>&#125;, &#123;a, b&#125;]<span class="comment">(* 求解方程组 *)</span></span><br><span class="line"><span class="keyword">NSolve</span>[&#123;a+b==<span class="number">2</span>, a-b==<span class="number">0</span>&#125;, &#123;a, b&#125;]<span class="comment">(* 数值求解方程组 *)</span></span><br><span class="line"><span class="keyword">FindRoot</span>[<span class="keyword">Cos</span>[x] == x, N&#123;x, <span class="number">0</span>&#125;]<span class="comment">(* 给定初值求解数值解 *)</span></span><br><span class="line"><span class="keyword">Eliminate</span>[&#123;a x + y == <span class="number">0</span>, <span class="number">2</span> x + (<span class="number">1</span> - a) y == <span class="number">1</span>&#125;, y]<span class="comment">(* 消去变量 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 表达式化简 *)</span></span><br><span class="line"><span class="keyword">Numerator</span>[a/b]<span class="comment">(* 获得分子 *)</span></span><br><span class="line"><span class="keyword">Denominator</span>[a/b]<span class="comment">(* 获得分母 *)</span></span><br><span class="line"><span class="keyword">Coefficient</span>[x^<span class="number">2</span>+<span class="number">2</span> x+<span class="number">1</span>, x]<span class="comment">(* 取得某一项的系数 *)</span></span><br><span class="line"><span class="keyword">Collect</span>[(x+<span class="number">1</span>)^<span class="number">2</span>,x]<span class="comment">(* 合并同类项 *)</span></span><br><span class="line"><span class="keyword">Expand</span>[(x+<span class="number">1</span>)^<span class="number">2</span>]<span class="comment">(* 展开 *)</span></span><br><span class="line"><span class="keyword">Together</span>[<span class="number">1</span>/(x+<span class="number">1</span>)+<span class="number">1</span>/(x+<span class="number">2</span>)]<span class="comment">(* 归并，通分 *)</span></span><br><span class="line"><span class="keyword">Apart</span>[<span class="number">1</span>/((x+<span class="number">1</span>) (x+<span class="number">2</span>))]<span class="comment">(* 分解 *)</span></span><br><span class="line"><span class="keyword">Factor</span>[x^<span class="number">2</span>+<span class="number">2</span> x+<span class="number">1</span>]<span class="comment">(* 因式分解 *)</span></span><br><span class="line"><span class="keyword">Simplify</span>[x^<span class="number">2</span>+<span class="number">2</span> x+<span class="number">1</span>]<span class="comment">(* 化简 *)</span></span><br><span class="line"><span class="keyword">Simplify</span>[<span class="keyword">Sqrt</span>[x^<span class="number">2</span>], x&gt;<span class="number">0</span>]<span class="comment">(* 带条件的化简 *)</span></span><br><span class="line"><span class="keyword">Simplify</span>[<span class="keyword">Re</span>[<span class="number">3</span> x + <span class="number">4</span> y I], &#123;x, y&#125; \[<span class="keyword">Element</span>] <span class="keyword">Reals</span>]<span class="comment">(* 带条件的化简 *)</span></span><br><span class="line"><span class="keyword">ComplexExpand</span>[(x+I)^<span class="number">2</span>]<span class="comment">(* 复数展开 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 微积分 *)</span></span><br><span class="line"><span class="keyword">Limit</span>[x/<span class="keyword">Sin</span>[x], x-&gt;<span class="number">0</span>]<span class="comment">(* 求导数 *)</span></span><br><span class="line">D[x^n, x]<span class="comment">(* 求导数 *)</span></span><br><span class="line">D[x^n, &#123;x,order]]<span class="comment">(* 求高阶导数 *)</span></span><br><span class="line"><span class="keyword">Integrate</span>[f, x]<span class="comment">(* 求不定积分 *)</span></span><br><span class="line"><span class="keyword">Integrate</span>[f, &#123;x, xmin, xmax&#125;]<span class="comment">(* 求定积分 *)</span></span><br><span class="line"><span class="keyword">NIntegrate</span>[f, &#123;x, xmin, xmax&#125;]<span class="comment">(* 求数值定积分 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 傅里叶变换 *)</span></span><br><span class="line">f[x_] := <span class="keyword">Piecewise</span>[&#123;&#123;<span class="number">1</span>, -t &lt; x &lt; t&#125;, &#123;<span class="number">0</span>, true&#125;&#125;]<span class="comment">(* 定义分段函数 *)</span></span><br><span class="line"><span class="keyword">FourierCoefficient</span>[f[x], x, <span class="number">0</span>]<span class="comment">(* 复数形式的傅里叶级数，积分范围为-Pi至Pi *)</span></span><br><span class="line"><span class="keyword">FourierCosCoefficient</span>[f[x], x, <span class="number">0</span>]<span class="comment">(* Cos形式的傅里叶级数，积分范围为0至Pi，直流值为2倍 *)</span></span><br><span class="line"><span class="keyword">FourierSinCoefficient</span>[f[x], x, <span class="number">0</span>]<span class="comment">(* Sin形式的傅里叶级数，积分范围为0至Pi，直流值为2倍 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 级数 *)</span></span><br><span class="line"><span class="keyword">Series</span>[<span class="number">1</span>/(<span class="number">1</span>+x), &#123;x,<span class="number">0</span>,<span class="number">3</span>&#125;]<span class="comment">(* 级数展开 *)</span></span><br></pre></td></tr></table></figure><h2 id="矩阵计算"><a href="#矩阵计算" class="headerlink" title="矩阵计算"></a>矩阵计算</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">matrix = &#123; &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125; &#125;</span><br><span class="line">order = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Det</span>[matrix]<span class="comment">(* 求矩阵的行列式 *)</span> </span><br><span class="line"><span class="keyword">Inverse</span>[matrix]<span class="comment">(* 求矩阵的逆 *)</span> </span><br><span class="line"><span class="keyword">Transpose</span>[matrix]<span class="comment">(* 求矩阵的转置 *)</span> </span><br><span class="line"><span class="keyword">ConjugateTranspose</span>[matrix]<span class="comment">(* 求矩阵的共轭转置 *)</span> </span><br><span class="line"><span class="keyword">IdentityMatrix</span>[order]<span class="comment">(* 给出单位矩阵 *)</span> </span><br><span class="line"><span class="keyword">Dot</span>[matrix, matrix]<span class="comment">(* 矩阵点积，或用. *)</span></span><br><span class="line"><span class="keyword">DiagonalMatrix</span>[&#123;<span class="number">50</span>,<span class="number">50</span>&#125;]<span class="comment">(* 对角阵 *)</span></span><br><span class="line"><span class="keyword">IdentityMatrix</span>[<span class="number">3</span>]<span class="comment">(* 单位阵 *)</span></span><br></pre></td></tr></table></figure><h2 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">matrix = &#123; &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125; &#125;</span><br><span class="line">expression = x^<span class="number">2</span>/<span class="keyword">Sqrt</span>[y]</span><br><span class="line">f[x_] := <span class="keyword">Sin</span>[x]</span><br><span class="line">g[x_] := <span class="keyword">Cos</span>[x]</span><br><span class="line">xmin := -<span class="keyword">Pi</span></span><br><span class="line">xmax := <span class="keyword">Pi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 输出控制，适合使用//运算符 *)</span></span><br><span class="line">N[<span class="keyword">Pi</span>]<span class="comment">(* 以数值形式输出 *)</span></span><br><span class="line"><span class="keyword">MatrixForm</span>[matrix]<span class="comment">(* 以矩阵形式输出 *)</span></span><br><span class="line"><span class="keyword">TraditionalForm</span>[expression]<span class="comment">(* 以传统形式输出 *)</span></span><br><span class="line"><span class="keyword">FullForm</span>[expression]<span class="comment">(* 以函数记号形式输出 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 绘图 *)</span></span><br><span class="line"><span class="keyword">Plot</span>[&#123;f[x], g[x]&#125;, &#123;x, xmin, xmax&#125;]<span class="comment">(* 自动绘图 *)</span></span><br><span class="line"><span class="keyword">Plot3D</span>[]</span><br><span class="line"><span class="keyword">ContourPlot</span>[]</span><br><span class="line"></span><br><span class="line">x = &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>&#125;; y = x^<span class="number">2</span>;</span><br><span class="line">example = <span class="keyword">Flatten</span>[<span class="keyword">Table</span>[&#123;x, y, x+y&#125;, &#123;x,<span class="number">20</span>&#125;, &#123;y,<span class="number">20</span>&#125;],<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">ListPlot</span>[<span class="keyword">Table</span>[&#123;x[[k]], y[[k]]&#125;, &#123;k, <span class="keyword">Length</span>[x]&#125;]]<span class="comment">(* 散点图 *)</span></span><br><span class="line"><span class="keyword">ListLinePlot</span>[<span class="keyword">Table</span>[&#123;x[[k]], y[[k]]&#125;, &#123;k, <span class="keyword">Length</span>[x]&#125;]]<span class="comment">(* 折线图 *)</span></span><br><span class="line"><span class="keyword">ListPlot3D</span>[example]<span class="comment">(* 3D折线图 *)</span></span><br><span class="line"><span class="keyword">ListContourPlot</span>[example]<span class="comment">(* 等高线图 *)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* 导出数据 *)</span></span><br><span class="line"><span class="keyword">Export</span>[<span class="string">"dest.dat"</span>, matrix]</span><br></pre></td></tr></table></figure><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><h3 id="S、Y、Z参数的转换"><a href="#S、Y、Z参数的转换" class="headerlink" title="S、Y、Z参数的转换"></a>S、Y、Z参数的转换</h3><p>定义了N端口的S、Y、Z参数转换的几个函数，各端口阻抗要求相同</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Y2S[Y_, Zc_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[Y]]; G0 = (<span class="number">1</span>/Zc) E0; Z0 = Zc E0;</span><br><span class="line">  G0.(E0 - <span class="keyword">ConjugateTranspose</span>[Z0].Y).<span class="keyword">Inverse</span>[(E0 + Z0.Y)].<span class="keyword">Inverse</span>[G0]]</span><br><span class="line">Z2S[Z_, Zc_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[Z]]; G0 = (<span class="number">1</span>/Zc) E0; Z0 = Zc E0;</span><br><span class="line">  G0.(Z - <span class="keyword">ConjugateTranspose</span>[Z0]).<span class="keyword">Inverse</span>[(Z + Z0)].<span class="keyword">Inverse</span>[G0]]</span><br><span class="line">S2Y[S_, Zc_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[S]]; G0 = (<span class="number">1</span>/Zc) E0; Z0 = Zc E0;</span><br><span class="line">  <span class="keyword">Inverse</span>[G0].<span class="keyword">Inverse</span>[S.Z0 + <span class="keyword">ConjugateTranspose</span>[Z0]].(E0 - S).G0]</span><br><span class="line">S2Z[S_, Zc_] := <span class="keyword">Module</span>[&#123;E0, G0, Z0&#125;,</span><br><span class="line">  E0 = <span class="keyword">IdentityMatrix</span>[<span class="keyword">Length</span>[S]]; G0 = (<span class="number">1</span>/Zc) E0; Z0 = Zc E0;</span><br><span class="line">  <span class="keyword">Inverse</span>[G0].<span class="keyword">Inverse</span>[E0 - S].(S.Z0 + <span class="keyword">ConjugateTranspose</span>[Z0]).G0]</span><br><span class="line">Z2Y[Z_] := <span class="keyword">Inverse</span>[Z]</span><br><span class="line">Y2Z[Z_] := <span class="keyword">Inverse</span>[Y]</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>Wolfram Language - Fast Introduction for Programmers, <a href="https://www.wolfram.com/language/fast-introduction-for-programmers" target="_blank" rel="noopener">https://www.wolfram.com/language/fast-introduction-for-programmers/</a>.</li><li>Wolfram Language &amp; System Documentation Center, <a href="https://reference.wolfram.com/language/index.html" target="_blank" rel="noopener">https://reference.wolfram.com/language/index.html</a>.</li><li>Qucs Technical Papers,  <a href="http://qucs.sourceforge.net/tech/technical.html" target="_blank" rel="noopener">http://qucs.sourceforge.net/tech/technical.html</a>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
            <tag> Math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>功率放大器的效率分析</title>
      <link href="/archives/5544ed83/pa-backoff-efficiency-analysis.html"/>
      <url>/archives/5544ed83/pa-backoff-efficiency-analysis.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了不同导通角下功率放大器的最大效率和回退效率的理论计算和Matlab仿真。</p><a id="more"></a><h2 id="最大效率分析"><a href="#最大效率分析" class="headerlink" title="最大效率分析"></a>最大效率分析</h2><p>定义导通角为</p><script type="math/tex; mode=display">\theta=2\pi\frac{\mathrm{Conduction\ Time}}{\mathrm{Period}}</script><p>于是，电流波形为</p><script type="math/tex; mode=display">\begin{aligned}i_d(\theta)&=I_q+I_{pk}\cos\theta,&& -\alpha/2<\theta<\alpha/2;\\&=0, &&-\pi<\theta<-\alpha/2\ \mathrm{or}\ \alpha/2<\theta<\pi\end{aligned}</script><p>有</p><script type="math/tex; mode=display">\cos(\alpha/2)=-\frac{I_q}{I_{pk}},\mathrm{\ where\ }I_{pk}=I_{max}-I_q</script><p>即</p><script type="math/tex; mode=display">I_{pk}=\frac{1}{1-\cos(\frac{\alpha}{2})}I_{max}\\I_q=\frac{-\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})}I_{max}</script><p>联立可得</p><script type="math/tex; mode=display">i_d(\theta)=I_{max}\frac{\cos\theta-\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})},\ -\frac{\alpha}{2}<\theta<\frac{\alpha}{2}</script><p>对其进行傅里叶变化，得到直流分量</p><script type="math/tex; mode=display">\begin{aligned}I_{dc}&=\frac{1}{2\pi}\int_{-\alpha/2}^{\alpha/2}{i_d(\theta)\ d\theta}\\&=\frac{I_{max}}{2\pi} \cdot \frac{2\sin(\frac{\alpha}{2})-\alpha\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})}\end{aligned}</script><p>以及n阶分量</p><script type="math/tex; mode=display">\begin{aligned}I_{n}&=\frac{1}{\pi}\int_{-\alpha/2}^{\alpha/2}{i_d(\theta) \cdot \cos n\theta\ d\theta}\\&=\frac{I_{max}}{2\pi}\frac{\alpha-\sin\alpha}{1-\cos(\frac{\alpha}{2})}, && n=1;\\&=\frac{I_{max}}{\pi}\left[\frac{2(n\cos(\frac{\alpha}{2})\sin(\frac{n\alpha}{2})-\sin(\frac{\alpha}{2})\cos(\frac{n\alpha}{2}))}{(n^2-1)(1-\cos(\frac{\alpha}{2}))}-\frac{2\cos(\frac{\alpha}{2})\sin(\frac{n\alpha}{2})}{n(1-\cos(\frac{\alpha}{2}))}\right], && n\ne1.\end{aligned}</script><p>可以绘图为</p><p><img src="pa-backoff-efficiency-analysis/fourier-analysis.png" alt="fourier-analysis"></p><p>二次谐波是最主要的谐波分量，且同相叠加。其中，由于负载为在谐波上短路，电压波形的一次谐波摆幅正好为最大值$V_{dc}$，因而一次谐波功率为</p><script type="math/tex; mode=display">P_1=\frac{V_{dc}}{\sqrt{2}}\cdot\frac{I_1}{\sqrt{2}}</script><p>直流功率为</p><script type="math/tex; mode=display">P_{dc}=V_{dc}\cdot I_{dc}</script><p>借助于此，可以计算效率为</p><script type="math/tex; mode=display">\eta=\frac{P_1}{P_{dc}}=\frac{I_1}{2I_{dc}}</script><p>其曲线为</p><p><img src="pa-backoff-efficiency-analysis/efficiency.png" alt="efficiency"></p><p>不同导通角下电流摆幅要求</p><script type="math/tex; mode=display">I_{pk}=\frac{I_{max}}{1-\cos(\frac{\alpha}{2})}</script><p>假设$g_m$恒定，可以得到相比于A类放大器的额外驱动要求</p><p><img src="pa-backoff-efficiency-analysis/excessive-drive-power.png" alt="excessive-drive-power"></p><p>可以看出，B类功放相比于A类需要6 dB更多的输入驱动功率。</p><h2 id="回退效率分析"><a href="#回退效率分析" class="headerlink" title="回退效率分析"></a>回退效率分析</h2><p>假设回退时负载阻抗不变，为饱和时最佳值</p><script type="math/tex; mode=display">R_L=\frac{V_{dc}}{I_{1,max}}</script><p>因而回退效率为</p><script type="math/tex; mode=display">\eta_{bpo}=\frac{P_{RF}}{P_{DC}}=\frac{\frac{I_1^2R_L}{2}}{I_{dc}V_{dc}}=\frac{I_1^2}{2I_{dc}I_{1,max}}</script><p>假设回退后$I_{pk,b}=kI_{pk}$，在</p><script type="math/tex; mode=display">[\alpha\le\pi\quad\mathrm{and}\quad I_q+I_{pk,b}>0]\quad\mathrm{or}\quad[\alpha>\pi\quad\mathrm{and}\quad Iq-I_{pk,b}<0]</script><p>亦即</p><script type="math/tex; mode=display">[\alpha\le\pi\quad\mathrm{and}\quad k>\cos(\frac{\alpha}{2})]\quad\mathrm{or}\quad[\alpha>\pi\quad\mathrm{and}\quad k>-\cos(\frac{\alpha}{2})]</script><p>可以得到新的导通角</p><script type="math/tex; mode=display">\cos(\alpha_{b}/2)=-\frac{I_q}{I_{pk,b}}=\frac{1}{k}\cos(\alpha/2)</script><p>和新的电流波形为</p><script type="math/tex; mode=display">\begin{aligned}i_d(\theta, k)&=I_q+kI_{pk}\cos\theta,&& -\alpha_b/2<\theta<\alpha_b/2;\\&=0, &&-\pi<\theta<-\alpha_b/2\ \mathrm{or}\ \alpha_b/2<\theta<\pi\end{aligned}</script><p>即</p><script type="math/tex; mode=display">i_d(\theta, k)=I_{max}\frac{k\cos\theta-\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})},\ -\frac{\alpha_b}{2}<\theta<\frac{\alpha_b}{2}</script><p>否则，在$\alpha\le\pi \mathrm{and} I_q+I_{pk,b}<0$时完全不导通，在$\alpha>\pi \mathrm{and} Iq-I_{pk,b}&gt;0$时完全导通。</0$时完全不导通，在$\alpha></p><p>可得直流分量</p><script type="math/tex; mode=display">\begin{aligned}I_{dc}(k)&=\frac{1}{2\pi}\int_{-\alpha_b/2}^{\alpha_b/2}{i_d(\theta)\ d\theta}\\&=\frac{I_{max}}{2\pi} \cdot \frac{2k\sin(\frac{\alpha_b}{2})-\alpha_b\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})},&&\mathrm{partially\ conductive};\\&=I_{max} \cdot \frac{-\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})},&&\mathrm{all\ conductive};\\&=0,&&\mathrm{not\ conductive}.\end{aligned}</script><p>和一次谐波分量</p><script type="math/tex; mode=display">\begin{aligned}I_{1}(k)&=\frac{1}{\pi}\int_{-\alpha_b/2}^{\alpha_b/2}{i_d(\theta) \cdot \cos \theta\ d\theta}\\&=\frac{I_{max}}{2\pi} \cdot \frac{k\alpha_b+k\sin\alpha_b-4\sin(\frac{\alpha_b}{2})\cos(\frac{\alpha}{2})}{1-\cos(\frac{\alpha}{2})},&&\mathrm{partially\ conductive};\\&=I_{max}\cdot\frac{k}{1-\cos(\frac{\alpha}{2})},&&\mathrm{all\ conductive};\\&=0,&&\mathrm{not\ conductive}.\end{aligned}</script><p>于是可以计算出回退效率，如下</p><p><img src="pa-backoff-efficiency-analysis/backoff-efficiency.png" alt="backoff-efficiency"></p><p>也可以绘制出输入回退时，输出功率图</p><p><img src="pa-backoff-efficiency-analysis/backoff-gain.png" alt="backoff-gain"></p><p>其中A类和B类完全重合，十分线性。</p><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>导通角和谐波分量关系图的绘图代码</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Idc = @(x) <span class="number">1</span>/<span class="number">2</span>/<span class="built_in">pi</span> * (<span class="number">2</span>*<span class="built_in">sin</span>(x/<span class="number">2</span>)-x.*<span class="built_in">cos</span>(x/<span class="number">2</span>))./(<span class="number">1</span>-<span class="built_in">cos</span>(x/<span class="number">2</span>));</span><br><span class="line">I1 = @(x) <span class="number">1</span>/<span class="number">2</span>/<span class="built_in">pi</span> * (x-<span class="built_in">sin</span>(x))./(<span class="number">1</span>-<span class="built_in">cos</span>(x/<span class="number">2</span>));</span><br><span class="line">I = @(x, n) <span class="number">1</span>/<span class="built_in">pi</span>./(<span class="number">1</span>-<span class="built_in">cos</span>(x/<span class="number">2</span>)) .* ( <span class="number">2</span>*(n*<span class="built_in">cos</span>(x/<span class="number">2</span>).*<span class="built_in">sin</span>(n*x/<span class="number">2</span>)-<span class="built_in">sin</span>(x/<span class="number">2</span>).*<span class="built_in">cos</span>(n*x/<span class="number">2</span>))/(n*n<span class="number">-1</span>) - <span class="number">2</span>*(<span class="built_in">cos</span>(x/<span class="number">2</span>).*<span class="built_in">sin</span>(n*x/<span class="number">2</span>))/n );</span><br><span class="line">x = <span class="number">2</span>*<span class="built_in">pi</span>:<span class="number">-0.01</span>:<span class="number">0</span>;</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line"><span class="built_in">plot</span>(Idc(x), <span class="string">'linewidth'</span>, <span class="number">2</span>, <span class="string">'linestyle'</span>, <span class="string">':'</span>)</span><br><span class="line"><span class="built_in">plot</span>(I1(x), <span class="string">'linewidth'</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(I(x, <span class="number">2</span>), <span class="string">'linewidth'</span>, <span class="number">2</span>, <span class="string">'linestyle'</span>, <span class="string">':'</span>)</span><br><span class="line"><span class="built_in">plot</span>(I(x, <span class="number">3</span>), <span class="string">'linewidth'</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(I(x, <span class="number">4</span>), <span class="string">'linewidth'</span>, <span class="number">2</span>, <span class="string">'linestyle'</span>, <span class="string">':'</span>)</span><br><span class="line"><span class="built_in">plot</span>(I(x, <span class="number">5</span>), <span class="string">'linewidth'</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">'DC'</span>, <span class="string">'1th'</span>, <span class="string">'2nd'</span>, <span class="string">'3rd'</span>, <span class="string">'4th'</span>, <span class="string">'5th'</span>)</span><br><span class="line">box on; grid on;</span><br><span class="line">xlabel(<span class="string">'Conduction Angle'</span>); ylabel(<span class="string">'Amplitude'</span>);</span><br><span class="line">axis([<span class="number">0</span>, <span class="built_in">length</span>(x) <span class="number">-0.1</span> <span class="number">0.6</span>])</span><br><span class="line">set(gca, <span class="string">'linewidth'</span>, <span class="number">1.5</span>, <span class="string">'fontsize'</span>, <span class="number">14</span>)</span><br><span class="line">set(gca, <span class="string">'xtick'</span>, [<span class="number">0</span>, <span class="built_in">floor</span>(<span class="built_in">length</span>(x)/<span class="number">4</span>), <span class="built_in">floor</span>(<span class="built_in">length</span>(x)/<span class="number">2</span>), <span class="built_in">floor</span>(<span class="built_in">length</span>(x)*<span class="number">3</span>/<span class="number">4</span>), <span class="built_in">length</span>(x)])</span><br><span class="line">set(gca, <span class="string">'xticklabel'</span>, &#123;<span class="string">'2\pi'</span>, <span class="string">''</span>, <span class="string">'\pi'</span>, <span class="string">''</span>, <span class="string">'0'</span>&#125;)</span><br></pre></td></tr></table></figure><p>计算回退效率的代码</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># file PBO.m</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ Idc, I1, eta ]</span> = <span class="title">PBO</span><span class="params">( alpha, k )</span></span></span><br><span class="line"><span class="comment">%PBO Calculate the backoff efficiency</span></span><br><span class="line">    I1max = <span class="number">1</span>/<span class="number">2</span>/<span class="built_in">pi</span> * (alpha-<span class="built_in">sin</span>(alpha))/(<span class="number">1</span>-<span class="built_in">cos</span>(alpha/<span class="number">2</span>));</span><br><span class="line">    <span class="keyword">if</span> (alpha &lt;= <span class="built_in">pi</span> &amp;&amp; k &gt; <span class="built_in">cos</span>(alpha/<span class="number">2</span>)) || (alpha &gt; <span class="built_in">pi</span> &amp;&amp; k &gt; -<span class="built_in">cos</span>(alpha/<span class="number">2</span>))</span><br><span class="line">        alphaB = <span class="number">2</span> * <span class="built_in">acos</span>( <span class="built_in">cos</span>(alpha/<span class="number">2</span>)/k );</span><br><span class="line">        Idc = <span class="number">1</span>/<span class="number">2</span>/<span class="built_in">pi</span> * ( <span class="number">2</span>*k*<span class="built_in">sin</span>(alphaB/<span class="number">2</span>) - alphaB*<span class="built_in">cos</span>(alpha/<span class="number">2</span>) ) / ( <span class="number">1</span> - <span class="built_in">cos</span>(alpha/<span class="number">2</span>) );</span><br><span class="line">        I1 = <span class="number">1</span>/<span class="number">2</span>/<span class="built_in">pi</span> * ( k*alphaB + k*<span class="built_in">sin</span>(alphaB) - <span class="number">4</span>*<span class="built_in">sin</span>(alphaB/<span class="number">2</span>)*<span class="built_in">cos</span>(alpha/<span class="number">2</span>) ) / ( <span class="number">1</span> - <span class="built_in">cos</span>(alpha/<span class="number">2</span>) );</span><br><span class="line">    <span class="keyword">elseif</span> alpha &gt; <span class="built_in">pi</span></span><br><span class="line">        Idc = -<span class="built_in">cos</span>(alpha/<span class="number">2</span>) / (<span class="number">1</span>-<span class="built_in">cos</span>(alpha/<span class="number">2</span>));</span><br><span class="line">        I1 = k / (<span class="number">1</span>-<span class="built_in">cos</span>(alpha/<span class="number">2</span>));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        Idc = <span class="number">0</span>;</span><br><span class="line">        I1 = <span class="number">0</span>;</span><br><span class="line">        eta = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    eta = I1^<span class="number">2</span> / <span class="number">2</span> / Idc / I1max;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"># file PBO_efficiency.m</span><br><span class="line">k = <span class="built_in">logspace</span>(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">61</span>);</span><br><span class="line">k10 = <span class="number">10</span>*<span class="built_in">log10</span>(k);</span><br><span class="line">e = <span class="built_in">zeros</span>(<span class="built_in">length</span>(k), <span class="number">3</span>);</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line"><span class="keyword">for</span> alpha = <span class="built_in">pi</span>: <span class="number">0.2</span>*<span class="built_in">pi</span>: <span class="number">2</span>*<span class="built_in">pi</span></span><br><span class="line">    <span class="keyword">for</span> m = <span class="number">1</span>: <span class="built_in">length</span>(k)</span><br><span class="line">        [e(m,<span class="number">1</span>), e(m,<span class="number">2</span>), e(m,<span class="number">3</span>)] = PBO(alpha, k(m));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">plot</span>(k10, e(:, <span class="number">3</span>), <span class="string">'linewidth'</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="comment">%plot(k10, 10*log10(e(:, 2)), 'linewidth', 2)</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">box on; grid on;</span><br><span class="line">xlabel(<span class="string">'Power Backoff [dBc]'</span>); ylabel(<span class="string">'Efficiency'</span>);</span><br><span class="line">set(gca, <span class="string">'linewidth'</span>, <span class="number">1.5</span>, <span class="string">'fontsize'</span>, <span class="number">14</span>)</span><br></pre></td></tr></table></figure><p>二次谐波对波形的影响</p><div class="table-container"><table><thead><tr><th style="text-align:center">$a_1\cos\theta+a_2\cos 2\theta$</th><th style="text-align:center">$a_1\cos\theta+a_2\sin 2\theta$</th></tr></thead><tbody><tr><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/2nd-harmonic-0.png" alt="2nd-harmonic-0"></td><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/2nd-harmonic-90.png" alt="2nd-harmonic-90"></td></tr><tr><td style="text-align:center">$a_1\cos\theta-a_2\cos 2\theta$</td><td style="text-align:center">$a_1\cos\theta-a_2\sin 2\theta$</td></tr><tr><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/2nd-harmonic-180.png" alt="2nd-harmonic-180"></td><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/2nd-harmonic-270.png" alt="2nd-harmonic-270"></td></tr></tbody></table></div><p>三次谐波对波形的影响</p><div class="table-container"><table><thead><tr><th style="text-align:center">$a_1\cos\theta+a_3\cos 3\theta$</th><th style="text-align:center">$a_1\cos\theta+a_3\sin 3\theta$</th></tr></thead><tbody><tr><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/3rd-harmonic-0.png" alt="3rd-harmonic-0"></td><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/3rd-harmonic-90.png" alt="3rd-harmonic-90"></td></tr><tr><td style="text-align:center">$a_1\cos\theta-a_3\cos 3\theta$</td><td style="text-align:center">$a_1\cos\theta-a_3\sin 3\theta$</td></tr><tr><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/3rd-harmonic-180.png" alt="3rd-harmonic-180"></td><td style="text-align:center"><img src="pa-backoff-efficiency-analysis/3rd-harmonic-270.png" alt="3rd-harmonic-270"></td></tr></tbody></table></div><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>S. C. Cripps, <em>RF Power Amplifiers for Wireless Communications, Second Edition</em>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
            <tag> Power Amplifier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>变压器的设计和优化</title>
      <link href="/archives/81501320/transformer-design.html"/>
      <url>/archives/81501320/transformer-design.html</url>
      
        <content type="html"><![CDATA[<p>变压器是毫米波电路设计中常用的器件。本文介绍了变压器的基本模型、匹配限制、插入损耗估计、宽带匹配和微调等方面。</p><a id="more"></a><h2 id="变压器的模型"><a href="#变压器的模型" class="headerlink" title="变压器的模型"></a>变压器的模型</h2><p>变压器的基本模型如下</p><p><img src="transformer-design/ideal-model.svg" alt="ideal-model"></p><p>因此，一个变压器可以由初级自感$L_p$，次级自感$L_s$和互感$M$定义。此外，两个常用的量——圈数比$n$和耦合系数$k$——可以定义为</p><script type="math/tex; mode=display">n=\sqrt{\frac{L_p}{Ls}}\\k=\frac{M}{\sqrt{L_pL_s}}</script><p>变压器的基本模型可以等效转化为T型模型</p><p><img src="transformer-design/T-model.svg" alt="T-model"></p><p>如果要进一步展现变压器的直流隔离作用，需要在一侧加一个理想变压器。由于这个模型没有跨接在两端的互感，可以在史密斯圆图上绘制出轨迹，方便匹配的设计。</p><p>此外，另一种适用于理论分析的模型是John Long提出的模型[1]，如下</p><p><img src="transformer-design/longs-model.svg" alt="Long&#39;s-model"></p><p>这个模型涵盖了初级和次级的电阻损耗，并将变压器等效为理想变压器和漏电感。这可以用来分析阻抗，例如对于理想变压器（$k=1$，$L_p, L_s$同比趋于无穷大），其输入阻抗为</p><script type="math/tex; mode=display">Z_{in}=n^2Z_L</script><p>上述的几种模型都是使用集总元件表征变压器的特征，因而只在窄带范围内有效。适用于宽带建模的变压器模型主要有分布式模型和传输线模型。例如，一个常见于八边形变压器的分布式模型如下</p><p><img src="transformer-design/distributed-model.svg" alt="distributed-model"></p><p>这种模型对变压器的每一段线进行建模，并组成最终的整体模型。传输线模型如下</p><p><img src="transformer-design/TLine-model.svg" alt="TLine-model"></p><p>其组成元件数量较少，方便分析。</p><h2 id="变压器匹配的限制"><a href="#变压器匹配的限制" class="headerlink" title="变压器匹配的限制"></a>变压器匹配的限制</h2><p>值得注意的是，变压器匹配并不是万能的，在$L_p&gt;0, L_s&gt;0, k&lt;1$的约束下，有一部分容性区域无法触及。例如，从500 Ohm // 30 fF出发，位于负载等Q圆以下的部分无法到达。这可以用Long的变压器模型解释：在负载阻抗经nk:1理想变压器变换后，Q值不变，此时并联电感、串联电感都只能使输入阻抗向上移动，因而负载阻抗等Q圆以下的部分不可达。但幸运的是，前级放大器的输出阻抗通常为容性，变压器只需匹配到其共轭的感性阻抗点，因此变压器可以实现绝大多数的放大器级间匹配。</p><p><img src="transformer-design/transformer-limitation.png" alt="transformer-limitation"></p><h2 id="变压器的插入损耗"><a href="#变压器的插入损耗" class="headerlink" title="变压器的插入损耗"></a>变压器的插入损耗</h2><p>理论插入损耗值为[2]</p><script type="math/tex; mode=display">\begin{aligned}\eta_{MAX}=\frac{P_{load}}{P_{IN}}&=\frac{1}{1+2\sqrt{\left(1+\frac{1}{Q_pQ_sk^2}\right)\cdot\frac{1}{Q_pQ_sk^2}+\frac{2}{Q_pQ_sk^2}}}\\&=\frac{\sqrt{1+(kQ)^2}-1}{\sqrt{1+(kQ)^2}+1}\end{aligned}</script><p>其中$Q=\sqrt{Q_pQ_s}$，其关系可以绘图为</p><p><img src="transformer-design/insertion-loss-kQ.svg" alt="insertion-loss-kQ"></p><p>可见，$kQ$乘积越高，变压器的最小插入损耗越小。</p><h2 id="变压器的宽带匹配"><a href="#变压器的宽带匹配" class="headerlink" title="变压器的宽带匹配"></a>变压器的宽带匹配</h2><p>考虑变压器的宽带匹配需要加上前置放大器输出阻抗、后级放大器输入阻抗的影响，原理图如下：</p><p><img src="transformer-design/wideband-matching.png" alt="wideband-matching" style="zoom:50%;"></p><p>当满足</p><script type="math/tex; mode=display">\omega_0=\frac{1}{\sqrt{L_pC_{out}}}=\frac{1}{\sqrt{L_sC_{in}}}\\Q=\omega R_{out}C_{out}=\omega C_{in}R_{in}</script><p>跨阻约为[3-4]</p><script type="math/tex; mode=display">Z_{21}=\frac{\omega_0^3kQRs}{(1-k^2)Q^2s^2+2(1-k)Q\omega_0 s+(1-k^2+2Q^2)\omega_0^2s^2+2Q\omega_0^3s+Q^2\omega_0^4}</script><p>其极点为</p><script type="math/tex; mode=display">\omega_L=\frac{\omega_0}{\sqrt{1+k}}\\\omega_H=\frac{\omega_0}{\sqrt{1-k}}</script><p>通常的，变压器有三种使用方法：</p><div class="table-container"><table><thead><tr><th style="text-align:center">$Z_{21}$</th><th style="text-align:center">特性</th></tr></thead><tbody><tr><td style="text-align:center"><img src="transformer-design/high-k.png" alt="high-k"></td><td style="text-align:center"><strong>高耦合变压器</strong>只用了一个峰值，效率高</td></tr><tr><td style="text-align:center"><img src="transformer-design/medium-k.png" alt="medium-k"></td><td style="text-align:center"><strong>中等耦合变压器</strong>带宽较宽，但带内波动大</td></tr><tr><td style="text-align:center"><img src="transformer-design/low-k.png" alt="low-k"></td><td style="text-align:center"><strong>低耦合变压器</strong>有平坦、宽带的频率响应</td></tr></tbody></table></div><h2 id="低耦合变压器的微调"><a href="#低耦合变压器的微调" class="headerlink" title="低耦合变压器的微调"></a>低耦合变压器的微调</h2><p>有时，需要对低耦合变压器进行微调，以满足功率要求。进行微调时，$L_p$、$L_s$和$M$对变压器输入阻抗随频率变化路径的影响为</p><div class="table-container"><table><thead><tr><th style="text-align:center">增大$L_p$</th><th style="text-align:center">增大$L_s$</th><th style="text-align:center">增大$M$</th></tr></thead><tbody><tr><td style="text-align:center"><img src="transformer-design/Lp.svg" alt="Lp"></td><td style="text-align:center"><img src="transformer-design/Ls.svg" alt="Ls"></td><td style="text-align:center"><img src="transformer-design/M.svg" alt="M"></td></tr></tbody></table></div><p>各参数对输入阻抗的影响可以总结为：</p><ol><li>$L_p$主要影响输入阻抗的虚部</li><li>$L_s$主要影响中心频率</li><li>$M$主要影响两个极点的距离</li></ol><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>J. R. Long, &quot;Monolithic transformers for silicon RF IC design,&quot; in <em>IEEE Journal of Solid-State Circuits</em>, vol. 35, no. 9, pp. 1368-1382, Sept. 2000. DOI: <a href="https://doi.org/10.1109/4.868049" target="_blank" rel="noopener">10.1109/4.868049</a> </li><li>Aoki, S. D. Kee, D. B. Rutledge and A. Hajimiri, &quot;Distributed active transformer-a new power-combining and impedance-transformation technique,&quot; in <em>IEEE Transactions on Microwave Theory and Techniques</em>, vol. 50, no. 1, pp. 316-331, Jan. 2002. DOI: <a href="https://doi.org/10.1109/22.981284" target="_blank" rel="noopener">10.1109/22.981284</a></li><li>H. Jia, C. C. Prawoto, B. Chi, Z. Wang and C. P. Yue, “A Full Ka-Band Power Amplifier With 32.9% PAE and 15.3-dBm Power in 65-nm CMOS,” in <em>IEEE Transactions on Circuits and Systems I: Regular Papers</em>, vol. 65, no. 9, pp. 2657-2668, Sept. 2018. DOI: <a href="https://doi.org/10.1109/TCSI.2018.2799983" target="_blank" rel="noopener">10.1109/TCSI.2018.2799983</a></li><li>M. Vigilante, P. Reynaert, 5G and E-Band Communication Circuits in Deep-Scaled CMOS. Switzerland: Springer, 2018. DOI: <a href="https://doi.org/10.1007/978-3-319-72646-5" target="_blank" rel="noopener">10.1007/978-3-319-72646-5</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>根据cds.lib进行设计资料库备份</title>
      <link href="/archives/bda72102/collect-cdslib.html"/>
      <url>/archives/bda72102/collect-cdslib.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了一种根据Cadence Virtuoso的cds.lib文件进行设计库自动收集的脚本，可应用于设计阶段的备份。</p><a id="more"></a><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>版本的备份和管理是设计中的值得关注的重点之一。由于大型集成电路设计通常需要多人合作，模块之间又相互依赖。因而每个人设计时需要相对稳定的依赖库环境，以防止他人进行版本迭代时导致自己的设计无法进行。一种方法是使用专门的版本管理软件，但财务成本和学习成本都较高；另一种是将他人的库手动复制，但这种方法一来比较繁琐，也容易产生疏漏。本文介绍了一种基于Python的设计库自动收集、备份脚本。</p><h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><p>核心功能有：</p><ul><li>根据cds.lib将依赖库拷贝到指定位置</li></ul><p>可选功能有：</p><ul><li>加入版本说明</li><li>可以跳过部分明确不会修改的库</li><li>可以进行压缩</li><li>可以进行加密</li><li>可以进行执行前确认</li><li>可以生成日志</li><li>可以解压缩、解密（未实现）</li><li>可以生成新的cds.lib文件（未实现）</li></ul><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="获得命令行参数"><a href="#获得命令行参数" class="headerlink" title="获得命令行参数"></a>获得命令行参数</h3><p>这一功能是基于getopt库实现。getopt是Python的一个用于处理命令行参数的模块，它首先从<code>sys.argv</code>获得输入字符串，并处理成选项的参数。首先使用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"></span><br><span class="line">opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:], <span class="string">"-h-f:"</span>, [<span class="string">'help'</span>, <span class="string">'filename='</span>])</span><br></pre></td></tr></table></figure><p>其中，<code>sys.argv[0]</code>是脚本文件所在路径，因此不用输入，只要之后的参数<code>sys.argv[1:]</code>。而<code>getopt.getopt</code>的第二个参数定义了允许的设置选项。例如这里允许使用的有</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python test.py -h</span><br><span class="line">python test.py -f hello.txt</span><br><span class="line">python test.py --help</span><br><span class="line">python test.py --filename=hello.txt</span><br></pre></td></tr></table></figure><p>其中，短参数直接写在一个字符串里面，可以用“-”分隔（也可省略），“:”代表携带参数；长参数写在后面的列表里，每个选项单独是一个字符串，带参数的加“=”。返回参数中的opts是格式信息，args是不属于格式的信息。opts 是一个两元组的列表，每个元素为[&quot;选项串&quot;, &quot;附加参数&quot;]。如果没有附加参数则为空串&#39;&#39;&quot;。处理字符串可以采用如下格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for name, value in opts:</span><br><span class="line">    if name in (&apos;-h&apos;,&apos;--help&apos;):</span><br><span class="line">        print(&quot;This is help.&quot;)</span><br><span class="line">        exit()</span><br><span class="line">    if name in (&apos;-f&apos;,&apos;--filename&apos;):</span><br><span class="line">        print(&quot;Input file is %s.&quot; % value)</span><br><span class="line">        exit()</span><br></pre></td></tr></table></figure><h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p>这一功能是基于logging库实现。 logging模块是Python内置的标准模块，主要用于输出运行日志，可以设置输出日志的等级、日志保存路径、日志文件回滚等。logging的等级有：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">logging.debug()<span class="comment">#10</span></span><br><span class="line">logging.info()<span class="comment">#20</span></span><br><span class="line">logging.warning()<span class="comment">#30</span></span><br><span class="line">logging.error()<span class="comment">#40</span></span><br><span class="line">logging.critical()<span class="comment">#50</span></span><br></pre></td></tr></table></figure><p>设置等级时只打印某个等级以上的log信息。其中有的类型为</p><ul><li><strong>Logger</strong>：日志，暴露函数给应用程序，基于LogRecord和Filter级别决定哪些日志有效。</li><li><strong>LogRecord</strong> ：日志记录器，将日志传到相应的Handler处理。</li><li><strong>Handler</strong> ：处理器, 将(LogRecord产生的)日志记录发送至合适的目的地。</li><li><strong>Filter</strong> ：过滤器, 提供了更好的粒度控制,它可以决定输出哪些日志记录。</li><li><strong>Formatter</strong>：格式化器, 指明了最终输出中日志记录的布局。</li></ul><p>基本的使用方法通过<code>logging.basicConfig()</code>创建默认对象，例如直接在命令行输出时</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig()</span><br><span class="line">logging.debug(<span class="string">'This is a debug message'</span>)</span><br><span class="line">logging.info(<span class="string">'This is an info message'</span>)</span><br><span class="line">logging.warning(<span class="string">'This is a warning message'</span>)</span><br><span class="line">logging.error(<span class="string">'This is an error message'</span>)</span><br><span class="line">logging.critical(<span class="string">'This is a critical message'</span>)</span><br></pre></td></tr></table></figure><p>在文件输出时</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(filename=<span class="string">"test.log"</span>,</span><br><span class="line">                    filemode=<span class="string">"w"</span>,</span><br><span class="line">                    format=<span class="string">"%(asctime)s %(name)s:%(levelname)s:%(message)s"</span>,</span><br><span class="line">                    datefmt=<span class="string">"%d-%M-%Y %H:%M:%S"</span>,</span><br><span class="line">                    level=logging.DEBUG)</span><br></pre></td></tr></table></figure><p>需要自定义时，可以自定义logger。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line">logger.setLevel(level = logging.INFO)</span><br><span class="line"></span><br><span class="line">handler = logging.FileHandler(<span class="string">'filepath'</span>)</span><br><span class="line">handler.setLevel(level = logging.INFO)</span><br><span class="line">formatter = logging.Formatter(<span class="string">'%(asctime)s - %(levelname)s - %(message)s'</span>)</span><br><span class="line">handler.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line">console = logging.StreamHandler()</span><br><span class="line">console.setLevel(logging.INFO)</span><br><span class="line">formatter2 = logging.Formatter(<span class="string">'%(levelname)s - %(message)s'</span>)</span><br><span class="line">console.setFormatter(formatter2)</span><br><span class="line"></span><br><span class="line">logger.addHandler(handler)</span><br><span class="line">logger.addHandler(console)</span><br></pre></td></tr></table></figure><h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><p>这一功能是基于Linux原生tar和openssl实现。其中，加密命令为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf - filename | openssl des3 -salt -k passwd -out filename.tar.gz</span><br></pre></td></tr></table></figure><p>其中password是密码，filename是输入文件名。<code>tar -czvf - filename</code>先进行压缩，通过管道传递给openssl，之后利用des3加密，生成输出文件。<code>tar -czvf - filename</code>中的参数代表</p><ul><li><code>-c</code>代表Create，创建新文档。</li><li><code>-z</code>代表gZip压缩，此外可以用<code>-j</code>使用bz2压缩。</li><li><code>-v</code>代表Verbose，显示详细信息。</li><li><code>-f</code>代表Filename，指定文件名。</li><li><code>-</code>默认代表stdin。</li></ul><p>解密命令为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl des3 -d -k password -salt -<span class="keyword">in</span> filename.tar.gz | tar xzvf -</span><br></pre></td></tr></table></figure><p>此时顺序相反，首先用openssl的des3算法解密，通过管道传给tar进行解压缩。同样的<code>tar xzvf -</code>中有</p><ul><li><code>-x</code>代表eXtract，解压缩</li><li><code>-</code>默认代表stdout。</li></ul><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>实现代码如下，基于Python 2.7，适用于CentOS</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> getpass</span><br><span class="line"></span><br><span class="line"><span class="comment"># settings</span></span><br><span class="line">cdspath = os.path.expanduser(<span class="string">'~/cds.lib'</span>)</span><br><span class="line">skipLibs = [<span class="string">'exampleLib'</span>]</span><br><span class="line">ONLY_MY_LIBS = <span class="literal">False</span></span><br><span class="line">COMMENT = <span class="literal">False</span></span><br><span class="line">PREVERVE_COMMENT = <span class="literal">False</span></span><br><span class="line">COMPRESS = <span class="literal">False</span></span><br><span class="line">COMPRESS_ENCRYPT = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">VERSION = <span class="string">'COLLECT 2.0'</span></span><br><span class="line">HELP = VERSION + <span class="string">'''</span></span><br><span class="line"><span class="string">This is intended for collecting directories according to cds.lib file</span></span><br><span class="line"><span class="string">It takes following inputs:</span></span><br><span class="line"><span class="string">-v:version</span></span><br><span class="line"><span class="string">-h:help</span></span><br><span class="line"><span class="string">-i:input cds.lib file location</span></span><br><span class="line"><span class="string">-c:add comment</span></span><br><span class="line"><span class="string">-m:only my libraries</span></span><br><span class="line"><span class="string">-z:compress the backup file</span></span><br><span class="line"><span class="string">-e:encrypt the compressed file</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get commands</span></span><br><span class="line">opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:], <span class="string">"mcvhzei:"</span>)</span><br><span class="line"><span class="keyword">for</span> op, value <span class="keyword">in</span> opts:</span><br><span class="line"><span class="keyword">if</span> op == <span class="string">'-v'</span>:</span><br><span class="line">exit(VERSION)</span><br><span class="line"><span class="keyword">elif</span> op == <span class="string">'-h'</span>:</span><br><span class="line">exit(HELP)</span><br><span class="line"><span class="keyword">elif</span> op == <span class="string">'-i'</span>:</span><br><span class="line">cdspath = os.path.expanduser(value)</span><br><span class="line"><span class="keyword">elif</span> op == <span class="string">'-c'</span>:</span><br><span class="line">COMMENT = <span class="literal">True</span></span><br><span class="line"><span class="keyword">elif</span> op == <span class="string">'-m'</span>:</span><br><span class="line">ONLY_MY_LIBS = <span class="literal">True</span></span><br><span class="line"><span class="keyword">elif</span> op == <span class="string">'-z'</span>:</span><br><span class="line">COMPRESS = <span class="literal">True</span></span><br><span class="line"><span class="keyword">elif</span> op == <span class="string">'-e'</span>:</span><br><span class="line">COMPRESS_ENCRYPT = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">f = open(cdspath)</span><br><span class="line"><span class="keyword">except</span> IOError:</span><br><span class="line">exit(<span class="string">'cds.lib file does not exist.'</span>)</span><br><span class="line">lines = f.readlines()</span><br><span class="line"></span><br><span class="line">addedLibs = &#123;&#125;</span><br><span class="line">skippedLibs = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">line = line.strip()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> len(line) <span class="keyword">or</span> line.startswith(<span class="string">'#'</span>):</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> line.startswith(<span class="string">'DEFINE '</span>):</span><br><span class="line">item = line.split()</span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] != os.path.basename(item[<span class="number">2</span>]):</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isabs(item[<span class="number">2</span>]):</span><br><span class="line">  item[<span class="number">2</span>] = os.path.join(os.path.dirname(cdspath), item[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ONLY_MY_LIBS:</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> item[<span class="number">2</span>].startswith(os.path.expanduser(<span class="string">'~'</span>)):</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] <span class="keyword">in</span> skipLibs:</span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> skippedLibs:</span><br><span class="line">skippedLibs[item[<span class="number">1</span>]] = item[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] <span class="keyword">in</span> addedLibs:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(item[<span class="number">2</span>]):</span><br><span class="line">addedLibs[item[<span class="number">1</span>]] = item[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n Libraries to be skipped:\n'</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> skippedLibs.keys():</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\t%s'</span> % n</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n Libraries to be backuped:\n'</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> addedLibs.keys():</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\t%s'</span> % (n)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n Options:\n'</span></span><br><span class="line"><span class="keyword">if</span> ONLY_MY_LIBS:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\tOnly my libraries'</span></span><br><span class="line"><span class="keyword">if</span> COMMENT:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\tComments required'</span></span><br><span class="line"><span class="keyword">if</span> COMPRESS:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\tCompress the files'</span></span><br><span class="line"><span class="keyword">if</span> COMPRESS_ENCRYPT:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\tPassword required'</span></span><br><span class="line"></span><br><span class="line">s = raw_input(<span class="string">'\n Begin collecting files[Y/n]?'</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> s.upper() == <span class="string">'Y'</span>:</span><br><span class="line">exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># exit('end')</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> COMPRESS <span class="keyword">and</span> COMPRESS_ENCRYPT:</span><br><span class="line">password = getpass.getpass(<span class="string">'Please input the password:'</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> password.isalnum():</span><br><span class="line">exit(<span class="string">'Only letters and numbers are permitted!'</span>)</span><br><span class="line">password2 = getpass.getpass(<span class="string">'Please input the password again:'</span>)</span><br><span class="line"><span class="keyword">if</span> password != password2:</span><br><span class="line">exit(<span class="string">'Password not match!'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate the directory name</span></span><br><span class="line">addedLibs = &#123;&#125;</span><br><span class="line">newdirname = datetime.datetime.now().strftime(<span class="string">'%Y%m%d-%H%M%S'</span>)</span><br><span class="line">os.mkdir(newdirname)</span><br><span class="line">newdir = os.path.abspath(newdirname)</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the logger</span></span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line">logger.setLevel(level = logging.INFO)</span><br><span class="line">handler = logging.FileHandler(os.path.join(newdir, <span class="string">'log'</span>))</span><br><span class="line">handler.setLevel(level = logging.INFO)</span><br><span class="line">formatter = logging.Formatter(<span class="string">'%(asctime)s - %(levelname)s - %(message)s'</span>)</span><br><span class="line">handler.setFormatter(formatter)</span><br><span class="line">console = logging.StreamHandler()</span><br><span class="line">console.setLevel(logging.INFO)</span><br><span class="line">formatter2 = logging.Formatter(<span class="string">'%(levelname)s - %(message)s'</span>)</span><br><span class="line">console.setFormatter(formatter2)</span><br><span class="line">logger.addHandler(handler)</span><br><span class="line">logger.addHandler(console)</span><br><span class="line"></span><br><span class="line">logger.info(<span class="string">'cds file loaded from '</span> + cdspath)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> COMMENT:</span><br><span class="line">os.system(<span class="string">'vi %s/comment.txt'</span> % newdir)</span><br><span class="line">f = open(<span class="string">'%s/comment.txt'</span> % newdir, <span class="string">'r'</span>)</span><br><span class="line">data = f.readlines()</span><br><span class="line">logger.info(<span class="string">'Comment:\n\n'</span> + <span class="string">''</span>.join(data))</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> PREVERVE_COMMENT:</span><br><span class="line">os.remove(<span class="string">'%s/comment.txt'</span> % newdir)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ONLY_MY_LIBS:</span><br><span class="line">logger.info(<span class="string">'Only my libraries will be backuped!'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(cdspath):</span><br><span class="line">line = line.strip()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> len(line) <span class="keyword">or</span> line.startswith(<span class="string">'#'</span>):</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> line.startswith(<span class="string">'DEFINE '</span>):</span><br><span class="line">item = line.split()</span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] != os.path.basename(item[<span class="number">2</span>]):</span><br><span class="line">logger.warning(<span class="string">'Warning: Name not match at '</span> + item[<span class="number">1</span>] + <span class="string">'('</span> + item[<span class="number">2</span>] + <span class="string">')'</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isabs(item[<span class="number">2</span>]):</span><br><span class="line">  item[<span class="number">2</span>] = os.path.join(os.path.dirname(cdspath), item[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ONLY_MY_LIBS:</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> item[<span class="number">2</span>].startswith(os.path.expanduser(<span class="string">'~'</span>)):</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] <span class="keyword">in</span> skipLibs:</span><br><span class="line">logger.warning(item[<span class="number">1</span>] + <span class="string">' has been skipped'</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> item[<span class="number">1</span>] <span class="keyword">in</span> addedLibs:</span><br><span class="line">logger.warning(item[<span class="number">1</span>] + <span class="string">' has already been added'</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(item[<span class="number">2</span>]):</span><br><span class="line">addedLibs[item[<span class="number">1</span>]] = item[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">shutil.copytree(item[<span class="number">2</span>], os.path.join(newdir, item[<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">except</span> shutil.Error, arg:</span><br><span class="line">logger.error(arg)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">logger.info(item[<span class="number">1</span>] + <span class="string">' copied from '</span> + item[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">logger.warning(item[<span class="number">2</span>] + <span class="string">' does not exist'</span>)</span><br><span class="line"></span><br><span class="line">logger.info(<span class="string">'Finished!'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> COMPRESS:</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\nStart compressing:'</span></span><br><span class="line"><span class="keyword">if</span> COMPRESS_ENCRYPT:</span><br><span class="line">os.system(<span class="string">'tar -czvf - %s | openssl des3 -salt -k %s -out %s.tar.gz'</span> % (newdirname, password, newdirname))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">os.system(<span class="string">'tar -czvf %s.tar.gz %s'</span> % (newdirname, newdirname))</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li><p>樟樟22, <a href="https://www.cnblogs.com/zz22--/p/7719285.html" target="_blank" rel="noopener">Python中getopt()函数的使用</a></p></li><li><p>Wizey, <a href="https://cloud.tencent.com/developer/article/1354396" target="_blank" rel="noopener">Python日志库logging总结-可能是目前为止将logging库总结的最好的一篇文章</a></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
            <tag> ENCv1 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>串并转换和阻抗变换</title>
      <link href="/archives/abd732af/series-parallel-conversion.html"/>
      <url>/archives/abd732af/series-parallel-conversion.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了串联和并联电路的转换，以及Q值的计算。</p><a id="more"></a><h2 id="串并联转换"><a href="#串并联转换" class="headerlink" title="串并联转换"></a>串并联转换</h2><h3 id="串联-gt-并联"><a href="#串联-gt-并联" class="headerlink" title="串联-&gt;并联"></a>串联-&gt;并联</h3><p><img src="series-parallel-conversion/series-to-parallel.svg" alt="series-to-parallel"></p><script type="math/tex; mode=display">Q=\frac{X_s}{R_s}\\R_p=(1+Q^2)R_s\\X_p=X_s\left(1+\frac{1}{Q^2}\right)</script><h3 id="并联-gt-串联"><a href="#并联-gt-串联" class="headerlink" title="并联-&gt;串联"></a>并联-&gt;串联</h3><p><img src="series-parallel-conversion/parallel-to-series.svg" alt="parallel-to-series"></p><script type="math/tex; mode=display">Q=\frac{R_p}{X_p}\\R_s=\frac{R_p}{(1+Q^2)}\\X_s=\frac{X_p}{\left(1+\frac{1}{Q^2}\right)}</script><h2 id="谐振网络Q值的计算"><a href="#谐振网络Q值的计算" class="headerlink" title="谐振网络Q值的计算"></a>谐振网络Q值的计算</h2><p>串联或者并联谐振网络的Q值为</p><script type="math/tex; mode=display">\frac{1}{Q}=\frac{1}{Q_L}+\frac{1}{Q_C}</script><p>对于并联谐振网络且有多个电容的，为</p><script type="math/tex; mode=display">\frac{1}{Q}=\frac{1}{Q_L}+\sum_{n}\frac{C_n}{C_{tot}}\frac{1}{Q_{C_n}}</script><p>其中$C_{tot}=\sum_nC_n$</p><h2 id="阻抗匹配"><a href="#阻抗匹配" class="headerlink" title="阻抗匹配"></a>阻抗匹配</h2><h3 id="L型"><a href="#L型" class="headerlink" title="L型"></a>L型</h3><h4 id="Rs-gt-Rl"><a href="#Rs-gt-Rl" class="headerlink" title="Rs&gt;Rl"></a>Rs&gt;Rl</h4><p><img src="series-parallel-conversion/image-20200308200135152.png" alt="Rs greater than Rl"></p><p>可得</p><script type="math/tex; mode=display">Q=\sqrt{\frac{R_S}{R_L}-1}\\X_S=QR_L\\X_P=\frac{R_S}{Q}</script><h4 id="Rs-lt-Rl"><a href="#Rs-lt-Rl" class="headerlink" title="Rs&lt;Rl"></a>Rs&lt;Rl</h4><p><img src="series-parallel-conversion/image-20200308200431500.png" alt="Rs smaller than Rl"></p><p>可得</p><script type="math/tex; mode=display">Q=\sqrt{\frac{R_L}{R_S}-1}\\X_P=\frac{R_L}{Q}\\X_S=QR_S</script><h3 id="电容部分接入"><a href="#电容部分接入" class="headerlink" title="电容部分接入"></a>电容部分接入</h3><p><img src="series-parallel-conversion/image-20200308200849775.png" alt="Capacitive impedance matching"></p><p>当$Q\gg1$时，可将并联网络转换为串联网络，再将其转回并联网络。在第一次转换后，$C_1&#39;\approx C_1,R_S=[(\omega C_1)^2R_L]^{-1}$；在第二次转换后，有</p><script type="math/tex; mode=display">\begin{aligned}C_{eq} &= \frac{C_1C_2}{C_1+C_2}\\R_{tot} &= \frac{1}{(\omega C_{eq})^2R_S}\\        &= \left(1+\frac{C_1}{C_2}\right)^2R_L\end{aligned}</script><p>对于低Q电路而言，有</p><script type="math/tex; mode=display">Y_{in}=\frac{j\omega C_2(1+j\omega R_LC_1)}{1+j\omega R_L(C_1+C_2)}</script><p>其等效并联电阻为</p><script type="math/tex; mode=display">R_{tot}=\frac{1}{\omega^2C_2^2R_L}+R_L\left(1+\frac{C_1}{C_2}\right)^2</script><h2 id="理论推导"><a href="#理论推导" class="headerlink" title="理论推导"></a>理论推导</h2><p>这里包含上面三个结论的理论推导。</p><h3 id="并联-gt-串联-1"><a href="#并联-gt-串联-1" class="headerlink" title="并联-&gt;串联"></a>并联-&gt;串联</h3><p><img src="series-parallel-conversion/series-parallel.svg" alt="series-parallel"></p><p>推导如下</p><script type="math/tex; mode=display">\begin{aligned}R_s+jX_s&=\frac{1}{\frac{1}{R_p}+\frac{1}{jX_p}}\\&=\frac{R_pX_p^2}{R_p^2+X_p^2}+j\frac{R_p^2X_p}{R_p^2+X_p^2}\\&=\frac{R_p}{(1+Q^2)}+j\frac{X_p}{\left(1+\frac{1}{Q^2}\right)}\end{aligned}</script><p>相应的，交换顺序可得串联-&gt;并联。</p><h3 id="实际并联LC网络的Q值"><a href="#实际并联LC网络的Q值" class="headerlink" title="实际并联LC网络的Q值"></a>实际并联LC网络的Q值</h3><p>考虑一个具有Q值的电感和电容的并联谐振，其中电感常用串联LR模型，电容常用并联CR模型。</p><p><img src="series-parallel-conversion/shunt-rlc-Q.svg" alt="shunt-rlc-Q"></p><p>计算这个网络的等效Q值时，首先将串联的LR转换为等效并联LR，有</p><script type="math/tex; mode=display">R_{s,p}=R_s(1+Q_L^2)\\L_{s,p}=L_s\left(1+\frac{1}{Q_L^2}\right)</script><p>将两个电阻并联，有</p><script type="math/tex; mode=display">R_{s,p||p}=\frac{1}{\frac{1}{R_{s,p}}+\frac{1}{R_p}}</script><p>于是整体Q值为</p><script type="math/tex; mode=display">\begin{aligned}Q&=\omega C_pR_{s,p||p}\\&=\frac{\omega C_p}{\frac{1}{R_{s,p}}+\frac{1}{R_p}}\\&=\frac{1}{\frac{1}{\omega C_pR_{s,p}}+\frac{1}{Q_C}}\\&=\frac{1}{\frac{\omega L_{s,p}}{R_{s,p}}+\frac{1}{Q_C}}\\&=\frac{1}{\frac{1}{Q_L}+\frac{1}{Q_C}}\\\end{aligned}</script><p>也即</p><script type="math/tex; mode=display">\frac{1}{Q}=\frac{1}{Q_L}+\frac{1}{Q_C}</script><p>值得注意的是，其中的$\omega$定义为</p><script type="math/tex; mode=display">\omega=\frac{1}{\sqrt{L_{s,p}C_p}}=\frac{\sqrt{1-\frac{C_pR_s^2}{L_s}}}{\sqrt{L_{s}C_p}}\approx\frac{1}{\sqrt{L_{s}C_p}}</script><p>当串联电阻较小时可以简化为最后一项。</p><h3 id="实际串联LC网络的Q值"><a href="#实际串联LC网络的Q值" class="headerlink" title="实际串联LC网络的Q值"></a>实际串联LC网络的Q值</h3><p>另考虑一个具有Q值的电感和电容的串联谐振。</p><p><img src="series-parallel-conversion/series-rlc-Q.svg" alt="series-rlc-Q"></p><p>计算这个网络的等效Q值时，首先将并联LC转换为等效串联的LC，有</p><script type="math/tex; mode=display">R_{p,s}=\frac{R_p}{(1+Q_C^2)}\\C_{p,s}=C_p\left(1+\frac{1}{Q_C^2}\right)</script><p>将两个电阻串联，有</p><script type="math/tex; mode=display">R_{p,s+s}=R_s+R_{p,s}</script><p>于是整体Q值为</p><script type="math/tex; mode=display">\begin{aligned}Q&=\frac{\omega L_s}{R_s+R_{p,s}}\\&=\frac{1}{\frac{1}{Q_L}+\frac{R_{p,s}}{\omega L_s}}\\&=\frac{1}{\frac{1}{Q_L}+\omega C_{p,s}R_{p,s}}\\&=\frac{1}{\frac{1}{Q_L}+\frac{1}{Q_C}}\\\end{aligned}</script><p>也即</p><script type="math/tex; mode=display">\frac{1}{Q}=\frac{1}{Q_L}+\frac{1}{Q_C}</script><p>此时，$\omega$定义为</p><script type="math/tex; mode=display">\omega=\frac{1}{\sqrt{L_{s}C_{p,s}}}=\frac{\sqrt{1-\frac{L_s}{C_pR_p^2}}}{\sqrt{L_{s}C_p}}\approx\frac{1}{\sqrt{L_{s}C_p}}</script><p>当并联电阻较大时可以简化为最后一项。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>相关内容可以参考</p><ul><li>B. Razavi, <em>RF Microelectronics</em>.</li><li>李志群, 王志功, <em>射频集成电路与系统</em>.</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ADS创建电感Pcell</title>
      <link href="/archives/1e678d19/ads-inductor-pcell.html"/>
      <url>/archives/1e678d19/ads-inductor-pcell.html</url>
      
        <content type="html"><![CDATA[<p>电感是射频集成电路设计中的基础原件，也是变压器的构成部分。通常，电感越接近圆形其面积(磁通量，电感)/边长(串联损耗)比越高，因而Q值越高。但在CMOS工艺下，有时只允许使用直线和45°折线，因此设计时多数退而求其次绘制八边形电感。绘制八边形电感由于需要处理边角和格点，十分繁琐，因此可以通过编写程序省去这部分重复性工作。本文介绍了一种基于ADS AEL语言的电感Pcell设计方法。</p><a id="more"></a><h2 id="预备"><a href="#预备" class="headerlink" title="预备"></a>预备</h2><p>AEL绘制多边形的语法为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">decl coors = list(</span><br><span class="line">list(0, 0),</span><br><span class="line">list(2, 0),</span><br><span class="line">list(2, 2),</span><br><span class="line">list(0, 2),</span><br><span class="line">list(0, 0)</span><br><span class="line">);</span><br><span class="line">decl newPolygon = db_create_primitive_polygon(coors);</span><br><span class="line">db_create_polygon(context, layerM1, newPolygon);</span><br></pre></td></tr></table></figure><p>上面的代码先定义了一个坐标的列表，列表中的每个元素代表多边形一个顶点。每个顶点又由一个2个元素的列表<code>list(x, y)</code>构成，分别代表为x、y的坐标。因此，上面的代码绘制了一个左下角在<code>(0, 0)</code>的边长为2的正方形。之后，先使用<code>db_create_primitive_polygon</code>将其创建成为原始多边形，再增加层信息后使用<code>db_create_polygon</code>将原始多边形加入设计数据库。</p><p>由于AEL不支持类型，对坐标进行修改只能通过函数进行。值得注意的是，AEL中列表的赋值是引用传递，因此当使用<code>decl coors2 = coors;</code>后，<code>coors2</code>和<code>coors</code>指向同一个位置，对其中之一修改也会影响到另一个。我们设计了一个函数对多边形进行整体平移和翻转：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">defun adjust(l, xc, yc, x, y)</span><br><span class="line">&#123;</span><br><span class="line">decl i = 0;</span><br><span class="line">decl len = listlen( l );//获得列表长度</span><br><span class="line">for( i = 0; i &lt; len; i++ )//遍历列表</span><br><span class="line">&#123;</span><br><span class="line">//生成平移和翻转后的坐标，由于采用了垃圾回收机制，新生成的列表t不是局部变量</span><br><span class="line">decl t = list(l[i][0] * xc + x, l[i][1] * yc + y);</span><br><span class="line">//替换原有元素</span><br><span class="line">repla(l, t, i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>它接受5个参数，第1个是列表，第2、3个分别是x、y的缩放系数，第4、5个是x、y的平移系数。</p><p>此外，为了防止设计的版图顶点不在格点上，我们附加了<code>grid_ceil2</code>和<code>grid_floor2</code>两个相对格点取整的函数，他们以微米为单位对0.01取整。</p><h2 id="交错部分设计"><a href="#交错部分设计" class="headerlink" title="交错部分设计"></a>交错部分设计</h2><p>此部分由函数<code>create_crossing</code>实现。</p><p>首先计算几个常用量，由</p><script type="math/tex; mode=display">\tan(2\theta)=\frac{2\tan(\theta)}{1-\tan^2(\theta)}</script><p>可以算得</p><script type="math/tex; mode=display">\tan(22.5^\circ)=\sqrt{2}-1</script><p>考虑版图</p><p><img src="ads-inductor-pcell/crossing.svg" alt="crossing"></p><p>可以计算出各点的位置</p><div class="table-container"><table><thead><tr><th style="text-align:center">位置</th><th style="text-align:center">坐标</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">（ -t, 0 ）</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">( -(w + s - e) / 2, 0 )</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">( (w + s + e) / 2, w + s )</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">( t, w + s )</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">( t, 2w + s )</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">( (w + s - e) / 2, 2w + s )</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">( -(w + s + e) / 2, w )</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">( -t, w )</td></tr></tbody></table></div><p>其中$e=(\sqrt{2}-1)w$，相反方向的可以通过<code>adjust</code>函数实现。</p><h2 id="线圈边缘设计"><a href="#线圈边缘设计" class="headerlink" title="线圈边缘设计"></a>线圈边缘设计</h2><p>此部分由函数<code>create_coil</code>实现。</p><p>线圈边缘如图</p><p><img src="ads-inductor-pcell/coil.svg" alt="coil"></p><p>对应坐标为</p><div class="table-container"><table><thead><tr><th style="text-align:center">位置</th><th style="text-align:center">坐标</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">( t, Dh + Dd - w )</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">( Dw - e &lt; Dw + Dd - w ? Dw - e : Dw + Dd - w, Dh + Dd - w )</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">( Dw + Dd - w, Dh - e &lt; Dh + Dd - w ? Dh - e : Dh + Dd - w )</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">( Dw + Dd - w, -Dh + e &gt; -Dh - Dd + w ? -Dh + e : -Dh - Dd + w )</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">( Dw - e &lt; Dw + Dd - w ? Dw - e : Dw + Dd - w, - Dh - Dd + w )</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">( t, - Dh - Dd + w )</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">( t, - Dh - Dd )</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">( Dw, - Dh - Dd )</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">( Dw + Dd, - Dh )</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">( Dw + Dd, Dh )</td></tr><tr><td style="text-align:center">11</td><td style="text-align:center">( Dw, Dh + Dd )</td></tr><tr><td style="text-align:center">12</td><td style="text-align:center">( t, Dh + Dd )</td></tr></tbody></table></div><p>相反方向的可以通过<code>adjust</code>函数实现。</p><h2 id="延展设计"><a href="#延展设计" class="headerlink" title="延展设计"></a>延展设计</h2><p>此部分由函数<code>create_tj</code>实现。</p><p>延展部分和交错部分非常相似，其特殊之处在于两侧可宽度不同</p><p><img src="ads-inductor-pcell/extension.svg" alt="coil"></p><p>为了使图形尽可能平衡，令上、下的内侧长度均为$a_l$，中间线宽为两侧均值，有</p><script type="math/tex; mode=display">\begin{aligned}a_l+a_r+(s_2-s_1)&=e\\w_1+\frac{a_r-a_l-(\sqrt{2}-1)w_1}{\sqrt{2}}&=\frac{w_1+w_2}{2}\end{aligned}</script><p>由此可解出各点坐标。</p><h2 id="多圈绘制"><a href="#多圈绘制" class="headerlink" title="多圈绘制"></a>多圈绘制</h2><p>此部分由函数<code>create_diff_inductor</code>实现。</p><p>其核心在于计算每圈的Dw, Dd, Dh，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">decl ew = grid_ceil2( W * (sqrt(2) - 1) );</span><br><span class="line">decl es = grid_ceil2( S * (sqrt(2) - 1) );</span><br><span class="line">decl newDw = grid_floor2( Dw - ew - es );</span><br><span class="line">decl newDh = grid_floor2( Dh - ew - es );</span><br><span class="line">decl newDd = grid_floor2( Dd - W - S + ew + es );</span><br><span class="line">// 支持矩形电感</span><br><span class="line">if(newDd &lt; 0)</span><br><span class="line">&#123;</span><br><span class="line">    newDw = newDw + newDd;</span><br><span class="line">    newDh = newDh + newDd;</span><br><span class="line">    newDd = 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>绘制出的电感如下图</p><p><img src="ads-inductor-pcell/ind.png" alt="ind" style="zoom:50%;"></p><p>可以看出，其具有电感的完整功能，且各部分可调。同时也可以支持矩形（RD=0）或者矩形/八边形混合电感（RD较小）。</p><p><img src="ads-inductor-pcell/ind_square.png" alt="ind_square" style="zoom: 50%;"></p><p>此外，将两个电感组合起来，也可以轻松实现变压器。</p><p><img src="ads-inductor-pcell/transformer.png" alt="transformer" style="zoom: 50%;"></p><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>完整代码如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line">load(&quot;vias.ael&quot;);</span><br><span class="line"></span><br><span class="line">defun grid_ceil2(input)</span><br><span class="line">&#123;</span><br><span class="line">return ceil(100*input)/100.0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun grid_floor2(input)</span><br><span class="line">&#123;</span><br><span class="line">return floor(100*input)/100.0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun adjust(l, xc, yc, x, y)</span><br><span class="line">&#123;</span><br><span class="line">decl i = 0;</span><br><span class="line">decl len = listlen( l );</span><br><span class="line">for( i = 0; i &lt; len; i++ )</span><br><span class="line">&#123;</span><br><span class="line">decl t = list(l[i][0] * xc + x, l[i][1] * yc + y);</span><br><span class="line">repla(l, t, i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun create_crossing(context, layerM1, w, s, t, x, y, xc, yc)</span><br><span class="line">&#123;</span><br><span class="line">e = grid_ceil2( w * (sqrt(2) - 1) );</span><br><span class="line">decl x1 = (w + s - e) / 2.0;</span><br><span class="line">decl x2 = (w + s + e) / 2.0;</span><br><span class="line">decl coors = list(</span><br><span class="line">list(- t, 0),</span><br><span class="line">list(- x1 , 0),</span><br><span class="line">list(x2, w + s),</span><br><span class="line">list(t, w + s),</span><br><span class="line">list(t, 2 * w + s),</span><br><span class="line">list(x1, 2 * w + s),</span><br><span class="line">list(- x2, w),</span><br><span class="line">list(- t, w),</span><br><span class="line">list(- t, 0)</span><br><span class="line">);</span><br><span class="line">adjust(coors, xc, yc, x, y);</span><br><span class="line">decl newPolygon = db_create_primitive_polygon(coors);</span><br><span class="line">db_create_polygon(context, layerM1, newPolygon);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun create_coil(context, layerM, Dw, Dh, Dd, w, t, x, y)</span><br><span class="line">&#123;</span><br><span class="line">decl e = grid_ceil2( w * (sqrt(2) - 1) );</span><br><span class="line">decl coors = list(</span><br><span class="line">list(t, Dh + Dd - w),</span><br><span class="line">list(Dw - e &lt; Dw + Dd - w ? Dw - e : Dw + Dd - w, Dh + Dd - w),</span><br><span class="line">list(Dw + Dd - w, Dh - e &lt; Dh + Dd - w ? Dh - e : Dh + Dd - w),</span><br><span class="line">list(Dw + Dd - w, -Dh + e &gt; -Dh - Dd + w ? -Dh + e : -Dh - Dd + w),</span><br><span class="line">list(Dw - e &lt; Dw + Dd - w ? Dw - e : Dw + Dd - w, - Dh - Dd + w),</span><br><span class="line">list(t, - Dh - Dd + w),</span><br><span class="line">list(t, - Dh - Dd),</span><br><span class="line">list(Dw, - Dh - Dd),</span><br><span class="line">list(Dw + Dd, - Dh),</span><br><span class="line">list(Dw + Dd, Dh),</span><br><span class="line">list(Dw, Dh + Dd),</span><br><span class="line">list(t, Dh + Dd),</span><br><span class="line">list(t, Dh + Dd - w)</span><br><span class="line">);</span><br><span class="line">adjust(coors, 1, 1, x, y);</span><br><span class="line">decl newPolygon = db_create_primitive_polygon(coors);</span><br><span class="line">db_create_polygon(context, layerM, newPolygon);</span><br><span class="line"></span><br><span class="line">adjust(coors, -1, 1, 0, 0);</span><br><span class="line">decl newPolygon2 = db_create_primitive_polygon(coors);</span><br><span class="line">db_create_polygon(context, layerM, newPolygon2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun create_tj(context, layerM, w1, s1, t, w2, s2, e, x, y, dir)</span><br><span class="line">&#123;</span><br><span class="line">decl d = s2 - s1;</span><br><span class="line">decl ar = grid_floor2( 0.5 * ( sqrt(2)/2 * (w1 + w2) - w1 +e - s2 + s1 ) );</span><br><span class="line">decl al = e - ar - s2 + s1;</span><br><span class="line">decl coors = list(</span><br><span class="line">list(-t, 0),</span><br><span class="line">list(-s1, 0),</span><br><span class="line">list(-s1, -w1 - ar),</span><br><span class="line">list(-s2, -w1 - ar - (s2-s1)),</span><br><span class="line">list(-s2, -w1 - e),</span><br><span class="line">list(-s2 - w2, -w1 - e),</span><br><span class="line">list(-s2 - w2, -w1 - al - (w2+s2-w1-s1)),</span><br><span class="line">list(-s1 - w1, -w1 - al),</span><br><span class="line">list(-s1 - w1, -w1),</span><br><span class="line">list(-t, -w1),</span><br><span class="line">list(-t, 0)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">db_create_pin(context, x-s2-w2/2, pow(-1, dir)*(y+e+w1), pow(-1, dir)*90, layerM);</span><br><span class="line">db_create_pin(context, x+s2+w2/2, pow(-1, dir)*(y+e+w1), pow(-1, dir)*90, layerM);</span><br><span class="line"></span><br><span class="line">adjust(coors, 1, pow(-1, dir+1), x, pow(-1, dir)*y);</span><br><span class="line">decl newPolygon = db_create_primitive_polygon(coors);</span><br><span class="line">db_create_polygon(context, layerM, newPolygon);</span><br><span class="line"></span><br><span class="line">adjust(coors, -1, 1, 0, 0);</span><br><span class="line">decl newPolygon2 = db_create_primitive_polygon(coors);</span><br><span class="line">db_create_polygon(context, layerM, newPolygon2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun create_diff_inductor(context, MT, MB, D, W, S, C, RH, RD, s1, w2, s2, e, x, y, dir, combine)</span><br><span class="line">&#123;</span><br><span class="line">decl AP = db_get_layerid(context, &quot;AP&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M9 = db_get_layerid(context, &quot;M9&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M8 = db_get_layerid(context, &quot;M8&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M7 = db_get_layerid(context, &quot;M7&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M6 = db_get_layerid(context, &quot;M6&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M5 = db_get_layerid(context, &quot;M5&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M4 = db_get_layerid(context, &quot;M4&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M3 = db_get_layerid(context, &quot;M3&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M2 = db_get_layerid(context, &quot;M2&quot;, &quot;drawing&quot;);</span><br><span class="line">decl M1 = db_get_layerid(context, &quot;M1&quot;, &quot;drawing&quot;);</span><br><span class="line">decl Metals = list(M1, M1, M2, M3, M4, M5, M6, M7, M8, M9, AP);</span><br><span class="line">decl via9 = db_get_layerid(context, &quot;via9&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via8 = db_get_layerid(context, &quot;via8&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via7 = db_get_layerid(context, &quot;via7&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via6 = db_get_layerid(context, &quot;via6&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via5 = db_get_layerid(context, &quot;via5&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via4 = db_get_layerid(context, &quot;via4&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via3 = db_get_layerid(context, &quot;via3&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via2 = db_get_layerid(context, &quot;via2&quot;, &quot;drawing&quot;);</span><br><span class="line">decl via1 = db_get_layerid(context, &quot;via1&quot;, &quot;drawing&quot;);</span><br><span class="line">decl Vias = list(via1, via1, via2, M3, M4, M5, M6, M7, M8, M9, AP);</span><br><span class="line"></span><br><span class="line">decl layerM1 = Metals[MT];</span><br><span class="line">decl layerM2 = Metals[MB];</span><br><span class="line"></span><br><span class="line">decl i = 0;</span><br><span class="line">decl Dw = grid_ceil2( D / 2 );</span><br><span class="line">decl Dh = grid_ceil2( D / 2 * RH );</span><br><span class="line">decl Dd = grid_ceil2( D * RD / sqrt(2) );</span><br><span class="line">decl ew = grid_ceil2( W * (sqrt(2) - 1) );</span><br><span class="line">decl es = grid_ceil2( S * (sqrt(2) - 1) );</span><br><span class="line"></span><br><span class="line">decl iDW = Dw;</span><br><span class="line">for(i = 0; i &lt; C - 1; i++)</span><br><span class="line">iDW = grid_floor2( iDW - ew - es );</span><br><span class="line">decl wv = grid_floor(iDW - (1 + (W + S + ew) / 2));</span><br><span class="line">if(wv &gt; 2 * W)</span><br><span class="line">wv = 2 * W;</span><br><span class="line">decl t = grid_floor( wv + 1 + (W + S + ew) / 2 );</span><br><span class="line"></span><br><span class="line">create_tj(context, layerM1, W, s1, t, w2, s2, e, x, y+Dh+Dd-W, dir);</span><br><span class="line"></span><br><span class="line">for(i = 0; i &lt; C; i++)</span><br><span class="line">&#123;</span><br><span class="line">create_coil(context, layerM1, Dw, Dh, Dd, W, t, x, y);</span><br><span class="line">decl newDw = grid_floor2( Dw - ew - es );</span><br><span class="line">decl newDh = grid_floor2( Dh - ew - es );</span><br><span class="line">decl newDd = grid_floor2( Dd - W - S + ew + es );</span><br><span class="line">if(newDd &lt; 0)</span><br><span class="line">&#123;</span><br><span class="line">newDw = newDw + newDd;</span><br><span class="line">newDh = newDh + newDd;</span><br><span class="line">newDd = 0;</span><br><span class="line">&#125;</span><br><span class="line">decl cs = Dh + Dd - newDh - newDd - W;</span><br><span class="line">if(i != C - 1)</span><br><span class="line">&#123;</span><br><span class="line">if(dir == 0)</span><br><span class="line">&#123;</span><br><span class="line">create_crossing(context, layerM1, W, cs, t, x, y-Dh-Dd, 1, 1);</span><br><span class="line">create_crossing(context, layerM2, W, cs, t, x, y-Dh-Dd, -1, 1);</span><br><span class="line">via_fill7to9(MB, MT, wv, W, 0.3, 0.3, 0.3, 0.3, x-t, y-(Dh+Dd)+W+cs, combine);</span><br><span class="line">via_fill7to9(MB, MT, wv, W, 0.3, 0.3, 0.3, 0.3, x+t-wv, y-(Dh+Dd), combine);</span><br><span class="line">&#125;</span><br><span class="line">if(dir == 1)</span><br><span class="line">&#123;</span><br><span class="line">create_crossing(context, layerM1, W, cs, t, x, y+Dh+Dd, 1, -1);</span><br><span class="line">create_crossing(context, layerM2, W, cs, t, x, y+Dh+Dd, -1, -1);</span><br><span class="line">via_fill7to9(MB, MT, wv, W, 0.3, 0.3, 0.3, 0.3, x-t, y+Dh+Dd-2*W-cs, combine);</span><br><span class="line">via_fill7to9(MB, MT, wv, W, 0.3, 0.3, 0.3, 0.3, x+t-wv, y+Dh+Dd-W, combine);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">db_add_rectangle(context, layerM1, x-t, y+pow(-1, dir+1)*(Dh+Dd), x+t, y+pow(-1, dir+1)*(Dh+Dd-W));</span><br><span class="line">Dw = newDw;</span><br><span class="line">Dh = newDh;</span><br><span class="line">Dd = newDd;</span><br><span class="line">dir = 1 - dir;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun create_diff_inductor2(context, MT, MB, D, W, S, C, RH, RD, s1, w2, s2, e, x, y, dir, combine)</span><br><span class="line">&#123;</span><br><span class="line">D = grid_ceil2( D * RH );</span><br><span class="line">RH = 1 / RH;</span><br><span class="line">RD = RD * RH;</span><br><span class="line">create_diff_inductor(context, MT, MB, D, W, S, C, RH, RD, s1, w2, s2, e, x, y, dir, combine);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defun diff_inductor(MT, MB, D, W, S, C, RH, RD, s1, w2, s2, e, dir, combine)</span><br><span class="line">&#123;</span><br><span class="line">decl designContext = de_get_current_design_context();</span><br><span class="line">decl mks2uu = db_get_mks_to_uu_factor(designContext);</span><br><span class="line"></span><br><span class="line">D = D * mks2uu;</span><br><span class="line">W = W * mks2uu;</span><br><span class="line">S = S * mks2uu;</span><br><span class="line">C = floor(C);</span><br><span class="line">s1 = s1 * mks2uu;</span><br><span class="line">w2 = w2 * mks2uu;</span><br><span class="line">s2 = s2 * mks2uu;</span><br><span class="line">e = e * mks2uu;</span><br><span class="line">dir = floor(dir);</span><br><span class="line">combine = floor(combine);</span><br><span class="line"></span><br><span class="line">create_diff_inductor2(designContext, MT, MB, D, W, S, C, RH, RD, s1, w2, s2, e, 0, 0, dir, combine);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>二阶系统</title>
      <link href="/archives/5777cf8/frequency-response.html"/>
      <url>/archives/5777cf8/frequency-response.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍了二阶系统的基本概念。</p><a id="more"></a><h2 id="二阶系统"><a href="#二阶系统" class="headerlink" title="二阶系统"></a>二阶系统</h2><p>二阶系统的传递函数为</p><script type="math/tex; mode=display">G(s)=\frac{\omega_n^2}{s^2+2\zeta\omega_ns+\omega_n^2}</script><p>其中$\omega_n$为自然频率，也可写成</p><script type="math/tex; mode=display">G(j\omega)=\frac{1}{1-(\frac{\omega}{\omega_n})^2+j2\zeta\frac{\omega}{\omega_n}}</script><p>可以近似得到$Q=1/2\zeta$</p><h3 id="瞬态分析"><a href="#瞬态分析" class="headerlink" title="瞬态分析"></a>瞬态分析</h3><p>极点为</p><script type="math/tex; mode=display">-\zeta\omega_n\pm\omega_n\sqrt{\zeta^2-1}</script><p>其实部定义为阻尼（damping）</p><script type="math/tex; mode=display">\sigma=-\zeta\omega_n</script><p>虚部定义为衰减后振荡频率（damped natural frequency）</p><script type="math/tex; mode=display">\omega_d=\omega_n\sqrt{1-\zeta^2}</script><p>因此</p><ul><li>$\zeta&lt;-1$，极点为右半平面一对不相等实数（无震荡发散）</li><li>$\zeta=-1$，极点为右半平面一对相等实数（发散，无震荡临界情况）</li><li>$-1&lt;\zeta&lt;0$，极点为右半平面一对复数（震荡发散）</li><li>$\zeta=0$，极点为虚轴上一对大小相等符号相反的虚数（无衰减震荡）</li><li>$0&lt;\zeta&lt;1$，极点为左半平面一对复数（欠阻尼衰减）</li><li>$\zeta=1$，极点为左半平面一对相等实数（衰减，临界阻尼）</li><li>$\zeta&gt;1$，极点为左半平面一对不相等实数（过阻尼衰减）</li></ul><p>当有输入信号为阶跃函数时，有</p><script type="math/tex; mode=display">\begin{aligned}Y(s) &=G(s) \cdot U(s) \\&=\frac{\omega_{n}^{2}}{s^{2}+2 \zeta \omega_{n} s+\omega_{n}^{2}} \cdot \frac{1}{s} \\&=\frac{\omega_{n}^{2}}{(s+\sigma)^{2}+\omega_{d}^{2}} \cdot \frac{1}{s} \\&=\frac{1}{s}-\frac{s+\sigma}{(s+\sigma)^{2}+\omega_{d}^{2}}-\frac{\sigma}{\omega_{d}} \frac{\omega_{d}}{(s+\sigma)^{2}+\omega_{d}^{2}}\end{aligned}</script><p>相应的时域表达式为</p><script type="math/tex; mode=display">\begin{aligned}y(t) &=1-e^{-\sigma t} \cos \omega_{d} t-\frac{\sigma}{\omega_{d}} e^{-\sigma t} \sin \omega_{d} t \\&=1-e^{-\sigma t}\left(\cos \omega_{d} t+\frac{\sigma}{\omega_{d}} \sin \omega_{d} t\right), t \geq 0\end{aligned}</script><p>对于$\omega_n=2\pi$，不同$\zeta$时阶跃响应如下图</p><p><img src="frequency-response/step-response.png" alt="step-response"></p><h3 id="稳态分析"><a href="#稳态分析" class="headerlink" title="稳态分析"></a>稳态分析</h3><p>幅频响应为</p><script type="math/tex; mode=display">A(\omega)=|G(j \omega)|=\frac{1}{\sqrt{\left[1-\left(\frac{\omega}{\omega_{n}}\right)^{2}\right]^{2}+\left(2 \zeta \frac{\omega}{\omega_{n}}\right)^{2}}}</script><p>相频响应为</p><script type="math/tex; mode=display">\varphi(\omega)=-180^{\circ}+\arctan \frac{\left(\frac{\omega}{\omega_{n}}\right)^{2}-1}{2 \zeta \frac{\omega}{\omega_{n}}}</script><p>分析三种边界情况，有</p><script type="math/tex; mode=display">\begin{aligned}\omega=0 &\quad  A(0)=1, \varphi(0)=0^{\circ} \\\omega=\omega_{n} &\quad A(\omega)=\frac{1}{2 \zeta},\varphi\left(\omega_{n}\right)=-90^{\circ} \\\omega \rightarrow \infty &\quad A(\infty)=0, \varphi(\infty)=-180^{\circ}\end{aligned}</script><p>对幅频响应的分母求极值，得到谐振频率</p><script type="math/tex; mode=display">\omega_r=\omega_n\sqrt{1-2\zeta^2}</script><p>以及谐振时的幅值和相位</p><script type="math/tex; mode=display">A(\omega_r)=\frac{1}{2\zeta\sqrt{1-\zeta^2}}</script><script type="math/tex; mode=display">\varphi(\omega_r)=-\arctan\frac{\zeta}{\sqrt{1-2\zeta^2}}</script><p>因此，阻尼因子$\zeta $决定了</p><ul><li>当$\zeta&gt;1/\sqrt{2}$时，不存在谐振频率</li><li>当$\zeta=1/\sqrt{2}$时，$\omega_r=0, A(\omega_r)=1, \varphi(\omega_r)=0$</li><li>当$0&lt;\zeta&lt;1/\sqrt{2}$时，存在谐振频率</li><li>当$\zeta=0$时，$\omega_r=\omega_n, A(\omega_r)\rightarrow\infty, \varphi(\omega_r)=-90^{\circ}$</li></ul><p>同样的，对于$\omega_n=2\pi$，不同$\zeta$时频率响应如下图</p><p><img src="frequency-response/frequency-response.png" alt="frequency-response"></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/48169298" target="_blank" rel="noopener">控制理论学习笔记（4）——一阶系统和二阶系统</a>.</li><li>孙晓波, 李双全, 王海英. 自动控制原理. 科学出版社, 2006.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Analog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>变压器的跨阻推导</title>
      <link href="/archives/33e60fbc/transformer-equation-derivation.html"/>
      <url>/archives/33e60fbc/transformer-equation-derivation.html</url>
      
        <content type="html"><![CDATA[<p>变压器是射频集成电路设计中极为重要的元件，它可以提供：</p><ul><li>初级线圈和次级线圈的直流阻断</li><li>初级线圈的次级线圈的中心抽头是虚地，可用于连接直流偏置</li><li>阻抗匹配</li></ul><p>在毫米波频段，其占用面积小，可实现的插入损耗、带宽相比于分立元件有较大优势。变压器的分析通常使用电感耦合的RLC谐振网络进行。</p><a id="more"></a><p><img src="transformer-equation-derivation/mcr.svg" alt="mcr"></p><p>本文复现了两篇论文对变压器$Z_{21}$的分析、推导。</p><h2 id="Haikun-Jia的推导"><a href="#Haikun-Jia的推导" class="headerlink" title="Haikun Jia的推导"></a>Haikun Jia的推导</h2><p>Jia推导的核心在于直接列写KCL、KVL方程。</p><script type="math/tex; mode=display">\left\{\begin{aligned}j\omega L_1I_{p1}+j\omega MI_{p2}=U_1\\j\omega MI_{p1}+j\omega L_2I_{p2}=U_2\\I_1-j\omega C_1U_1-\frac{U_1}{R_1}=I_{p1}\\-j\omega C_2U_2-\frac{U_2}{R_2}=I_{p2}\\\end{aligned}\right.</script><p>之后直接求解</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br><span class="line">syms R1 L1 C1 R2 L2 C2 M s</span><br><span class="line">syms V1 V2 Ip1 Ip2 Iin</span><br><span class="line"></span><br><span class="line"><span class="comment">%Transformer equations</span></span><br><span class="line"><span class="comment">%V2 == 1i * w * L2 * Ip2 + 1i * w * M * Ip1</span></span><br><span class="line"><span class="comment">%V1 == 1i * w * L1 * Ip1 + 1i * w * M * Ip2</span></span><br><span class="line"><span class="comment">%1i * w * C2 * V2 + V2 / R2 == -Ip2</span></span><br><span class="line"><span class="comment">%Ip1 + 1i * w * C1 * V1 + V1 / R1 == Iin</span></span><br><span class="line"></span><br><span class="line">syms A b x</span><br><span class="line"><span class="comment">% x = [V1; V2; Ip1; Ip2]</span></span><br><span class="line"><span class="comment">% Ax == b</span></span><br><span class="line"></span><br><span class="line">A = [<span class="number">0</span>, <span class="number">1</span>, -s * M, -s * L2;</span><br><span class="line">    <span class="number">1</span>, <span class="number">0</span>, -s * L1, -s * M;</span><br><span class="line">    <span class="number">0</span>, (s * C2 + <span class="number">1</span> / R2), <span class="number">0</span>, <span class="number">1</span>;</span><br><span class="line">    (s * C1 + <span class="number">1</span> / R1), <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>];</span><br><span class="line">b = [<span class="number">0</span>; <span class="number">0</span>; <span class="number">0</span>; Iin];</span><br><span class="line">x = A\b;</span><br><span class="line">x = x(<span class="number">2</span>) / Iin</span><br></pre></td></tr></table></figure><p>结果为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = </span><br><span class="line"></span><br><span class="line">(M*R1*R2*s)/(R1*R2 - M^2*s^2 + L1*R2*s + L2*R1*s + L1*L2*s^2 - C1*M^2*R1*s^3 - C2*M^2*R2*s^3 + C1*L1*L2*R1*s^3 + C2*L1*L2*R2*s^3 + C1*L1*R1*R2*s^2 + C2*L2*R1*R2*s^2 - C1*C2*M^2*R1*R2*s^4 + C1*C2*L1*L2*R1*R2*s^4)</span><br></pre></td></tr></table></figure><p>手动整理后可得</p><script type="math/tex; mode=display">Z_{21}=\frac{sR_1R_2M}{(L_1L_2-M^2)C_1C_2R_1R_2s^4+(C_1R_1-C_2R_2)(L_1L_2-M^2)s^3+\\ [(C_1L_1 + C_2L_2)R_1R_2+(L_1L_2- M^2)]s^2+(L_1R_2 + L_2R_1)s + \\ R_1R_2}</script><p>可以利用公式将$M, L, C, R$转换为$k, \omega, R, Q$，相应的公式为：</p><script type="math/tex; mode=display">L=\frac{R}{\omega Q}</script><script type="math/tex; mode=display">C=\frac{Q}{\omega R}</script><script type="math/tex; mode=display">M=k\sqrt{L_1L_2}</script><p>于是，在Matlab中输入命令</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">syms Q1 Q2 w1 w2 k</span><br><span class="line"><span class="comment">% convert RLC parameters to RQw parameters</span></span><br><span class="line">x = subs(x, M, <span class="built_in">sqrt</span>(L1 * L2) * k);</span><br><span class="line">x = subs(x, L1, R1 / w1 / Q1);</span><br><span class="line">x = subs(x, L2, R2 / w2 / Q2);</span><br><span class="line">x = subs(x, C1, Q1 / w1 / R1);</span><br><span class="line">x = subs(x, C2, Q2 / w2 / R2)</span><br></pre></td></tr></table></figure><p>可以得到推导结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = </span><br><span class="line"></span><br><span class="line">(R1*R2*k*s*((R1*R2)/(Q1*Q2*w1*w2))^(1/2))/(R1*R2 + (R1*R2*s^2)/w1^2 + (R1*R2*s^2)/w2^2 + (R1*R2*s^4)/(w1^2*w2^2) + (R1*R2*s)/(Q1*w1) + (R1*R2*s)/(Q2*w2) + (R1*R2*s^3)/(Q1*w1*w2^2) + (R1*R2*s^3)/(Q2*w1^2*w2) - (R1*R2*k^2*s^4)/(w1^2*w2^2) + (R1*R2*s^2)/(Q1*Q2*w1*w2) - (R1*R2*k^2*s^3)/(Q1*w1*w2^2) - (R1*R2*k^2*s^3)/(Q2*w1^2*w2) - (R1*R2*k^2*s^2)/(Q1*Q2*w1*w2))</span><br></pre></td></tr></table></figure><p>手动整理，将$R_1R_2$移到分母，将移到$\omega_1^2\omega_2^2$分子，可得</p><script type="math/tex; mode=display">Z_{21}=\frac{k\omega_1^2\omega_2^2\sqrt{\frac{R_1R_2}{Q_1Q_2\omega_1\omega_2}}s}{Q_1Q_2(1-k^2)s^4+(Q_1\omega_2+Q_2\omega_1)(1-k^2)s^3+\\ [\omega_1\omega_2(1-k^2)+Q_1Q_2(\omega_1^2+\omega_2^2)]s^2+\omega_1\omega_2(Q_1\omega_1+Q_2\omega_2)s+\\Q_1Q_2\omega_1^2\omega_2^2}</script><p>进一步假设高Q值，$Q_1Q_2(\omega_1^2+\omega_2^2)\gg(1-k^2)\omega_1\omega_2$，可解得极点为</p><script type="math/tex; mode=display">\omega_p^2=\frac{\omega_1^2+\omega_2^2\pm\sqrt{(\omega_1^2+\omega_2^2)^2-4(1-k^2)\omega_1^2\omega_2^2}}{2(1-k^2)}</script><p>得到了文章中的公式。此外，可以进一步简化，使初级、次级的$\omega, Q, R$对应相等，利用</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">syms Q w R</span><br><span class="line">x = subs(x, Q1, Q);</span><br><span class="line">x = subs(x, Q2, Q);</span><br><span class="line">x = subs(x, w1, w);</span><br><span class="line">x = subs(x, w2, w);</span><br><span class="line">x = subs(x, R1, R);</span><br><span class="line">x = subs(x, R2, R);</span><br><span class="line">x = simplify(x)</span><br></pre></td></tr></table></figure><p>得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x =</span><br><span class="line"> </span><br><span class="line">(Q^2*k*s*w^4*(R^2/(Q^2*w^2))^(1/2))/(- Q^2*k^2*s^4 + Q^2*s^4 + 2*Q^2*s^2*w^2 + Q^2*w^4 - 2*Q*k^2*s^3*w + 2*Q*s^3*w + 2*Q*s*w^3 - k^2*s^2*w^2 + s^2*w^2)</span><br></pre></td></tr></table></figure><p>即</p><script type="math/tex; mode=display">Z_{21}=\frac{\omega^3kQRs}{(1-k^2)Q^2s^4+2(1-k)Q\omega s^3+(1-k^2+2Q^2)\omega^2s^2+2Q\omega^3s+Q^2\omega^4}</script><p>极点频率可以由</p><script type="math/tex; mode=display">\mathrm{Re}[(1-k^2)Q^2s^4+2(1-k)Q\omega s^3+(1-k^2+2Q^2)\omega^2s^2+2Q\omega^3s+Q^2\omega^4]=0</script><p>得到，即</p><script type="math/tex; mode=display">(1-k^2)Q^2s^4+(1-k^2+2Q^2)\omega^2s^2+Q^2\omega^4=0</script><p>进一步假设高Q值，$2Q^2\gg1-k^2$，可解得</p><script type="math/tex; mode=display">\omega_p=\frac{\omega}{\sqrt{1\pm k}}</script><h2 id="Marco-Vigilante的推导"><a href="#Marco-Vigilante的推导" class="headerlink" title="Marco Vigilante的推导"></a>Marco Vigilante的推导</h2><p>Marco巧妙地利用了Y参数，避免了很多的复杂计算。变压器方程为</p><script type="math/tex; mode=display">\left\{\begin{aligned}U_1=j\omega L_1I_1+j\omega MI_2\\U_2=j\omega MI_1+j\omega L_2I_2\\\end{aligned}\right.</script><p>变换后为</p><script type="math/tex; mode=display">\left\{\begin{aligned}I_1=\frac{L_2}{j\omega(L_1L_2-M^2)}U_1+\frac{-M}{j\omega(L_1L_2-M^2)}U_2\\I_2=\frac{-M}{j\omega(L_1L_2-M^2)}U_1+\frac{L_1}{j\omega(L_1L_2-M^2)}U_2\\\end{aligned}\right.</script><p>因此得到了Y参数。取$s=j\omega, L=L_1=L_2, M=kL$，有</p><script type="math/tex; mode=display">\left\{\begin{aligned}I_1=\frac{1}{sL(1-k^2)}U_1+\frac{k}{sL(1-k^2)}U_2\\I_2=\frac{k}{sL(1-k^2)}U_1+\frac{1}{sL(1-k^2)}U_2\\\end{aligned}\right.</script><p>此时，加上两侧的电容，电阻，并令</p><script type="math/tex; mode=display">\omega=\frac{1}{\sqrt{LC(1-k^2)}}</script><script type="math/tex; mode=display">Q=\frac{R}{\omega L(1-k^2)}=\omega RC</script><p>可以得到整体Y参数为</p><script type="math/tex; mode=display">\left\{\begin{aligned}I_1&=\frac{1}{R}\left[1+Q\left(\frac{s}{\omega}+\frac{\omega}{s}\right)\right]U_1-\frac{\omega kQ}{sR}U_2\\I_2&=-\frac{\omega kQ}{sR}U_1+\frac{1}{R}\left[1+Q\left(\frac{s}{\omega}+\frac{\omega}{s}\right)\right]U_2\\\end{aligned}\right.</script><p>此时，对Y参数矩阵求逆</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br><span class="line">syms R Q w s k</span><br><span class="line">syms Y</span><br><span class="line">Y = [<span class="number">1</span> / R * (<span class="number">1</span> + Q * (s / w + w / s)), -k * w * Q / s / R;</span><br><span class="line">    -k * w * Q / s / R, <span class="number">1</span> / R * (<span class="number">1</span> + Q * (s / w + w / s))];</span><br><span class="line">x = <span class="built_in">eye</span>(<span class="number">2</span>)/Y;</span><br><span class="line">x(<span class="number">2</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ans =</span><br><span class="line"></span><br><span class="line">(Q*R*k*s*w^3)/(- Q^2*k^2*w^4 + Q^2*s^4 + 2*Q^2*s^2*w^2 + Q^2*w^4 + 2*Q*s^3*w + 2*Q*s*w^3 + s^2*w^2)</span><br></pre></td></tr></table></figure><p>手动整理可得</p><script type="math/tex; mode=display">Z_{21}=\frac{\omega^3kQRs}{(Qs^2+\omega s+Q(1+k)\omega^2)(Qs^2+\omega s+Q(1-k)\omega^2)}</script><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>使用两种方法都能够推导出变压器$Z_{21}$的表达式，仔细观察两者简化后的表达式分母虽然一致，分子却有所区别，这是因为两者定义$Q, \omega$的方式不尽相同。尽管如此，这两种方法都可以进一步推导出两个极点的位置，用于指导变压器的宽带设计。</p><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="针对Haikun-Jia的Mathematica推导"><a href="#针对Haikun-Jia的Mathematica推导" class="headerlink" title="针对Haikun Jia的Mathematica推导"></a>针对Haikun Jia的Mathematica推导</h3><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* Input 1 *)</span></span><br><span class="line">result = <span class="keyword">Solve</span>[s L1 Ip1 + s M Ip2 == U1 &amp;&amp;</span><br><span class="line">   s M Ip1 + s L2 Ip2 == U2 &amp;&amp;</span><br><span class="line">   I1 - s C1 U1 - U1/R1 == Ip1 &amp;&amp;</span><br><span class="line">   -s C2 U2 - U2/R2 == Ip2, &#123;U1, U2, Ip1, Ip2&#125;];</span><br><span class="line">Zt = U2/I1 /. result[[<span class="number">1</span>]]</span><br><span class="line"><span class="comment">(* Output 1 *)</span></span><br><span class="line">-((M R1 R2 s)/(-R1 R2 - L2 R1 s - L1 R2 s - L1 L2 s^<span class="number">2</span> + M^<span class="number">2</span> s^<span class="number">2</span> - </span><br><span class="line">     C1 L1 R1 R2 s^<span class="number">2</span> - C2 L2 R1 R2 s^<span class="number">2</span> - C1 L1 L2 R1 s^<span class="number">3</span> + </span><br><span class="line">     C1 M^<span class="number">2</span> R1 s^<span class="number">3</span> - C2 L1 L2 R2 s^<span class="number">3</span> + C2 M^<span class="number">2</span> R2 s^<span class="number">3</span> - </span><br><span class="line">     C1 C2 L1 L2 R1 R2 s^<span class="number">4</span> + C1 C2 M^<span class="number">2</span> R1 R2 s^<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">(* Input 2 *)</span></span><br><span class="line">Zt2 = <span class="keyword">Simplify</span>[Zt /. M -&gt; k <span class="keyword">Sqrt</span>[L1 L2] /. &#123;L1 -&gt; R1/w1/Q1, L2 -&gt; R2/w2/Q2, </span><br><span class="line">   C1 -&gt; Q1/w1/R1, C2 -&gt; Q2/w2/R2&#125;]</span><br><span class="line"><span class="comment">(* Output 2 *)</span></span><br><span class="line">(k R1 R2 s w1 w2)/(<span class="keyword">Sqrt</span>[(R1 R2)/(</span><br><span class="line">   Q1 Q2 w1 w2)] (s w1 (-(<span class="number">-1</span> + k^<span class="number">2</span>) s w2 + </span><br><span class="line">        Q2 (s^<span class="number">2</span> - k^<span class="number">2</span> s^<span class="number">2</span> + w2^<span class="number">2</span>)) + </span><br><span class="line">     Q1 (s (-(<span class="number">-1</span> + k^<span class="number">2</span>) s^<span class="number">2</span> + w1^<span class="number">2</span>) w2 + </span><br><span class="line">        Q2 (-(<span class="number">-1</span> + k^<span class="number">2</span>) s^<span class="number">4</span> + w1^<span class="number">2</span> w2^<span class="number">2</span> + s^<span class="number">2</span> (w1^<span class="number">2</span> + w2^<span class="number">2</span>)))))</span><br><span class="line"></span><br><span class="line"><span class="comment">(* Input 3 *)</span></span><br><span class="line">Zt3 = <span class="keyword">Simplify</span>[Zt2 /. &#123;L1-&gt;L, L2-&gt;L, w1-&gt;w, w2-&gt;w, Q1-&gt;Q, Q2-&gt;Q, R1-&gt;R, R2-&gt;R&#125;,&#123;R&gt;<span class="number">0</span>,Q&gt;<span class="number">0</span>,w&gt;<span class="number">0</span>&#125;]</span><br><span class="line"><span class="comment">(* Output 3 *)</span></span><br><span class="line">(k R s w^<span class="number">2</span>)/(<span class="number">-2</span> (<span class="number">-1</span> + k^<span class="number">2</span>) s^<span class="number">3</span> - ((<span class="number">-1</span> + k^<span class="number">2</span>) Q s^<span class="number">4</span>)/w + ((<span class="number">1</span> - k^<span class="number">2</span> + </span><br><span class="line">    <span class="number">2</span> Q^<span class="number">2</span>) s^<span class="number">2</span> w)/Q + <span class="number">2</span> s w^<span class="number">2</span> + Q w^<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">(* Solution of poles *)</span></span><br><span class="line"><span class="keyword">Collect</span>[<span class="keyword">Denominator</span>[Zt2]/<span class="keyword">Sqrt</span>[((R1 R2)/(Q1 Q2 w1 w2))], s]</span><br><span class="line"><span class="keyword">Solve</span>[(<span class="number">1</span> - k^<span class="number">2</span>) Q1 Q2 s^<span class="number">4</span> + s^<span class="number">2</span> (Q1 Q2 (w1^<span class="number">2</span> + w2^<span class="number">2</span>)) + Q1 Q2 w1^<span class="number">2</span> w2^<span class="number">2</span> == <span class="number">0</span>, s]</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>H. Jia, C. C. Prawoto, B. Chi, Z. Wang and C. P. Yue, &quot;A Full Ka-Band Power Amplifier With 32.9% PAE and 15.3-dBm Power in 65-nm CMOS,&quot; in <em>IEEE Transactions on Circuits and Systems I: Regular Papers</em>, vol. 65, no. 9, pp. 2657-2668, Sept. 2018. DOI: <a href="https://doi.org/10.1109/TCSI.2018.2799983" target="_blank" rel="noopener">10.1109/TCSI.2018.2799983</a></li><li>M. Vigilante, P. Reynaert, 5G and E-Band Communication Circuits in Deep-Scaled CMOS. Switzerland: Springer, 2018. DOI: <a href="https://doi.org/10.1007/978-3-319-72646-5" target="_blank" rel="noopener">10.1007/978-3-319-72646-5</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电容的电磁场仿真设置</title>
      <link href="/archives/10ba08e5/mom-simulation.html"/>
      <url>/archives/10ba08e5/mom-simulation.html</url>
      
        <content type="html"><![CDATA[<p>电容是射频集成电路中的常用器件，其结构固定，设计较为简单。但由于精细结构较多，往往占用极大的仿真资源和时间。在隔直或者交流去耦应用中，电容的精确值并不是那么重要，只要足够大即可。即使在匹配电路中，些许偏差也不会对中心频率产生明显影响。因此，电容仿真不应无止尽追求精度，而是要在尽可能短的时间内获得误差不大的仿真结果。本文对比了电容仿真中不同的仿真引擎和通孔合并方法的优劣，并给出了推荐设置。<br><a id="more"></a></p><h2 id="仿真引擎的选择"><a href="#仿真引擎的选择" class="headerlink" title="仿真引擎的选择"></a>仿真引擎的选择</h2><p>常用的ADS Momentum引擎有两种模式：RF和Microwave。RF模式在射频频段内提供了精确的电磁场仿真结果，且仿真速度较快。在更高频段内，由于辐射效应，只用Microwave才能提供准角结果。ADS文档中推荐在以下电路中使用RF模式：</p><ul><li>电小的</li><li>图形复杂的</li><li>不辐射的</li></ul><p>在射频频段的电容应用应当符合RF的描述，之后通过仿真对比予以验证。另一个值得注意的的Edge Mesh的设置。Edge mesh将自动的在图形边缘添加密布的mesh，用于仿真趋肤效应，常用于高层金属的仿真。之后也通过仿真比较了Edge Mesh在电容仿真中的影响。</p><p>对比实验选则了MOM电容，由5层金属，36根19.74 um长插指构成，两侧通孔采用减少面积合并。仿真在32核服务器上顺序进行，无其他负载。结果如下：</p><p><img src="./mom-simulation/simulation-engine.png" alt="simulation-engine"></p><p>在14 GHz计算得到的仿真误差如下表：</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">电容误差</th><th style="text-align:center">Q值误差</th><th style="text-align:center">仿真时间</th></tr></thead><tbody><tr><td style="text-align:center">Microwave，Edge Mesh（基准）</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">90 min</td></tr><tr><td style="text-align:center">RF</td><td style="text-align:center">1.66 %</td><td style="text-align:center">104.43 %</td><td style="text-align:center">1.5 min</td></tr><tr><td style="text-align:center">Microwave</td><td style="text-align:center">1.70 %</td><td style="text-align:center">105.72 %</td><td style="text-align:center">7.5 min</td></tr><tr><td style="text-align:center"><strong>RF，Edge Mesh</strong></td><td style="text-align:center"><strong>0.04 %</strong></td><td style="text-align:center"><strong>0.56 %</strong></td><td style="text-align:center"><strong>12 min</strong></td></tr></tbody></table></div><p>由此可见，Microwave和RF方法在14 GHz处的仿真结果相差不大，但Edge Mesh对Q值影响较大。由于趋肤效应，电流倾向于在导体边缘流动，减小了有效横截面积，因而损耗变大。当不添加Edge Mesh则无法仿真趋肤效应，直接导致偏高的Q值。因此，采用RF模式并选择Edge Mesh是平衡精度和仿真时间的最优结果。</p><h2 id="通孔的合并和模型选择"><a href="#通孔的合并和模型选择" class="headerlink" title="通孔的合并和模型选择"></a>通孔的合并和模型选择</h2><p>仿真电容时通孔阵列如果不加处理将会产生大量的网格，从而占用仿真资源并拖慢仿真速度。通常，需要将这些通孔进行合并，形成一个大的通孔。合并的方法通常有：</p><ul><li>画一个大的通孔覆盖原来所有的通孔</li><li>画一个有效面积相同的通孔</li><li>画一个大的通孔覆盖原来所有的通孔，并减小通孔导电率</li></ul><p>其中第一种方法最为简单，但不可避免增大通孔面积，低估通孔损耗。第二种方法使得通孔面积不变，但使得通孔更加集中，改变了场的分布。第三种方法需要修改衬底文件，较为麻烦，但精度较好。</p><p>另一个值得注意的时通孔模型的选择，默认选择时3D模型。此时，所有的表面电流流向都被考虑。而2D模型只考虑垂直方向的表面电流。在通孔阵列中，由于水平方向各个通孔互相独立，因此不应该有水平方向电流。而通孔合并后，物理隔离消失，因此应当选择2D模型抑制水平方向的电流，提高仿真精度。</p><p>关于修改通孔电导率，通孔电导率的计算公式为：</p><script type="math/tex; mode=display">\rho=\frac{h}{Rw^2}</script><p>其中$h$是通孔高度，$w$是通孔边长，$R$是单个通孔的电阻，这些参数都可以从代工厂提供的连线模型中找到。考虑到通孔合并，其等效电导率为：</p><script type="math/tex; mode=display">\rho_{eff}=\rho\frac{w^2}{(w+s_r)(w+s_c)}</script><p>其中是$s_r$通孔阵列的行间隔，$s_c$是列间隔。考虑$w=0.1, s_r=0.1, s_c=0.14$和$w=0.1, s_r=0.13, s_c=0.13$两种情况，其$\rho_{eff}$分别为$0.208\rho$和$0.189\rho$，因此合并时可取$\rho_{eff}=0.2\rho$。</p><p>对比实验选则了fringe电容，由5层金属，20根5 um长插指构成，采用带有Edge Mesh的RF模式仿真。仿真在32核服务器上顺序进行，无其他负载。结果如下：</p><p><img src="./mom-simulation/mom-simulation-comparison.png" alt="mom-simulation-comparison"></p><p>在14 GHz计算得到的仿真误差如下表：</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">电容误差</th><th style="text-align:center">Q值误差</th><th style="text-align:center">仿真时间</th></tr></thead><tbody><tr><td style="text-align:center">原始版图，3D（基准）</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">3 hr 5 min</td></tr><tr><td style="text-align:center"><strong>覆盖合并，2D，降低电导率</strong></td><td style="text-align:center"><strong>0.13 %</strong></td><td style="text-align:center"><strong>3.57 %</strong></td><td style="text-align:center"><strong>17 min</strong></td></tr><tr><td style="text-align:center">覆盖合并，2D</td><td style="text-align:center">0.13 %</td><td style="text-align:center">9.31 %</td><td style="text-align:center">14 min</td></tr><tr><td style="text-align:center">同面积合并，2D</td><td style="text-align:center">5.27 %</td><td style="text-align:center">53.44 %</td><td style="text-align:center">7 min</td></tr><tr><td style="text-align:center">覆盖合并，3D</td><td style="text-align:center">0.15 %</td><td style="text-align:center">10.05 %</td><td style="text-align:center">19 min</td></tr></tbody></table></div><p>仿真结果表明，同面积合并仿真速度最快，其他方法仿真速度相差无几。在合并之后，2D模型确实比3D模型更准确展现了Q值，但差距不大。前述的三种方法中， 出乎意料的是同面积合并无论是电容误差还是Q值误差都明显较大，可能是由于将通孔集中到中间与电流的趋肤效应背道而驰，人为加大了损耗。而覆盖合并方法简单有效，仅在Q值上产生一些明显误差。降低电导率后，Q值误差可以忽略不计，因此，采用2D通孔模型的覆盖合并方法最为有效。当对Q值精度要求高时，可将通孔电导率将为约1/5。</p><h2 id="通孔合并的细节"><a href="#通孔合并的细节" class="headerlink" title="通孔合并的细节"></a>通孔合并的细节</h2><p>上一部分的仿真对比结果表明了覆盖合并精度较好，但是覆盖合并的细节仍然值得注意。这里比较了两种常见覆盖合并的方法：</p><ul><li>通孔覆盖合并：画一个大的via正好覆盖原来所有的通孔</li><li>全金属填充：画一个大的via覆盖整个金属区域</li></ul><p>由于金属包围通孔的距离通常不大，两种方法的区别看似不明显。但仿真结果表现出明显的差距，三种合并方式的仿真结果如下：</p><p><img src="mom-simulation/fill-style-comparison.png" alt="fill-style-comparison"></p><p>在14 GHz计算得到的仿真误差如下表：</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">电容误差</th><th style="text-align:center">Q值误差</th></tr></thead><tbody><tr><td style="text-align:center">原始版图，3D（基准）</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center"><strong>通孔覆盖合并，3D</strong></td><td style="text-align:center"><strong>0.19 %</strong></td><td style="text-align:center"><strong>17.8 %</strong></td></tr><tr><td style="text-align:center">全金属填充，3D</td><td style="text-align:center">0.59 %</td><td style="text-align:center">144.21 %</td></tr></tbody></table></div><p>可以看出，通孔覆盖合并的电容、Q值精度都还可以接受，但全金属填空明显低估了损耗，导致较大的Q值误差。为了进一步展示三种合并方式的区别，其版图、电流密度、电流方向绘制如下：</p><div class="table-container"><table><thead><tr><th style="text-align:center">原始版图</th><th style="text-align:center">通孔覆盖合并</th><th style="text-align:center">全金属填充</th></tr></thead><tbody><tr><td style="text-align:center"><img src="mom-simulation/original-layout.png" alt="original-layout"></td><td style="text-align:center"><img src="mom-simulation/via-fill-layout.png" alt="via-fill-layout" style="zoom:80%;"></td><td style="text-align:center"><img src="mom-simulation/all-fill-layout.png" alt="all-fill-layout"></td></tr><tr><td style="text-align:center"><img src="mom-simulation/original.png" alt="original-id"></td><td style="text-align:center"><img src="mom-simulation/via-fill.png" alt="via-fill-id"></td><td style="text-align:center"><img src="mom-simulation/all-fill.png" alt="all-fill-id"></td></tr><tr><td style="text-align:center"><img src="mom-simulation/original-fill-i.png" alt="original-fill-i"></td><td style="text-align:center"><img src="mom-simulation/via-fill-i.png" alt="via-fill-i"></td><td style="text-align:center"><img src="mom-simulation/all-fill-i.png" alt="all-fill-i"></td></tr></tbody></table></div><p>可以看出，全金属填充方法会导致下层金属电流密度提升，从而提高了有效电容值。同时，其边缘产生了明显的横向电流和纵向电流，等效Q值也明显提高。因此，为了得到比较精准地结果，不建议将通孔填充到金属边缘，而应采用刚好覆盖原通孔的填充方式。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文比较了几种电容的仿真方法。为了快速、准确地仿真电容，最好采用带有Edge Mesh的RF模式，通过通孔覆盖的方法合并通孔，同时降低通孔电导率至约1/5，并选择2D模型抑制水平电流。</p>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ADS创建MOM电容Pcell</title>
      <link href="/archives/97db45b0/ads-mom-pcell.html"/>
      <url>/archives/97db45b0/ads-mom-pcell.html</url>
      
        <content type="html"><![CDATA[<p>在集成电路设计中，Pcell (Parameterized Cell)指只需要输入参数就可以通过程序代码自动创建的版图。例如，代工厂提供的工艺库中就含有常用的晶体管、电容以至电感的Pcell文件，在版图设计时只需要指定一些参数（在晶体管设计中例如栅长、栅宽、栅指数等）即可自动生成对应的版图。这极大简化了设计流程，缩短了设计周期。</p><p>然而，代工厂提供的预设工艺库有时可能不能满足设计要求。比如说，用户可能想设计一系列更高Q值，但精度较低的fringe电容，而工艺库却没有提供。此时，自定义Pcell可以省去重复设计的麻烦。常用的设计软件如Cadence、ADS都支持通过相应的编程语言（SKILL和AEL）自定义创建Pcell。</p><p>此外，也可以自行撰写脚本文件（例如Python），生成EGS格式的版图并导入ADS。使用这种方法时，也可以通过ADS的命令行工具进行批量仿真，十分方便。自行撰写脚本文件比较通用，可操控性强，但需要大量的编程工作（编写基础的图形类库）。</p><p>由于ADS集成了Momentum电磁场仿真软件，并支持通过自带的AMC (Advanced Model Composer)对Pcell进行自动仿真和建模，在设计中应用较为广泛。本文以电容设计为例，介绍了基于ADS的AEL语言的Pcell设计和批量仿真建模。<br><a id="more"></a></p><h2 id="预备"><a href="#预备" class="headerlink" title="预备"></a>预备</h2><p>这一部分介绍了一些预备知识。</p><h3 id="电容"><a href="#电容" class="headerlink" title="电容"></a>电容</h3><p>电容是射频集成电路设计必不可少的组件。它可以构成LC谐振网络，提供交流耦合、直流阻断。常见的电容类型有晶体管电容、二极管电容、MIM（Metal-Insulator-Metal）电容以及MOM（Metal-Oxide-Metal）电容。由于栅氧较薄，晶体管电容面积紧凑，但存在电压调制效应。就MIM和MOM而言，虽然Oxide也是一种Insulator，但MOM电容通常指代同层两个金属插指之间和其间氧化物形成的电容，而MIM以平板电容为主，有时特指模拟/射频工艺中提供的额外提供两层金属间的电容。</p><p>电容的一个简单模型是RC并联网络，其等效R为：</p><script type="math/tex; mode=display">C=\frac{\mathrm{imag}(Y_{11})}{2\pi f}</script><p>其等效C为：</p><script type="math/tex; mode=display">R=\frac{1}{\mathrm{real}(Y_{11})}</script><p>品质因数定义为：</p><script type="math/tex; mode=display">Q=2\pi fRC=\frac{\mathrm{imag}(Y_{11})}{\mathrm{real}(Y_{11})}=-\frac{\mathrm{imag}(Z_{11})}{\mathrm{real}(Z_{11})}</script><p>但这个简单模型只能在工作频率附近的窄带使用，针对电容更宽带的建模则需要将电感考虑进去。此时，模型为：</p><p><img src=".\ads-mom-pcell\capacitor-model-rlc.gif" alt="real world capacitor model"></p><p>此时，直流电阻为：</p><script type="math/tex; mode=display">R_{DC}=R_{ESR}+R_{Leakage}</script><p>高频电阻为：</p><script type="math/tex; mode=display">R_{RF}=R_{ESR}</script><p>低频电抗为</p><script type="math/tex; mode=display">\mathrm{imag}(Z_{IN})=\omega L-\frac{\omega CR^2}{1+\omega^2C^2R^2}\approx\omega L</script><p>谐振频率（虚部为0）为：</p><script type="math/tex; mode=display">f_{resonate}=\frac{1}{2\pi}\sqrt{\frac{CR^2-L}{LC^2R^2}}</script><p>因此，可以将这些参数从仿真中提取出来。</p><p>关于MOM电容的版图，其既可以是简单的同层结构</p><p><img src=".\ads-mom-pcell\mom.png" alt="mom capacitor"></p><p>也可以是交错的立体结构。此时，其电容密度较大：</p><p><img src=".\ads-mom-pcell\fringe-cap.png" alt="fringe capacitor"></p><p>3D透视图如下：</p><p><img src="ads-mom-pcell/mom_cap.png" alt="3D mom capacitor"></p><h3 id="AEL语言"><a href="#AEL语言" class="headerlink" title="AEL语言"></a>AEL语言</h3><p>AEL（Application Extension Language）是Keysight公司开发的基于C语言的通用编程语言，可用于配置、扩展ADS设计环境。其与C语言的区别主要有：</p><ul><li>没有预处理，不支持#if, #ifdef, #ifndef, #endif, #define, #undef以及#include，但增加了load()函数用于代替#include</li><li>没有类型，变量声明使用decl，函数声明使用defun，函数可以在函数内定义</li><li>支持复数和列表，但没有结构</li><li>拥有变量回收机制</li></ul><p>其列表的语法为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decl a = <span class="built_in">list</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">decl b = <span class="built_in">list</span>(<span class="string">"hello"</span>, a[<span class="number">0</span>]);<span class="comment">//可以混合类型</span></span><br></pre></td></tr></table></figure><p>其数组语法为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">decl x = &#123;<span class="number">1</span>+<span class="number">2</span>i, <span class="number">3</span>+<span class="number">4</span>i, <span class="number">5</span>+<span class="number">6</span>i&#125;;</span><br><span class="line">decl y = [<span class="number">1</span>+<span class="number">2</span>i, <span class="number">3</span>+<span class="number">4</span>i, <span class="number">5</span>+<span class="number">6</span>i];<span class="comment">//&#123;&#125;和[]可以互换</span></span><br><span class="line">decl z = &#123;<span class="number">1</span>::<span class="number">10</span>);<span class="comment">//生成1-10的数组</span></span><br><span class="line">decl u = &#123;<span class="number">1</span>::<span class="number">0.5</span>::<span class="number">10</span>);<span class="comment">//生成1-10的数组，间隔0.5</span></span><br></pre></td></tr></table></figure><p>对于矩阵：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">decl m = &#123;&#123;<span class="number">1</span>&#125;,&#123;<span class="number">2</span>&#125;,&#123;<span class="number">3</span>&#125;&#125;;</span><br><span class="line">decl n = [<span class="number">1</span>; <span class="number">2</span>; <span class="number">3</span>];<span class="comment">//两者相同，生成二维数组</span></span><br><span class="line">decl o = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, &#123;<span class="number">3</span>,<span class="number">4</span>&#125;&#125;;</span><br><span class="line">decl p = [<span class="number">1</span>, <span class="number">2</span>; <span class="number">3</span>, <span class="number">4</span>];<span class="comment">//两者相同，生成二维数组(矩阵)</span></span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"%s\n"</span>, identify_value(m));<span class="comment">//打印矩阵</span></span><br></pre></td></tr></table></figure><h3 id="AMC"><a href="#AMC" class="headerlink" title="AMC"></a>AMC</h3><p>AMC (Advanced Model Composer)可以用于无源器件的模型生成，它可以根据预设参数和频率范围对Pcell进行自适应EM仿真，并根据结果建立模型。对于没有仿到的点，也可以根据其算法进行插值，得到较为精确的结果。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>实现绘制电容的Pcell代码主要为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">"vias.ael"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a parallel lines</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// context: the design context</span></span><br><span class="line"><span class="comment">// layer: the layer number</span></span><br><span class="line"><span class="comment">// fingers: number of the lines</span></span><br><span class="line"><span class="comment">// length: length of the lines</span></span><br><span class="line"><span class="comment">// width: width of the lines</span></span><br><span class="line"><span class="comment">// space: space of the lines</span></span><br><span class="line"><span class="comment">// x: lower-left x coordinate of the shape</span></span><br><span class="line"><span class="comment">// y: lower-left y coordinate of the shape</span></span><br><span class="line"><span class="comment">// extension: extension of lines on vertical direction</span></span><br><span class="line"><span class="comment">// dummy_finger: number of unconnected lines at each side</span></span><br><span class="line"><span class="comment">// polar: direction of the extension (0 at bottom, 1 at top)</span></span><br><span class="line"></span><br><span class="line"><span class="function">defun <span class="title">create_plines</span><span class="params">(context, layer, fingers, length, width, space, extension, x, y, dummy_finger, polar)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">x = <span class="keyword">float</span>(x);</span><br><span class="line">y = <span class="keyword">float</span>(y);</span><br><span class="line">decl i;</span><br><span class="line">decl xpos = <span class="number">0</span>;</span><br><span class="line">polar = <span class="keyword">int</span>(polar);</span><br><span class="line">fingers = <span class="keyword">int</span>(fingers);</span><br><span class="line">dummy_finger = <span class="keyword">int</span>(dummy_finger);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;dummy_finger; i++)</span><br><span class="line">&#123;</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+extension, x+xpos+width, y+extension+length);</span><br><span class="line">xpos += (width + space);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;fingers; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(polar == <span class="number">0</span>)</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+<span class="number">0</span>, x+xpos+width, y+extension+length);</span><br><span class="line"><span class="keyword">if</span>(polar == <span class="number">1</span>)</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+extension, x+xpos+width, y+<span class="number">2</span>*extension+length);</span><br><span class="line">xpos += (width + space);</span><br><span class="line">polar = <span class="number">1</span> - polar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;dummy_finger; i++)</span><br><span class="line">&#123;</span><br><span class="line">db_add_rectangle(context, layer, x+xpos, y+extension, x+xpos+width, y+extension+length);</span><br><span class="line">xpos += (width + space);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a mom capacitor</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// start_layer: the lowest layer number</span></span><br><span class="line"><span class="comment">// end_layer: the highest layer number</span></span><br><span class="line"><span class="comment">// fingers: number of the fingers</span></span><br><span class="line"><span class="comment">// length: length of the fingers</span></span><br><span class="line"><span class="comment">// width: width of the fingers</span></span><br><span class="line"><span class="comment">// space: space of the fingers</span></span><br><span class="line"><span class="comment">// x_extension: extension of via array</span></span><br><span class="line"><span class="comment">// y_extension: space of figner to via array</span></span><br><span class="line"><span class="comment">// via_height: height of the via, width is calculated</span></span><br><span class="line"><span class="comment">// dummy_finger: number of unconnected fingers at each side</span></span><br><span class="line"><span class="comment">// fringe: whether to create a fringe capacitor</span></span><br><span class="line"><span class="comment">// combine: whether to combine vias for simulation simplification</span></span><br><span class="line"></span><br><span class="line"><span class="function">defun <span class="title">mom_cap</span><span class="params">(start_layer, end_layer, fingers, length, width, space, x_extension, y_extension, via_height, dummy_finger, fringe, combine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">decl designContext = de_get_current_design_context();</span><br><span class="line">decl polar = <span class="number">0</span>;</span><br><span class="line">decl i = <span class="number">0</span>;</span><br><span class="line">fringe = <span class="keyword">int</span>(fringe);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get layer IDs</span></span><br><span class="line">decl M7 = db_get_layerid(designContext, <span class="string">"M7"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M6 = db_get_layerid(designContext, <span class="string">"M6"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M5 = db_get_layerid(designContext, <span class="string">"M5"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M4 = db_get_layerid(designContext, <span class="string">"M4"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M3 = db_get_layerid(designContext, <span class="string">"M3"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M2 = db_get_layerid(designContext, <span class="string">"M2"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl M1 = db_get_layerid(designContext, <span class="string">"M1"</span>, <span class="string">"drawing"</span>);</span><br><span class="line">decl Metals = <span class="built_in">list</span>(M1, M1, M2, M3, M4, M5, M6, M7);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// calculate the width of the via array</span></span><br><span class="line">decl t_width = <span class="number">2</span> * x_extension + space * (<span class="number">2</span>*dummy_finger + fingers - <span class="number">1</span>) + width * (<span class="number">2</span>*dummy_finger + fingers);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create pins</span></span><br><span class="line">db_create_pin(designContext, t_width/<span class="number">2</span>, <span class="number">0</span>, <span class="number">-90</span>, Metals[end_layer], <span class="number">1</span>);</span><br><span class="line">db_create_pin(designContext, t_width/<span class="number">2</span>, <span class="number">2</span>*via_height+<span class="number">2</span>*y_extension+length, <span class="number">90</span>, Metals[end_layer], <span class="number">2</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// create vias at two terminals</span></span><br><span class="line">via_fillto7(start_layer, end_layer, t_width, via_height, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0</span>, <span class="number">0</span>, combine);</span><br><span class="line">via_fillto7(start_layer, end_layer, t_width, via_height, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0.04</span>, <span class="number">0</span>, via_height+<span class="number">2</span>*y_extension+length, combine);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// create lines for M1 to M7</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;<span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span>(start_layer &lt;= i &amp;&amp; end_layer &gt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                create_plines(designContext, Metals[i], fingers, length, width, space, y_extension, x_extension, via_height, dummy_finger, polar);</span><br><span class="line">                polar = fringe - polar;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A function wrapper</span></span><br><span class="line"><span class="function">defun <span class="title">mom_cap_wrapper</span><span class="params">(start_layer, end_layer, fingers, length, width, space, x_extension, y_extension, via_height, dummy_finger, fringe, combine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">decl designContext = de_get_current_design_context();</span><br><span class="line"></span><br><span class="line">decl mks2uu = db_get_mks_to_uu_factor(designContext);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// convert the units</span></span><br><span class="line">length = length * mks2uu;</span><br><span class="line">width = width * mks2uu;</span><br><span class="line">space = space * mks2uu;</span><br><span class="line">x_extension = x_extension * mks2uu;</span><br><span class="line">y_extension = y_extension * mks2uu;</span><br><span class="line">via_height = via_height * mks2uu;</span><br><span class="line"></span><br><span class="line">mom_cap(start_layer, end_layer, fingers, length, width, space, x_extension, y_extension, via_height, dummy_finger, fringe, combine);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="测试流程"><a href="#测试流程" class="headerlink" title="测试流程"></a>测试流程</h3><p>为了运行代码，需要在ADS中进行一系列设置：</p><ol><li><p>在ADS库目录下新建mom.ael文件，加入上述代码；</p></li><li><p>在ADS库目录下新建eesof_lib.cfg文件，加入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BOOT_AEL=./mom.ael</span><br></pre></td></tr></table></figure><p>此时，当ADS载入库时，代码会自动加载。为了强制重载，可以点击 File &gt; Recent Workspaces中这个库的名字；</p></li><li><p>新建一个空白layout，命名为momcap，点击File &gt; Design parameters，在其中设置各个参数的名称、类型、默认值、单位和描述。设置完成后点击确认。</p><p><img src="ads-mom-pcell/design-parameters.png" alt="set design parameters"></p><p>点击File &gt; Customize PCell，选择artwork类型为”AEL Macro“，将函数名写为主函数名。设置完成后点击确认。</p><p><img src="ads-mom-pcell/customize-pcell.png" alt="customize pcell"></p><p>保存layout；</p></li><li><p>另建一个名为momcap_sweep的layout，拖入刚才创建的momcap。此时应该出现默认值下的电容图形。在两端加上pin并设置好EM仿真。在EM &gt; Component &gt; Parameters中设置要扫描的变量名和范围（只能设置两个连续型变量），并将变量名填入Pcell的参数中。在EM &gt; Component &gt; Advanced Model Composer &gt; Create Model中开始仿真；</p></li><li><p>仿真结束后，点击EM &gt; Component &gt; Create EM Model and Symbol，在新建的原理图中加入symbol，设置好参数即可进行电路仿真。</p></li></ol><h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><p>首先对插指长度进行扫描，绘制了等效电容和等效Q值的曲线：</p><p><img src="ads-mom-pcell/sweep_length_Q.png" alt="sweep_length_Q"></p><p>事实上，AMC并没有对8-25 um区间范围内的每个点进行仿真，而是在之前仿真结果的基础上进行插值，因为仿真速度非常快，适用于快速迭代和自动优化。仿真结果较为精确。</p><p>当观察28 GHz处的等效电容时随插指长变化时，有：</p><p><img src="ads-mom-pcell/sweep_length.png" alt="sweep_length"></p><p>当观察28 GHz处的等效电容时随插指数变化时，有：</p><p><img src="ads-mom-pcell/sweep_fingers.png" alt="sweep_fingers"></p><p>可以发现，在28 GHz处电容值基本随插指长、插指数而线性变化，因而实际设计时可以通过长度、插指数进行估算，进一步节省时间。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li>Keysight, <em>Advanced Design System Documentation</em></li><li>Behzard Razavi, <em>RF Microelectronics</em></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Scripts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Difficult Sentences in GRE Preparation</title>
      <link href="/archives/97db45b9/difficult-sentences.html"/>
      <url>/archives/97db45b9/difficult-sentences.html</url>
      
        <content type="html"><![CDATA[<p>All these sentences are picked from relevant GRE preparation books.</p><p>Excessive secrecy tends to <strong>invite</strong> excessive curiosity and thus serves to <strong>provoke</strong> the very impulses against which it guards.</p><p>Prudery actually draws attention to the vice that it is supposed to <strong>suppress</strong>; the very act that forbids the speech or prohibits sight <strong>dramatizes</strong> what is hidden.</p><p>Although Caroline Gordon was rigorously objective in her journalistic writing, her lively and <strong>exuberant</strong> private correspondence <strong>exhibited</strong> a delightful capacity for biting commentary on the social scene.<br><a id="more"></a></p><p>It would be a waste of time for any reviewer to bother <strong>condemning</strong> a book whose utter worthlessness is <strong>obvious</strong> to even the least discerning reader.</p><p>It would be misleading to use a published play to generalize about fifteenth-century drama; the very fact of publication should serve as a <strong>warning</strong> of the play&#39;s <strong>unrepresentative</strong> character.</p><p>It is his dubious distinction to have proved what nobody would think of denying, that Romeo at the age of sixty-four writes with all the characteristic of <strong>maturity</strong>.</p><p>It is strange how words shape our thoughts and trap us at the bottom of deeply <strong>incised</strong> canyon of thinking, their imprisoning sides carved out by the <strong>river</strong> of past usage.</p><p>It is ironic that a critic of such overwhelming vanity now suffers from a measure of oblivion to which he was forever <strong>consigning</strong> others, in the end, all his <strong>self-adulation</strong> has only worked against him.</p><p>People should not be praised for their virtue if they lacked the energy to be <strong>wicked</strong>; in such cases, goodness is merely the effect of <strong>indolence</strong>.</p><p>Observable as a tendency of our culture is a <strong>withdrawal</strong> of <strong>belief</strong> in psychoanalysis: we no longer feel that it can solve our emotional problems.</p><p>Broadway audiences have been inured to <strong>mediocrity</strong> and so <strong>desperate</strong> to be pleased as to make their ready ovations meaningless as an indicator of the quality of the production before them.</p><p>Without seeming unworldly, William James appeared wholly removed from the <strong>commonplace</strong> of the society, the conventionality of academe.</p><p>Any language is a conspiracy against experience in the sense that it is a collective attempt to <strong>manage</strong> experience by reducing it into discrete parcels.</p><p>There is perhaps some truth in that waggish old definition of scholar - a siren that calls attention to a fog without doing anything to <strong>dispel</strong> it.</p><p>We realized that John was still young and impressionable, but were nevertheless surprised at his <strong>naivete</strong>. </p><p>The First World War began in a context of jargon and verbal delicacy and continued in a cloud of <strong>euphemism</strong> as <strong>impenetrable</strong> as language and literature, skillfully used, could make it.</p><p>Noting the murder victim&#39;s flaccid musculature and pear-like figure, she deduced that the unfortunate fellow had earned his living in some <strong>sedentary</strong> occupation.</p><p>Politeness is not a <strong>superficial</strong> attribute of human behavior, but a rather a central virtue, one whose very existence is increasingly being <strong>threatened</strong> by the faddish requirement to &quot;speak one&#39;s mind&quot;.</p><p>Ever prey to vagrant impulses that impelled him to <strong>squander</strong> his talents on a host of unworthy projects, his very <strong>dissipation</strong> nonetheless enhanced his reputation, for the sheer energy of his extravagance dazzled observers.</p><p>While some see in practical jokes a wish for mastery in miniature over a world that seems very <strong>unruly</strong>, others believe that the joke&#39;s purpose is to disrupt, by reducing all transactions to <strong>chaos</strong>.</p><p>For all his <strong>boorishness</strong>, Honore de Balzac betrayed a remarkable <strong>sensitivity</strong> to the plight of 19th century women, populating his novel with characters sympathetic to women&#39;s right.</p><p>Inspired interim responses to hitherto unknown problems, New Deal economic stratagems became <strong>ossified</strong> as a result of bureaucratization, their flexibility and adaptability destroyed by their transformation into rigid policies.</p><p>The architects of New York&#39;s early skyscrapers, hinting here at a twelfth-century cathedral, there at a fifteenth-century palace, sought to legitimize the city&#39;s social striving by <strong>evoke</strong> a history the city did not truly <strong>possess</strong>.</p><p>Ethologists are convinced that many animals survive through learning - but learning that is <strong>dictated by</strong> their generic programming, learning as throughly <strong>stereotyped</strong> as the most instinctive of behavioral responses.</p><p>The senator&#39;s reputation, though <strong>shaken</strong> by false allegations of misconduct, emerged from the ordeal <strong>unscathed</strong>.</p><p>A human being is quite <strong>frail</strong> creature, for the gloss of rationality that covers his or her fears and <strong>insecurity</strong> is thin and easily breached.</p><p>The <strong>deference</strong> with which the French aristocracy greeted the middle-class Rousseau was all the more <strong>remarkable</strong> because he showed so little respect for them.</p><p>The influence of the Titnaeus among early philosophical thinkers was <strong>pervasive</strong>, if only because it was the sole dialogue <strong>available</strong> in Europe for almost 1000 years.</p><p>The Gibsons were little given to <strong>conformism</strong> in any form; not one of them was afraid of <strong>singularity</strong>, of being seeming unlike their neighbors.</p><p>Salazar&#39;s presence in the group was so <strong>reassuring</strong> to the others that they lost most of their earlier <strong>trepidation</strong>; failure, for them, became all but unthinkable.</p><p><em>all but = almost, anything but = not at all</em></p><p>Read‘s apology to Heflin was not exactly abject and did little to <strong>resolve</strong> their decades-long quarrel, which had been as <strong>acrimonious</strong> as the academic etiquette of scholarly journals permitted.</p><p>An obvious style, easily identified by some superficial quirk, is properly <strong>decried</strong> as a mere mannerism, whereas a complex and subtle style <strong>resists</strong> reduction to a formula.</p><p>Jones was unable to recognize, the contradictions in his attitudes that were obvious to everyone else; even the hint of an untruth was <strong>repugnant</strong> to him, but he <strong>courted</strong> serious trouble by always cheating on his taxes.</p><p>The idea of an autonomous discipline called “philosophy,” distinct from and sitting in judgment on such pursuits as theology and science turns out, on close examination, to be of quite recent origin.</p><p>She writes across generational lines, making the past so <strong>vivid</strong> that our belief that the present is the true locus of experience is undermined.</p><p>The trick for Michael was to <strong>conjure for</strong> his son a illusory orderliness; only alone at night, when the boy was asleep, could Michael <strong>acknowledge</strong> the chaos he kept hidden from his son.</p><p>The current demand for quality in the schools seems to ask not for the development of informed and active citizens, but for disciplined and productive workers with abilities that contribute to civic life only <strong>indirectly</strong>, if at all.</p><p>Bob: It seems like this city is getting more dangerous every day.</p><p>Steve: Actually, it doesn&#39;t seem that much worse from when I first moved here. If anything, the crime rate has actually dropped since the city’s population has almost doubled in the last ten years.</p><p>Carruther‘s latest literature criticism <strong>belies</strong> her reputation for trenchant commentary; despite its intriguing titles and the fulsome praise on its dust jacket, it is nothing more than a collection of <strong>platitudes</strong>.</p><p><em>belie: contradict</em></p><p>Those who fear the influence of television deliberately <strong>underplay</strong> its persuasive power, hoping that they might keep knowledge of its potential to effect social change from being widely disseminated.</p><p>Far from being <strong>unctuous</strong>, Pat was always loath to appear <strong>acquiescent</strong>.</p><p>A desire to throw over reality a light that never was might give away abruptly to the desire on the part of what we might consider a novelist-scientist to record exactly and concretely the structure and texture of a flower</p><p>It has thus generally been by way of the emphasis on oral literary creativity that these Chicano writers, whose English-language works are sometimes uninspired, developed the powerful and arresting language that characterized their Spanish-language works.</p><p>Having no sense of moral obligation, Shipler was as little subject to the <strong>reproach</strong> of conscience after he acted as he was motivated by its <strong>promptings</strong> before he acted.</p><p>Only in the case of the February Revolution do we lack a useful description of participants that might characterize it in the light of what social history has taught us about the process of revolutionary mobilization.</p><p>She was criticized by her fellow lawyers not because she was not <strong>hardworking</strong>, but because she so <strong>minutely</strong> prepared her cases that she failed to bring the expected number to trial.</p><p>Religious philosopher that he was, Henry More derived his conception of an infinite universe from the Infinite God in whom he believed, a benevolent God of <strong>plenitude</strong> whose nature was to create <strong>abundance</strong>.</p><p>The author, mocked by many for his simple, almost childlike prose, can at least not be begrudged the distinction of writing with <strong>lucidness</strong>.</p><p><em>begrudge: give unwillingly</em></p><p>Perhaps there is nothing more to the album than its case that experimentalism into uncharted sonic landscapes did not <strong>die</strong> with Stockhausen. Or perhaps its forays—many of which could rightly be dubbed sophomoric—into the avant-grade also lead to the <strong>unsettling conclusion</strong> that to create an unprecedented sound one has to <strong>forgo producing</strong> a discernible melody.</p><p>There&#39;s hardly a generalization that can be made about people&#39;s social behavior and the values informing it that cannot be <strong>challenged</strong> from one or another point of view, or even <strong>dismissed</strong> as simplistic or vapid.</p>]]></content>
      
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to Model RLGC Transmission Line</title>
      <link href="/archives/afb86e77/transmission-line.html"/>
      <url>/archives/afb86e77/transmission-line.html</url>
      
        <content type="html"><![CDATA[<p>This article covers:</p><ul><li>Transmission line (TL) equation and its solution</li><li>Input impedance of a terminated TL</li><li>Conversion between RLGC and γZ parameters</li><li>S, Z, Y and ABCD Parameters of TL</li><li>Examples of obtaining parameters from simulation</li></ul><a id="more"></a><h2 id="Transmission-Line"><a href="#Transmission-Line" class="headerlink" title="Transmission Line"></a>Transmission Line</h2><h3 id="Transmission-Line-Equation"><a href="#Transmission-Line-Equation" class="headerlink" title="Transmission Line Equation"></a>Transmission Line Equation</h3><p><img src="transmission-line/Lumped-Model-of-Transmission-Lines.png" alt="Lumped Model of Transmission Lines"></p><p>We have</p><script type="math/tex; mode=display">v(z,t)-R\Delta z i(z,t)-L\Delta z\frac{\partial i(z,t)}{\partial t}-v(z+\Delta z)=0\\i(z,t)-G\Delta zv(z+\Delta z,t)-C\Delta z\frac{\partial v(z+\Delta z,t)}{\partial t}-i(z+\Delta z,t)=0</script><p>Divide them by $\Delta z$ and set $\Delta z\to0$</p><script type="math/tex; mode=display">\frac{\partial v(z,t)}{\partial t}=-Ri(z,t)-L\frac{\partial i(z,t)}{\partial t}\\\frac{\partial i(z,t)}{\partial t}=-Gv(z,t)-C\frac{\partial v(z,t)}{\partial t}</script><p>For the sinusoidal steady-state condition</p><script type="math/tex; mode=display">\frac{d V(z)}{d t}=-(R+j\omega L)I(z)\\\frac{d I(z)}{d t}=-(G+j\omega C)V(z)\\</script><p>With manipulation, it turns into</p><script type="math/tex; mode=display">\frac{d^2 V(z)}{d t^2}-\gamma^2V(z)=0\\\frac{d^2 I(z)}{d t^2}-\gamma^2I(z)=0\\</script><p>where</p><script type="math/tex; mode=display">\gamma=\sqrt{(R+j\omega L)(G+j\omega C)}=\alpha+j\beta</script><p>The solution is</p><script type="math/tex; mode=display">V(z)=V^+e^{-\gamma z}+V^-e^{\gamma z}\\I(z)=I^+e^{-\gamma z}-I^-e^{\gamma z}</script><p>$V(z)$ can be used to derive $I(z)$ as</p><script type="math/tex; mode=display">I(z)=\frac{\gamma}{R+j\omega L}(V^+e^{-\gamma z}-V^-e^{\gamma z})</script><p>we have</p><script type="math/tex; mode=display">\frac{V^+}{I^+}=\frac{V^-}{I^-}=Z_0=\frac{R+j\omega L}{\gamma}=\sqrt{\frac{R+j\omega L}{G+j\omega C}}</script><p>The solution of $V(z)$ can be written in the time domain as $\mathrm{Re}[V(z)e^{j\omega t}]$</p><script type="math/tex; mode=display">v(z,t)=|V^+|\cos(\omega t-\beta z+\phi^+)e^{-\alpha z}\\|V^-|\cos(\omega t-\beta z+\phi^-)e^{\alpha z}</script><p>where we have</p><script type="math/tex; mode=display">\lambda=\frac{2\pi}{\beta}\\v_p=\frac{\omega}{\beta}=\lambda f</script><p><strong>For lossless lines</strong> $\beta=\omega\sqrt{LC}$</p><script type="math/tex; mode=display">\lambda=\frac{2\pi}{\omega \sqrt{LC}}\\v_p=\frac{1}{\sqrt{LC}}</script><h3 id="Terminated-Transmission-Line"><a href="#Terminated-Transmission-Line" class="headerlink" title="Terminated Transmission Line"></a>Terminated Transmission Line</h3><p><img src="transmission-line/Transmission-Line-with-Load.png" alt="Transmission Line with Load"></p><p>Since</p><script type="math/tex; mode=display">Z_L=\frac{V(0)}{I(0)}=\frac{V^++V^-}{V^+-V^-}Z_0</script><p>The ratio of the reflected voltage wave amplitude to the incident voltage wave amplitude is defined as the voltage <strong>reflection coefficient</strong>:</p><script type="math/tex; mode=display">\Gamma=\frac{V^-}{V^+}=\frac{Z_L-Z_0}{Z_L+Z_0}</script><p>Using reflection coefficient, we may rewrite the transmission line solution as</p><script type="math/tex; mode=display">V(z)=V^+(e^{-\gamma z}+\Gamma e^{\gamma z})\\I(z)=\frac{V^+}{Z_0}(e^{-\gamma z}-\Gamma e^{\gamma z})</script><p>The maximal voltage amplitude to the minimal voltage amplitude is defined as <strong>standing wave ratio (SWR)</strong>:</p><script type="math/tex; mode=display">\operatorname{SWR}=\frac{1+|\Gamma|}{1-|\Gamma|}</script><p>At arbitrary point, the reflection coefficient is</p><script type="math/tex; mode=display">\Gamma(-l)=\frac{V^-e^{-\gamma l}}{V^+e^{\gamma l}}=\Gamma(0)e^{-2\gamma l}</script><p>and input impedance is</p><script type="math/tex; mode=display">\begin{aligned}Z_{in}=Z(-l)&=Z_0\frac{1+\Gamma e^{-2\gamma l}}{1-\Gamma e^{-2\gamma l}}\\&=Z_0\frac{Z_L+Z_0\tanh{\gamma l}}{Z_0+Z_L\tanh{\gamma l}}\end{aligned}</script><p><strong>For lossless lines</strong></p><script type="math/tex; mode=display">\begin{aligned}Z_{in}=Z(-l)&=Z_0\frac{1+\Gamma e^{-2j\beta l}}{1-\Gamma e^{-2j\beta l}}\\&=Z_0\frac{Z_L+jZ_0\tan{\beta l}}{Z_0+jZ_L\tan{\beta l}}\end{aligned}</script><p>Thus</p><ul><li><p>For a <strong>quarter-wavelength</strong> transmission line where $\beta l=\pi/2$, we have</p><script type="math/tex; mode=display">Z_{in}Z_L=Z_0^2</script></li><li><p>An <strong>open</strong> stub where $Z_L=\infty$</p><script type="math/tex; mode=display">Z_{in}=-jZ_0\cot{\beta l}</script></li><li><p>An <strong>short</strong> stub where $Z_l=0$</p><script type="math/tex; mode=display">Z_{in}=jZ_0\tan{\beta l}</script></li></ul><h3 id="Parameter-Conversion"><a href="#Parameter-Conversion" class="headerlink" title="Parameter Conversion"></a>Parameter Conversion</h3><p>γZ to RLCG</p><script type="math/tex; mode=display">R={\rm Re}\{\gamma Z\}</script><script type="math/tex; mode=display">L={\rm Im}\{\gamma Z\}/\omega</script><script type="math/tex; mode=display">G={\rm Re}\{\gamma/Z\}</script><script type="math/tex; mode=display">C={\rm Im}\{\gamma/Z\}/\omega</script><h3 id="S-Z-Y-and-ABCD-Parameters"><a href="#S-Z-Y-and-ABCD-Parameters" class="headerlink" title="S, Z, Y and ABCD Parameters"></a>S, Z, Y and ABCD Parameters</h3><script type="math/tex; mode=display">S=\frac{1}{D_s}\left[    \begin{matrix}        (Z^2-Z_0^2)\sinh\gamma l & 2ZZ_0\\        2ZZ_0 & (Z^2-Z_0^2)\sinh\gamma    \end{matrix}\right]\\D_s=2ZZ_0\cosh\gamma l+(Z^2+Z_0^2)\sinh\gamma l\\ABCD=\left[    \begin{matrix}        \cosh\gamma l & Z\sinh\gamma l\\        \frac{\sinh\gamma l}{Z} & \cosh\gamma l    \end{matrix}\right]\\Z=\left[    \begin{matrix}        \frac{Z}{\tanh\gamma l} & \frac{Z}{\sinh\gamma l}\\        \frac{Z}{\sinh\gamma l} & \frac{Z}{\tanh\gamma l}    \end{matrix}\right]\\Y=\left[    \begin{matrix}        \frac{1}{Z\tanh\gamma l} & -\frac{1}{Z\sinh\gamma l}\\        -\frac{1}{Z\sinh\gamma l} & \frac{1}{Z\tanh\gamma l}    \end{matrix}\right]</script><p>Note that $Z$ is the characteristic impedance of the <strong>transmission line</strong>, and $Z_0$ is the characteristic impedance of the <strong>measurement system</strong>.</p><h3 id="Distortionless-Line"><a href="#Distortionless-Line" class="headerlink" title="Distortionless Line"></a>Distortionless Line</h3><p>In a lossy line, the phase term $\beta$ is generally a complicated function of frequency $\omega$. If $\beta$ is not a linear function of frequency, the phase velocity can vary with frequency, causing signal dispersion. However, for the lossy lines, when</p><script type="math/tex; mode=display">\frac{R}{L}=\frac{G}{C}</script><p>it is still distortionless. In this case</p><script type="math/tex; mode=display">\begin{aligned}\gamma&=\sqrt{(R+j\omega L)(G+j\omega C)}\\&=\sqrt{(j\omega L)(j\omega C)\left(1+\frac{R}{j\omega L}\right)\left(1+\frac{G}{j\omega C}\right)}\\&=j\omega\sqrt{LC}\left(1+\frac{R}{j\omega L}\right)\\&=R\sqrt{\frac{C}{L}}+j\omega\sqrt{LC}\end{aligned}</script><h2 id="Parameters-Extraction"><a href="#Parameters-Extraction" class="headerlink" title="Parameters Extraction"></a>Parameters Extraction</h2><h3 id="Direct-Simulation"><a href="#Direct-Simulation" class="headerlink" title="Direct Simulation"></a>Direct Simulation</h3><p>The characteristic impedance can be obtained from direct simulation. First, two ports of identical impedance are connected to the sides of the TL. Then, a parameter sweep of the port impedance is conducted at the intended frequency. The impedance that have the lowest reflection can be used as characteristic impedance.</p><p><img src="transmission-line/simulation_schematic.png" alt="simulation_schematic"></p><p>Real part of characteristic impedance is given by</p><p><img src="transmission-line/real_of_Z.png" alt="real_of_Z"></p><p>Also, we note that when the characteristic impedance matches, the gain of the TL can be written as</p><script type="math/tex; mode=display">\begin{aligned}S_{21}\biggl|_{Z=Z_0}&=\frac{1}{\sinh\gamma l+\cosh\gamma l}\\&=e^{-\gamma l}\\&=e^{-\alpha l}e^{-j\beta l}\end{aligned}</script><p>Hence, we have</p><script type="math/tex; mode=display">S_{21}[dB]=20\log_{10}e^{-\alpha l}=-20\alpha l\log_{10}{e}\\S_{21}[rad]=-\beta l</script><p>The above equations can be used to solve for γ. In this case, we have a TL length of $400\times10^{-6} \mathrm{m}$ and $S_{21}|_{Z=Z_0}=-0.22 dB/-28.95^\circ$. We can write</p><script type="math/tex; mode=display">\alpha=\frac{S_{21}[dB]}{-8.686[dB/m]\cdot l[m]}=63.3\\\beta=\frac{S_{21}[rad]}{-l[m]}=1263[rad/m]</script><h3 id="Calculation"><a href="#Calculation" class="headerlink" title="Calculation"></a>Calculation</h3><p>Alternatively, the parameters of a TL can be calculation directly from S parameters. This function is supported in Matlab. Calculation process is as follows:</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PolartoComplex = @(len, the) len*<span class="built_in">cos</span>(the*<span class="built_in">pi</span>/<span class="number">180</span>) + <span class="number">1</span><span class="built_in">i</span>*len*<span class="built_in">sin</span>(the*<span class="built_in">pi</span>/<span class="number">180</span>);</span><br><span class="line"></span><br><span class="line">S11 = PolartoComplex(<span class="number">0.019</span>, <span class="number">9.658</span>);</span><br><span class="line">S12 = PolartoComplex(<span class="number">0.975</span>, <span class="number">-28.942</span>);</span><br><span class="line">S21 = PolartoComplex(<span class="number">0.975</span>, <span class="number">-28.942</span>);</span><br><span class="line">S22 = PolartoComplex(<span class="number">0.019</span>, <span class="number">9.658</span>);</span><br><span class="line"><span class="built_in">length</span> = <span class="number">400e-6</span>;<span class="comment">% length of transmission line</span></span><br><span class="line">freq = <span class="number">28e9</span>;<span class="comment">% frequency of simulation</span></span><br><span class="line">Z0 = <span class="number">50</span>;</span><br><span class="line">rlgc_params = s2rlgc([S11, S12; S21, S22], <span class="built_in">length</span>, freq, Z0)</span><br></pre></td></tr></table></figure><p>Corresponding output is</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    R: 5.1717e+03</span><br><span class="line">    L: 3.6799e-07</span><br><span class="line">    G: 0.4737</span><br><span class="line">    C: 1.4002e-10</span><br><span class="line">alpha: 62.5539</span><br><span class="line"> beta: 1.2634e+03</span><br><span class="line">   Zc: 51.3183 - 1.5526i</span><br></pre></td></tr></table></figure><h3 id="Verification-of-the-Model"><a href="#Verification-of-the-Model" class="headerlink" title="Verification of the Model"></a>Verification of the Model</h3><p>8 RLGC segments are used for verification</p><p><img src="transmission-line/lumped_mimic_distributed.png" alt="lumped_mimic_distributed"></p><p>Detailed schematic of each one</p><p><img src="transmission-line/detailed_schematic.png" alt="detailed_schematic"></p><p>Results</p><p><img src="transmission-line/simulation_result.png" alt="simulation_result"></p><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><h3 id="Field-Solution"><a href="#Field-Solution" class="headerlink" title="Field Solution"></a>Field Solution</h3><script type="math/tex; mode=display">\nabla\times E=-j\omega\mu H\\\nabla\times H=j\omega\epsilon E+\sigma E</script><p>which can be transformed into</p><script type="math/tex; mode=display">\nabla^2 E+\omega^2\mu\epsilon\left(1-j\frac{\sigma}{\omega\epsilon}\right)E=0</script><p>For that matter</p><script type="math/tex; mode=display">\gamma=\alpha+j\beta=j\omega\sqrt{\mu\epsilon}\sqrt{1-j\frac{\sigma}{\omega\epsilon}}\\</script><p>We can use a complex permittivity to represent the loss and set $\sigma=0$</p><script type="math/tex; mode=display">\epsilon=\epsilon'-j\epsilon''=\epsilon'(1-j\tan\delta)</script><p>The intrinsic impedance is complex</p><script type="math/tex; mode=display">Z=\frac{j\omega\mu}{\gamma}</script><h3 id="Low-Loss-Approximation"><a href="#Low-Loss-Approximation" class="headerlink" title="Low-Loss Approximation"></a>Low-Loss Approximation</h3><p>For a low-loss line both conductor and dielectric loss will be small</p><script type="math/tex; mode=display">\begin{aligned}\gamma&=\sqrt{(R+j\omega L)(G+j\omega C)}\\&=\sqrt{(j\omega L)(j\omega C)\left(1+\frac{R}{j\omega L}\right)\left(1+\frac{G}{j\omega C}\right)}\\&\approx j\omega\sqrt{LC}\sqrt{1-j\left(\frac{R}{\omega L}+\frac{G}{\omega C}\right)}\\&\approx j\omega\sqrt{LC}\left[1-j\left(\frac{R}{\omega L}+\frac{G}{\omega C}\right)\right]\end{aligned}</script><p>we have</p><script type="math/tex; mode=display">\alpha\approx\frac{1}{2}\left(\frac{R}{Z_0}+GZ_0\right)\\\beta\approx\omega\sqrt{LC}\\Z_0\approx\sqrt{\frac{L}{C}}</script><p>How to convert $\gamma,Z$ parameters to $A, \epsilon_{eff},Z$ parameters?</p><script type="math/tex; mode=display">\alpha=\frac{A}{20\log_{10}{e}}\approx\frac{A}{8.686}\\\beta=\omega\sqrt{\mu\epsilon}=\omega\sqrt{\mu_0\epsilon_0\epsilon_{eff}}</script><p>where $\epsilon&#39;=\epsilon_0\epsilon_{eff}$ and $Z_0=\sqrt{\mu_0/\epsilon_0}=377 \Omega$. These translates to</p><script type="math/tex; mode=display">A=20\alpha\log_{10}{e}\\\epsilon_{eff}=\left(\frac{c\beta}{\omega}\right)^2</script><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>W. R. Eisenstadt and Y. Eo, &quot;S-parameter-based IC interconnect transmission line characterization,&quot; in <em>IEEE Transactions on Components, Hybrids, and Manufacturing Technology</em>, vol. 15, no. 4, pp. 483-490, Aug. 1992. DOI:  <a href="https://doi.org/10.1109/33.159877" target="_blank" rel="noopener">10.1109/33.159877</a></li><li>David M. Pozar. <em>Microwave engineering</em>.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> RF </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
